2025-10-13 11:27:19.853 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-13 13:38:56.965 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-13 15:08:24.417 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-13 15:34:04.078 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-13 16:01:16.652 | INFO     | tasks.generation_task:generate_personalized_image:85 - Starting generation for 123
2025-10-13 16:01:16.657 | ERROR    | tasks.generation_task:generate_personalized_image:214 - Generation failed for 123: 3 validation errors for CampaignData
design_image_url
  Field required [type=missing, input_value={'test': 'data'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
object_template
  Field required [type=missing, input_value={'test': 'data'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
insertion_area
  Field required [type=missing, input_value={'test': 'data'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
2025-10-13 16:01:18.785 | ERROR    | app.utils.helpers:send_callback_to_laravel:110 - Failed to send callback to http://localhost:8000/api/internal/generations/123/failed: Client error '404 Not Found' for url 'http://localhost:8000/api/internal/generations/123/failed'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-10-13 16:01:18.894 | ERROR    | tasks.generation_task:on_failure:46 - Task 21599fcc-bf17-4e05-980a-4771e70857e2 failed: 3 validation errors for CampaignData
design_image_url
  Field required [type=missing, input_value={'test': 'data'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
object_template
  Field required [type=missing, input_value={'test': 'data'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
insertion_area
  Field required [type=missing, input_value={'test': 'data'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.12/v/missing
2025-10-13 16:01:19.799 | ERROR    | app.utils.helpers:send_callback_to_laravel:110 - Failed to send callback to http://localhost:8000/api/internal/generations/123/failed: Client error '404 Not Found' for url 'http://localhost:8000/api/internal/generations/123/failed'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-10-13 16:04:18.273 | INFO     | tasks.generation_task:generate_personalized_image:85 - Starting generation for 0199dcd0-39c4-7253-a96b-b453df36e81a
2025-10-13 16:04:18.278 | ERROR    | tasks.generation_task:generate_personalized_image:214 - Generation failed for 0199dcd0-39c4-7253-a96b-b453df36e81a: 1 validation error for CampaignData
generation_settings
  Input should be a valid dictionary [type=dict_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.12/v/dict_type
2025-10-13 16:04:20.446 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dcd0-39c4-7253-a96b-b453df36e81a/failed
2025-10-13 16:04:20.480 | ERROR    | tasks.generation_task:on_failure:46 - Task d23095cd-f7a3-4ab9-abaa-7a2f3a2fe621 failed: 1 validation error for CampaignData
generation_settings
  Input should be a valid dictionary [type=dict_type, input_value=[], input_type=list]
    For further information visit https://errors.pydantic.dev/2.12/v/dict_type
2025-10-13 16:04:21.990 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dcd0-39c4-7253-a96b-b453df36e81a/failed
2025-10-13 16:06:22.130 | INFO     | tasks.generation_task:generate_personalized_image:85 - Starting generation for 0199dcd2-1dc8-70b4-a2a3-09a3dae7d91d
2025-10-13 16:06:22.135 | INFO     | tasks.generation_task:generate_personalized_image:95 - Step 1: Downloading images
2025-10-13 16:06:22.155 | ERROR    | app.utils.helpers:download_image:28 - Failed to download image from file://./temp\0199dcd2-1dc8-70b4-a2a3-09a3dae7d91d_face.jpg: No connection adapters were found for 'file://./temp\\0199dcd2-1dc8-70b4-a2a3-09a3dae7d91d_face.jpg'
2025-10-13 16:06:22.157 | ERROR    | tasks.generation_task:generate_personalized_image:214 - Generation failed for 0199dcd2-1dc8-70b4-a2a3-09a3dae7d91d: Failed to download face image
2025-10-13 16:06:23.767 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dcd2-1dc8-70b4-a2a3-09a3dae7d91d/failed
2025-10-13 16:06:23.780 | ERROR    | tasks.generation_task:on_failure:46 - Task 5a5ff8f7-6a68-40bc-bf38-ebc3468ba4ec failed: Failed to download face image
2025-10-13 16:06:25.246 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dcd2-1dc8-70b4-a2a3-09a3dae7d91d/failed
2025-10-13 16:09:02.640 | INFO     | tasks.generation_task:generate_personalized_image:85 - Starting generation for 0199dcd4-9053-72e2-a745-65fc41635c15
2025-10-13 16:09:02.647 | INFO     | tasks.generation_task:generate_personalized_image:95 - Step 1: Downloading images
2025-10-13 16:09:02.652 | ERROR    | app.utils.helpers:download_image:28 - Failed to download image from file://./temp\0199dcd4-9053-72e2-a745-65fc41635c15_face.jpg: No connection adapters were found for 'file://./temp\\0199dcd4-9053-72e2-a745-65fc41635c15_face.jpg'
2025-10-13 16:09:02.653 | ERROR    | tasks.generation_task:generate_personalized_image:214 - Generation failed for 0199dcd4-9053-72e2-a745-65fc41635c15: Failed to download face image
2025-10-13 16:09:05.263 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dcd4-9053-72e2-a745-65fc41635c15/failed
2025-10-13 16:09:05.290 | ERROR    | tasks.generation_task:on_failure:46 - Task 2a150743-afd1-4713-9154-56c55bf240af failed: Failed to download face image
2025-10-13 16:09:08.920 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dcd4-9053-72e2-a745-65fc41635c15/failed
2025-10-13 16:09:39.198 | INFO     | tasks.generation_task:generate_personalized_image:85 - Starting generation for 0199dcd5-1fbf-70dc-80e1-4b657a8108c7
2025-10-13 16:09:39.204 | INFO     | tasks.generation_task:generate_personalized_image:95 - Step 1: Downloading images
2025-10-13 16:09:39.209 | ERROR    | app.utils.helpers:download_image:28 - Failed to download image from file://./temp\0199dcd5-1fbf-70dc-80e1-4b657a8108c7_face.jpg: No connection adapters were found for 'file://./temp\\0199dcd5-1fbf-70dc-80e1-4b657a8108c7_face.jpg'
2025-10-13 16:09:39.210 | ERROR    | tasks.generation_task:generate_personalized_image:214 - Generation failed for 0199dcd5-1fbf-70dc-80e1-4b657a8108c7: Failed to download face image
2025-10-13 16:09:40.972 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dcd5-1fbf-70dc-80e1-4b657a8108c7/failed
2025-10-13 16:09:40.983 | ERROR    | tasks.generation_task:on_failure:46 - Task bf815f25-4d85-4171-aa40-171aa44edc69 failed: Failed to download face image
2025-10-13 16:09:42.915 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dcd5-1fbf-70dc-80e1-4b657a8108c7/failed
2025-10-13 16:13:16.425 | ERROR    | tasks.generation_task:on_failure:46 - Task 9bb20c92-cef8-4aaf-8f2d-65cad80efebb failed: generate_personalized_image() got an unexpected keyword argument 'face_image_path'
2025-10-13 16:13:18.373 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dcd8-1d46-73c4-8897-e65e35b18844/failed
2025-10-13 16:14:50.030 | ERROR    | tasks.generation_task:on_failure:46 - Task 3cba7f87-15ab-490e-b580-ac12fa3b46d1 failed: generate_personalized_image() got an unexpected keyword argument 'face_image_path'
2025-10-13 16:14:52.070 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dcd9-71e8-70fb-bd11-671a8f2a79c9/failed
2025-10-13 16:16:13.195 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-13 16:16:42.212 | INFO     | tasks.generation_task:generate_personalized_image:75 - Starting generation for 0199dcdb-8c1a-7332-8e07-168448d81299
2025-10-13 16:16:42.215 | INFO     | tasks.generation_task:generate_personalized_image:85 - Step 1: Loading images
2025-10-13 16:16:42.475 | INFO     | tasks.generation_task:generate_personalized_image:98 - Images loaded successfully
2025-10-13 16:16:42.479 | INFO     | tasks.generation_task:generate_personalized_image:102 - Step 2: Generating person with pose: standing_casual
2025-10-13 16:16:42.480 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-13 16:16:45.613 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-13 16:16:45.615 | INFO     | app.services.ai_generator:generate_person:113 - Generating person: standing_casual, size: 71x39
2025-10-13 16:16:45.617 | ERROR    | app.services.ai_generator:generate_person:139 - Failed to generate person: `height` and `width` have to be divisible by 8 but are 39 and 71.
2025-10-13 16:16:45.618 | ERROR    | tasks.generation_task:generate_personalized_image:208 - Generation failed for 0199dcdb-8c1a-7332-8e07-168448d81299: Failed to generate person image
2025-10-13 16:16:47.003 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dcdb-8c1a-7332-8e07-168448d81299/failed
2025-10-13 16:16:47.013 | ERROR    | tasks.generation_task:on_failure:46 - Task 32e6610b-a2ce-4a3e-ba0c-be487882b8bc failed: Failed to generate person image
2025-10-13 16:16:48.116 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dcdb-8c1a-7332-8e07-168448d81299/failed
2025-10-13 16:17:00.106 | INFO     | tasks.generation_task:generate_personalized_image:75 - Starting generation for 0199dcdb-d9f8-71e4-9d1b-561250bb10e0
2025-10-13 16:17:00.110 | INFO     | tasks.generation_task:generate_personalized_image:85 - Step 1: Loading images
2025-10-13 16:17:00.215 | INFO     | tasks.generation_task:generate_personalized_image:98 - Images loaded successfully
2025-10-13 16:17:00.218 | INFO     | tasks.generation_task:generate_personalized_image:102 - Step 2: Generating person with pose: standing_casual
2025-10-13 16:17:00.219 | INFO     | app.services.ai_generator:generate_person:113 - Generating person: standing_casual, size: 71x39
2025-10-13 16:17:00.220 | ERROR    | app.services.ai_generator:generate_person:139 - Failed to generate person: `height` and `width` have to be divisible by 8 but are 39 and 71.
2025-10-13 16:17:00.224 | ERROR    | tasks.generation_task:generate_personalized_image:208 - Generation failed for 0199dcdb-d9f8-71e4-9d1b-561250bb10e0: Failed to generate person image
2025-10-13 16:17:01.848 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dcdb-d9f8-71e4-9d1b-561250bb10e0/failed
2025-10-13 16:17:01.857 | ERROR    | tasks.generation_task:on_failure:46 - Task ffd82d1a-782b-4759-86c8-d5707ff3aaa4 failed: Failed to generate person image
2025-10-13 16:17:03.654 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dcdb-d9f8-71e4-9d1b-561250bb10e0/failed
2025-10-13 16:17:44.937 | INFO     | tasks.generation_task:generate_personalized_image:75 - Starting generation for 0199dcdc-8930-70cb-842b-a962f27c298a
2025-10-13 16:17:44.944 | INFO     | tasks.generation_task:generate_personalized_image:85 - Step 1: Loading images
2025-10-13 16:17:45.055 | INFO     | tasks.generation_task:generate_personalized_image:98 - Images loaded successfully
2025-10-13 16:17:45.058 | INFO     | tasks.generation_task:generate_personalized_image:102 - Step 2: Generating person with pose: standing_casual
2025-10-13 16:17:45.059 | INFO     | app.services.ai_generator:generate_person:113 - Generating person: standing_casual, size: 71x39
2025-10-13 16:17:45.061 | ERROR    | app.services.ai_generator:generate_person:139 - Failed to generate person: `height` and `width` have to be divisible by 8 but are 39 and 71.
2025-10-13 16:17:45.062 | ERROR    | tasks.generation_task:generate_personalized_image:208 - Generation failed for 0199dcdc-8930-70cb-842b-a962f27c298a: Failed to generate person image
2025-10-13 16:17:47.050 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dcdc-8930-70cb-842b-a962f27c298a/failed
2025-10-13 16:17:47.056 | ERROR    | tasks.generation_task:on_failure:46 - Task 8562f354-b4bf-4880-a3e7-59a33ab862e4 failed: Failed to generate person image
2025-10-13 16:17:48.347 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dcdc-8930-70cb-842b-a962f27c298a/failed
2025-10-13 16:20:35.496 | INFO     | tasks.generation_task:generate_personalized_image:75 - Starting generation for 0199dcde-deab-7382-99c2-d6a7c1a6aff1
2025-10-13 16:20:35.501 | INFO     | tasks.generation_task:generate_personalized_image:85 - Step 1: Loading images
2025-10-13 16:20:35.626 | INFO     | tasks.generation_task:generate_personalized_image:98 - Images loaded successfully
2025-10-13 16:20:35.629 | INFO     | tasks.generation_task:generate_personalized_image:102 - Step 2: Generating person with pose: standing_casual
2025-10-13 16:20:35.631 | INFO     | app.services.ai_generator:generate_person:113 - Generating person: standing_casual, size: 71x39
2025-10-13 16:20:35.632 | ERROR    | app.services.ai_generator:generate_person:139 - Failed to generate person: `height` and `width` have to be divisible by 8 but are 39 and 71.
2025-10-13 16:20:35.632 | ERROR    | tasks.generation_task:generate_personalized_image:208 - Generation failed for 0199dcde-deab-7382-99c2-d6a7c1a6aff1: Failed to generate person image
2025-10-13 16:20:37.285 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dcde-deab-7382-99c2-d6a7c1a6aff1/failed
2025-10-13 16:20:37.294 | ERROR    | tasks.generation_task:on_failure:46 - Task c1b602df-a4eb-45ac-b260-66890cf87c25 failed: Failed to generate person image
2025-10-13 16:20:39.126 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dcde-deab-7382-99c2-d6a7c1a6aff1/failed
2025-10-13 16:21:28.840 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-13 16:21:57.340 | INFO     | tasks.generation_task:generate_personalized_image:78 - Starting generation for 0199dce0-5b1d-7350-9cb3-4d34cdd3a8ad
2025-10-13 16:21:57.343 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 1: Loading images
2025-10-13 16:21:57.619 | INFO     | tasks.generation_task:generate_personalized_image:101 - Images loaded successfully
2025-10-13 16:21:57.628 | INFO     | tasks.generation_task:generate_personalized_image:105 - Step 2: Generating person with pose: standing_casual
2025-10-13 16:21:57.629 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-13 16:22:00.430 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-13 16:22:00.431 | INFO     | tasks.generation_task:generate_personalized_image:116 - Adjusted dimensions: 64x32
2025-10-13 16:22:00.432 | INFO     | app.services.ai_generator:generate_person:113 - Generating person: standing_casual, size: 64x32
2025-10-13 16:22:49.594 | INFO     | app.services.ai_generator:generate_person:134 - Person generated successfully
2025-10-13 16:22:49.599 | INFO     | tasks.generation_task:generate_personalized_image:129 - Person generated successfully
2025-10-13 16:22:49.615 | INFO     | tasks.generation_task:generate_personalized_image:133 - Step 3: Performing face swap
2025-10-13 16:22:49.616 | INFO     | app.services.face_swapper:load_model:30 - Loading InsightFace models...
2025-10-13 16:22:53.773 | INFO     | app.services.face_swapper:load_model:47 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-13 16:22:59.348 | INFO     | app.services.face_swapper:load_model:52 - Face swap models loaded successfully
2025-10-13 16:22:59.350 | INFO     | app.services.face_swapper:swap_face:79 - Starting face swap process
2025-10-13 16:23:00.717 | INFO     | app.services.face_swapper:swap_face:103 - Source face detected at bbox: [ 149.97496  432.79843  725.81854 1191.7039 ]
2025-10-13 16:23:01.308 | ERROR    | app.services.face_swapper:swap_face:108 - No face detected in target image
2025-10-13 16:23:01.310 | ERROR    | tasks.generation_task:generate_personalized_image:217 - Generation failed for 0199dce0-5b1d-7350-9cb3-4d34cdd3a8ad: Failed to swap face
2025-10-13 16:23:03.318 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dce0-5b1d-7350-9cb3-4d34cdd3a8ad/failed
2025-10-13 16:23:03.360 | ERROR    | tasks.generation_task:on_failure:46 - Task 52ebc450-0a96-425a-ae9b-58e8536cf8b0 failed: Failed to swap face
2025-10-13 16:23:04.564 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199dce0-5b1d-7350-9cb3-4d34cdd3a8ad/failed
2025-10-13 16:25:24.759 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-13 16:25:48.068 | INFO     | tasks.generation_task:generate_personalized_image:78 - Starting generation for 0199dce3-c798-715f-8f2c-697bc67ba749
2025-10-13 16:25:48.072 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 1: Loading images
2025-10-13 16:25:48.188 | INFO     | tasks.generation_task:generate_personalized_image:101 - Images loaded successfully
2025-10-13 16:25:48.191 | INFO     | tasks.generation_task:generate_personalized_image:105 - Step 2: Generating person with pose: standing_casual
2025-10-13 16:25:48.193 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-13 16:25:50.678 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-13 16:25:50.679 | INFO     | tasks.generation_task:generate_personalized_image:116 - Adjusted dimensions: 64x32
2025-10-13 16:25:50.680 | INFO     | app.services.ai_generator:generate_person:113 - Generating person: standing_casual, size: 64x32
2025-10-13 16:26:28.052 | INFO     | app.services.ai_generator:generate_person:134 - Person generated successfully
2025-10-13 16:26:28.052 | INFO     | tasks.generation_task:generate_personalized_image:129 - Person generated successfully
2025-10-13 16:26:28.055 | INFO     | tasks.generation_task:generate_personalized_image:133 - Step 3: Performing face swap
2025-10-13 16:26:28.056 | INFO     | app.services.face_swapper:load_model:30 - Loading InsightFace models...
2025-10-13 16:26:32.084 | INFO     | app.services.face_swapper:load_model:47 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-13 16:26:37.454 | INFO     | app.services.face_swapper:load_model:52 - Face swap models loaded successfully
2025-10-13 16:26:37.455 | INFO     | app.services.face_swapper:swap_face:79 - Starting face swap process
2025-10-13 16:26:38.545 | INFO     | app.services.face_swapper:swap_face:103 - Source face detected at bbox: [ 149.97496  432.79843  725.81854 1191.7039 ]
2025-10-13 16:26:39.034 | ERROR    | app.services.face_swapper:swap_face:108 - No face detected in target image
2025-10-13 16:26:39.039 | WARNING  | tasks.generation_task:generate_personalized_image:142 - Face swap failed, using generated person image without face swap
2025-10-13 16:26:39.379 | INFO     | app.services.face_swapper:enhance_face:289 - Face enhanced successfully
2025-10-13 16:26:39.380 | INFO     | tasks.generation_task:generate_personalized_image:148 - Face swap completed successfully
2025-10-13 16:26:39.382 | INFO     | tasks.generation_task:generate_personalized_image:152 - Step 4: Compositing into design
2025-10-13 16:26:39.383 | INFO     | app.services.image_composer:composite_person_into_design:37 - Compositing person into design at x=14.0 y=27.0 width=71.0 height=39.0 type='rectangle'
2025-10-13 16:26:39.387 | INFO     | app.services.image_composer:composite_person_into_design:57 - Composition completed successfully
2025-10-13 16:26:39.388 | INFO     | tasks.generation_task:generate_personalized_image:165 - Composition completed successfully
2025-10-13 16:26:39.390 | INFO     | tasks.generation_task:generate_personalized_image:169 - Step 5: Saving result
2025-10-13 16:26:39.396 | INFO     | app.utils.helpers:save_image:46 - Image saved to ./output\0199dce3-c798-715f-8f2c-697bc67ba749.jpg
2025-10-13 16:26:39.397 | INFO     | tasks.generation_task:generate_personalized_image:180 - Generation completed in 51329ms
2025-10-13 16:26:39.398 | INFO     | tasks.generation_task:generate_personalized_image:183 - Step 6: Sending completion callback
2025-10-13 16:27:10.048 | ERROR    | app.utils.helpers:send_callback_to_laravel:110 - Failed to send callback to http://localhost:8000/api/internal/generations/0199dce3-c798-715f-8f2c-697bc67ba749/complete: 
2025-10-13 16:27:10.059 | WARNING  | tasks.generation_task:generate_personalized_image:208 - Failed to send completion callback
2025-10-13 16:49:56.675 | INFO     | tasks.generation_task:generate_personalized_image:78 - Starting generation for 0199dcfa-026a-733f-affc-6a1b524b8806
2025-10-13 16:49:56.686 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 1: Loading images
2025-10-13 16:49:57.338 | INFO     | tasks.generation_task:generate_personalized_image:101 - Images loaded successfully
2025-10-13 16:49:57.340 | INFO     | tasks.generation_task:generate_personalized_image:105 - Step 2: Generating person with pose: standing_casual
2025-10-13 16:49:57.342 | INFO     | tasks.generation_task:generate_personalized_image:116 - Adjusted dimensions: 176x232
2025-10-13 16:49:57.343 | INFO     | app.services.ai_generator:generate_person:113 - Generating person: standing_casual, size: 176x232
2025-10-13 16:52:44.248 | INFO     | app.services.ai_generator:generate_person:134 - Person generated successfully
2025-10-13 16:52:44.249 | INFO     | tasks.generation_task:generate_personalized_image:129 - Person generated successfully
2025-10-13 16:52:44.251 | INFO     | tasks.generation_task:generate_personalized_image:133 - Step 3: Performing face swap
2025-10-13 16:52:44.251 | INFO     | app.services.face_swapper:swap_face:79 - Starting face swap process
2025-10-13 16:52:45.075 | INFO     | app.services.face_swapper:swap_face:103 - Source face detected at bbox: [ 149.97496  432.79843  725.81854 1191.7039 ]
2025-10-13 16:52:45.487 | ERROR    | app.services.face_swapper:swap_face:108 - No face detected in target image
2025-10-13 16:52:45.489 | WARNING  | tasks.generation_task:generate_personalized_image:142 - Face swap failed, using generated person image without face swap
2025-10-13 16:52:45.495 | INFO     | app.services.face_swapper:enhance_face:289 - Face enhanced successfully
2025-10-13 16:52:45.496 | INFO     | tasks.generation_task:generate_personalized_image:148 - Face swap completed successfully
2025-10-13 16:52:45.498 | INFO     | tasks.generation_task:generate_personalized_image:152 - Step 4: Compositing into design
2025-10-13 16:52:45.499 | INFO     | app.services.image_composer:composite_person_into_design:37 - Compositing person into design at x=18.0 y=-4.0 width=178.0 height=235.0 type='rectangle'
2025-10-13 16:52:45.506 | INFO     | app.services.image_composer:composite_person_into_design:57 - Composition completed successfully
2025-10-13 16:52:45.507 | INFO     | tasks.generation_task:generate_personalized_image:165 - Composition completed successfully
2025-10-13 16:52:45.509 | INFO     | tasks.generation_task:generate_personalized_image:169 - Step 5: Saving result
2025-10-13 16:52:45.513 | INFO     | app.utils.helpers:save_image:46 - Image saved to ./output\0199dcfa-026a-733f-affc-6a1b524b8806.jpg
2025-10-13 16:52:45.513 | INFO     | tasks.generation_task:generate_personalized_image:180 - Generation completed in 168837ms
2025-10-13 16:52:45.514 | INFO     | tasks.generation_task:generate_personalized_image:183 - Step 6: Sending completion callback
2025-10-13 16:53:15.840 | ERROR    | app.utils.helpers:send_callback_to_laravel:110 - Failed to send callback to http://localhost:8000/api/internal/generations/0199dcfa-026a-733f-affc-6a1b524b8806/complete: 
2025-10-13 16:53:15.847 | WARNING  | tasks.generation_task:generate_personalized_image:208 - Failed to send completion callback
2025-10-14 09:40:24.008 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-14 09:41:33.629 | INFO     | tasks.generation_task:generate_personalized_image:78 - Starting generation for 0199e097-ff88-73c8-8368-c6aab15c5709
2025-10-14 09:41:33.634 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 1: Loading images
2025-10-14 09:41:34.443 | INFO     | tasks.generation_task:generate_personalized_image:101 - Images loaded successfully
2025-10-14 09:41:34.448 | INFO     | tasks.generation_task:generate_personalized_image:105 - Step 2: Generating person with pose: standing_casual
2025-10-14 09:41:34.452 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-14 09:41:38.323 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-14 09:41:38.324 | INFO     | tasks.generation_task:generate_personalized_image:116 - Adjusted dimensions: 176x232
2025-10-14 09:41:38.325 | INFO     | app.services.ai_generator:generate_person:113 - Generating person: standing_casual, size: 176x232
2025-10-14 09:45:00.100 | INFO     | app.services.ai_generator:generate_person:134 - Person generated successfully
2025-10-14 09:45:00.114 | INFO     | tasks.generation_task:generate_personalized_image:129 - Person generated successfully
2025-10-14 09:45:00.149 | INFO     | tasks.generation_task:generate_personalized_image:133 - Step 3: Performing face swap
2025-10-14 09:45:00.151 | INFO     | app.services.face_swapper:load_model:30 - Loading InsightFace models...
2025-10-14 09:45:04.477 | INFO     | app.services.face_swapper:load_model:47 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-14 09:45:09.745 | INFO     | app.services.face_swapper:load_model:52 - Face swap models loaded successfully
2025-10-14 09:45:09.748 | INFO     | app.services.face_swapper:swap_face:79 - Starting face swap process
2025-10-14 09:45:11.038 | INFO     | app.services.face_swapper:swap_face:103 - Source face detected at bbox: [ 149.97496  432.79843  725.81854 1191.7039 ]
2025-10-14 09:45:11.610 | ERROR    | app.services.face_swapper:swap_face:108 - No face detected in target image
2025-10-14 09:45:11.614 | WARNING  | tasks.generation_task:generate_personalized_image:142 - Face swap failed, using generated person image without face swap
2025-10-14 09:45:12.089 | INFO     | app.services.face_swapper:enhance_face:289 - Face enhanced successfully
2025-10-14 09:45:12.089 | INFO     | tasks.generation_task:generate_personalized_image:148 - Face swap completed successfully
2025-10-14 09:45:12.091 | INFO     | tasks.generation_task:generate_personalized_image:152 - Step 4: Compositing into design
2025-10-14 09:45:12.104 | INFO     | app.services.image_composer:composite_person_into_design:37 - Compositing person into design at x=18.0 y=-4.0 width=178.0 height=235.0 type='rectangle'
2025-10-14 09:45:12.133 | INFO     | app.services.image_composer:composite_person_into_design:57 - Composition completed successfully
2025-10-14 09:45:12.138 | INFO     | tasks.generation_task:generate_personalized_image:165 - Composition completed successfully
2025-10-14 09:45:12.142 | INFO     | tasks.generation_task:generate_personalized_image:169 - Step 5: Saving result
2025-10-14 09:45:12.162 | INFO     | app.utils.helpers:save_image:46 - Image saved to ./output\0199e097-ff88-73c8-8368-c6aab15c5709.jpg
2025-10-14 09:45:12.165 | INFO     | tasks.generation_task:generate_personalized_image:180 - Generation completed in 218535ms
2025-10-14 09:45:12.166 | INFO     | tasks.generation_task:generate_personalized_image:183 - Step 6: Sending completion callback
2025-10-14 09:45:43.100 | ERROR    | app.utils.helpers:send_callback_to_laravel:110 - Failed to send callback to http://localhost:8000/api/internal/generations/0199e097-ff88-73c8-8368-c6aab15c5709/complete: 
2025-10-14 09:45:43.107 | WARNING  | tasks.generation_task:generate_personalized_image:208 - Failed to send completion callback
2025-10-14 09:55:20.328 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-14 09:55:51.400 | INFO     | tasks.generation_task:generate_personalized_image:78 - Starting generation for 0199e0a5-1b54-70a2-99b9-71fe8c87edc8
2025-10-14 09:55:51.409 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 1: Loading images
2025-10-14 09:55:51.652 | INFO     | tasks.generation_task:generate_personalized_image:101 - Images loaded successfully
2025-10-14 09:55:51.654 | INFO     | tasks.generation_task:generate_personalized_image:105 - Step 2: Generating person with pose: standing_casual
2025-10-14 09:55:51.655 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-14 09:55:54.805 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-14 09:55:54.806 | INFO     | tasks.generation_task:generate_personalized_image:139 - Original size: 178x235
2025-10-14 09:55:54.806 | INFO     | tasks.generation_task:generate_personalized_image:140 - Generation size (scaled up): 576x768
2025-10-14 09:55:54.807 | INFO     | app.services.ai_generator:generate_person:113 - Generating person: standing_casual, size: 576x768
2025-10-14 10:18:12.390 | INFO     | app.services.ai_generator:generate_person:134 - Person generated successfully
2025-10-14 10:18:12.394 | INFO     | tasks.generation_task:generate_personalized_image:153 - Person generated successfully at 576x768
2025-10-14 10:18:12.401 | INFO     | tasks.generation_task:generate_personalized_image:157 - Step 3: Performing face swap
2025-10-14 10:18:12.401 | INFO     | app.services.face_swapper:load_model:30 - Loading InsightFace models...
2025-10-14 10:18:14.287 | INFO     | app.services.face_swapper:load_model:47 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-14 10:18:17.632 | INFO     | app.services.face_swapper:load_model:52 - Face swap models loaded successfully
2025-10-14 10:18:17.633 | INFO     | app.services.face_swapper:swap_face:79 - Starting face swap process
2025-10-14 10:18:18.636 | INFO     | app.services.face_swapper:swap_face:103 - Source face detected at bbox: [ 149.97496  432.79843  725.81854 1191.7039 ]
2025-10-14 10:18:19.262 | INFO     | app.services.face_swapper:swap_face:117 - Target face detected at bbox: [296.03256  95.05431 357.12225 181.26561]
2025-10-14 10:18:22.982 | INFO     | app.services.face_swapper:swap_face:126 - Face swap completed successfully
2025-10-14 10:18:23.157 | INFO     | app.services.face_swapper:enhance_face:289 - Face enhanced successfully
2025-10-14 10:18:23.159 | INFO     | tasks.generation_task:generate_personalized_image:172 - Face swap completed successfully
2025-10-14 10:18:23.160 | INFO     | tasks.generation_task:generate_personalized_image:176 - Step 4: Compositing into design
2025-10-14 10:18:23.162 | INFO     | app.services.image_composer:composite_person_into_design:25 - Compositing person into design at x=18.0 y=-4.0 width=178.0 height=235.0 type='rectangle'
2025-10-14 10:18:23.163 | INFO     | app.services.image_composer:composite_person_into_design:26 - Design size: (225, 225)
2025-10-14 10:18:23.163 | INFO     | app.services.image_composer:composite_person_into_design:27 - Person size (before resize): (576, 768)
2025-10-14 10:18:23.164 | INFO     | app.services.image_composer:composite_person_into_design:34 - Resizing person to: (178, 235)
2025-10-14 10:18:23.174 | INFO     | app.services.image_composer:composite_person_into_design:49 - Composition completed successfully
2025-10-14 10:18:23.176 | INFO     | tasks.generation_task:generate_personalized_image:189 - Composition completed successfully
2025-10-14 10:18:23.178 | INFO     | tasks.generation_task:generate_personalized_image:193 - Step 5: Saving result
2025-10-14 10:18:23.184 | INFO     | app.utils.helpers:save_image:46 - Image saved to ./output\0199e0a5-1b54-70a2-99b9-71fe8c87edc8.jpg
2025-10-14 10:18:23.184 | INFO     | tasks.generation_task:generate_personalized_image:204 - Generation completed in 1351783ms
2025-10-14 10:18:23.185 | INFO     | tasks.generation_task:generate_personalized_image:207 - Step 6: Sending completion callback
2025-10-14 10:18:53.728 | ERROR    | app.utils.helpers:send_callback_to_laravel:110 - Failed to send callback to http://localhost:8000/api/internal/generations/0199e0a5-1b54-70a2-99b9-71fe8c87edc8/complete: 
2025-10-14 10:18:53.737 | WARNING  | tasks.generation_task:generate_personalized_image:232 - Failed to send completion callback
2025-10-14 10:30:26.896 | INFO     | tasks.generation_task:generate_personalized_image:78 - Starting generation for 0199e0c4-ee13-72c2-9cc2-73f2c5ae66b9
2025-10-14 10:30:26.902 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 1: Loading images
2025-10-14 10:30:27.617 | INFO     | tasks.generation_task:generate_personalized_image:101 - Images loaded successfully
2025-10-14 10:30:27.619 | INFO     | tasks.generation_task:generate_personalized_image:105 - Step 2: Generating person with pose: sitting_upright
2025-10-14 10:30:27.619 | INFO     | tasks.generation_task:generate_personalized_image:139 - Original size: 300x400
2025-10-14 10:30:27.620 | INFO     | tasks.generation_task:generate_personalized_image:140 - Generation size (scaled up): 576x768
2025-10-14 10:30:27.621 | INFO     | app.services.ai_generator:generate_person:113 - Generating person: sitting_upright, size: 576x768
2025-10-14 10:52:35.773 | INFO     | app.services.ai_generator:generate_person:134 - Person generated successfully
2025-10-14 10:52:35.775 | INFO     | tasks.generation_task:generate_personalized_image:153 - Person generated successfully at 576x768
2025-10-14 10:52:35.777 | INFO     | tasks.generation_task:generate_personalized_image:157 - Step 3: Performing face swap
2025-10-14 10:52:35.777 | INFO     | app.services.face_swapper:swap_face:79 - Starting face swap process
2025-10-14 10:52:36.577 | INFO     | app.services.face_swapper:swap_face:103 - Source face detected at bbox: [ 149.97496  432.79843  725.81854 1191.7039 ]
2025-10-14 10:52:36.930 | ERROR    | app.services.face_swapper:swap_face:108 - No face detected in target image
2025-10-14 10:52:36.932 | WARNING  | tasks.generation_task:generate_personalized_image:166 - Face swap failed, using generated person image without face swap
2025-10-14 10:52:36.951 | INFO     | app.services.face_swapper:enhance_face:289 - Face enhanced successfully
2025-10-14 10:52:36.953 | INFO     | tasks.generation_task:generate_personalized_image:172 - Face swap completed successfully
2025-10-14 10:52:36.953 | INFO     | tasks.generation_task:generate_personalized_image:176 - Step 4: Compositing into design
2025-10-14 10:52:36.956 | INFO     | app.services.image_composer:composite_person_into_design:25 - Compositing person into design at x=53.0 y=44.0 width=300.0 height=400.0 type='rectangle'
2025-10-14 10:52:36.957 | INFO     | app.services.image_composer:composite_person_into_design:26 - Design size: (152, 148)
2025-10-14 10:52:36.958 | INFO     | app.services.image_composer:composite_person_into_design:27 - Person size (before resize): (576, 768)
2025-10-14 10:52:36.959 | INFO     | app.services.image_composer:composite_person_into_design:34 - Resizing person to: (300, 400)
2025-10-14 10:52:36.975 | INFO     | app.services.image_composer:composite_person_into_design:49 - Composition completed successfully
2025-10-14 10:52:36.975 | INFO     | tasks.generation_task:generate_personalized_image:189 - Composition completed successfully
2025-10-14 10:52:36.977 | INFO     | tasks.generation_task:generate_personalized_image:193 - Step 5: Saving result
2025-10-14 10:52:36.980 | INFO     | app.utils.helpers:save_image:46 - Image saved to ./output\0199e0c4-ee13-72c2-9cc2-73f2c5ae66b9.jpg
2025-10-14 10:52:36.980 | INFO     | tasks.generation_task:generate_personalized_image:204 - Generation completed in 1330083ms
2025-10-14 10:52:36.980 | INFO     | tasks.generation_task:generate_personalized_image:207 - Step 6: Sending completion callback
2025-10-14 10:53:07.291 | ERROR    | app.utils.helpers:send_callback_to_laravel:110 - Failed to send callback to http://localhost:8000/api/internal/generations/0199e0c4-ee13-72c2-9cc2-73f2c5ae66b9/complete: 
2025-10-14 10:53:07.291 | WARNING  | tasks.generation_task:generate_personalized_image:232 - Failed to send completion callback
2025-10-14 11:02:08.694 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-14 11:02:36.382 | INFO     | tasks.generation_task:generate_personalized_image:78 - Starting generation for 0199e0e2-3ee8-71f2-9ffd-c0c0409aa0a7
2025-10-14 11:02:36.384 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 1: Loading images
2025-10-14 11:02:36.475 | INFO     | tasks.generation_task:generate_personalized_image:101 - Images loaded successfully
2025-10-14 11:02:36.477 | INFO     | tasks.generation_task:generate_personalized_image:105 - Step 2: Generating person with pose: sitting_upright
2025-10-14 11:02:36.478 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-14 11:02:37.836 | ERROR    | app.services.ai_generator:load_model:69 - Failed to load Stable Diffusion model: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-14 11:02:37.836 | ERROR    | tasks.generation_task:generate_personalized_image:238 - Generation failed for 0199e0e2-3ee8-71f2-9ffd-c0c0409aa0a7: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-14 11:02:58.690 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-14 11:03:13.394 | INFO     | tasks.generation_task:generate_personalized_image:78 - Starting generation for 0199e0e2-3ee8-71f2-9ffd-c0c0409aa0a7
2025-10-14 11:03:13.396 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 1: Loading images
2025-10-14 11:03:13.458 | INFO     | tasks.generation_task:generate_personalized_image:101 - Images loaded successfully
2025-10-14 11:03:13.460 | INFO     | tasks.generation_task:generate_personalized_image:105 - Step 2: Generating person with pose: sitting_upright
2025-10-14 11:03:13.460 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-14 11:03:16.534 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-14 11:03:16.534 | INFO     | tasks.generation_task:generate_personalized_image:135 - Insertion area size: 300x400
2025-10-14 11:03:16.534 | INFO     | tasks.generation_task:generate_personalized_image:136 - Generating at minimum size: 576x768 (for face detection)
2025-10-14 11:03:16.534 | INFO     | app.services.ai_generator:generate_person:113 - Generating person: sitting_upright, size: 576x768
2025-10-14 11:26:29.092 | INFO     | app.services.ai_generator:generate_person:134 - Person generated successfully
2025-10-14 11:26:29.092 | INFO     | tasks.generation_task:generate_personalized_image:149 - ✅ Person generated: 576x768
2025-10-14 11:26:29.097 | INFO     | tasks.generation_task:generate_personalized_image:153 - Step 3: Performing face swap
2025-10-14 11:26:29.097 | INFO     | app.services.face_swapper:load_model:30 - Loading InsightFace models...
2025-10-14 11:26:30.967 | INFO     | app.services.face_swapper:load_model:47 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-14 11:26:34.193 | INFO     | app.services.face_swapper:load_model:52 - Face swap models loaded successfully
2025-10-14 11:26:34.193 | INFO     | app.services.face_swapper:swap_face:79 - Starting face swap process
2025-10-14 11:26:35.032 | INFO     | app.services.face_swapper:swap_face:103 - Source face detected at bbox: [ 149.97496  432.79843  725.81854 1191.7039 ]
2025-10-14 11:26:35.729 | INFO     | app.services.face_swapper:swap_face:117 - Target face detected at bbox: [350.54276  61.8535  419.47842 155.11342]
2025-10-14 11:26:40.107 | INFO     | app.services.face_swapper:swap_face:126 - Face swap completed successfully
2025-10-14 11:26:40.311 | INFO     | app.services.face_swapper:enhance_face:289 - Face enhanced successfully
2025-10-14 11:26:40.315 | INFO     | tasks.generation_task:generate_personalized_image:168 - Face swap completed successfully
2025-10-14 11:26:40.315 | INFO     | tasks.generation_task:generate_personalized_image:172 - Step 4: Compositing into design
2025-10-14 11:26:40.315 | INFO     | app.services.image_composer:composite_person_into_design:25 - Compositing person into design at x=53.0 y=44.0 width=300.0 height=400.0 type='rectangle'
2025-10-14 11:26:40.315 | INFO     | app.services.image_composer:composite_person_into_design:26 - Design size: (152, 148)
2025-10-14 11:26:40.315 | INFO     | app.services.image_composer:composite_person_into_design:27 - Person size (before resize): (576, 768)
2025-10-14 11:26:40.315 | INFO     | app.services.image_composer:composite_person_into_design:34 - Resizing person to: (300, 400)
2025-10-14 11:26:40.335 | INFO     | app.services.image_composer:composite_person_into_design:49 - Composition completed successfully
2025-10-14 11:26:40.335 | INFO     | tasks.generation_task:generate_personalized_image:185 - Composition completed successfully
2025-10-14 11:26:40.335 | INFO     | tasks.generation_task:generate_personalized_image:189 - Step 5: Saving result
2025-10-14 11:26:40.343 | INFO     | app.utils.helpers:save_image:46 - Image saved to ./output\0199e0e2-3ee8-71f2-9ffd-c0c0409aa0a7.jpg
2025-10-14 11:26:40.343 | INFO     | tasks.generation_task:generate_personalized_image:200 - Generation completed in 1406948ms
2025-10-14 11:26:40.346 | INFO     | tasks.generation_task:generate_personalized_image:203 - Step 6: Sending completion callback
2025-10-14 11:27:10.964 | ERROR    | app.utils.helpers:send_callback_to_laravel:110 - Failed to send callback to http://localhost:8000/api/internal/generations/0199e0e2-3ee8-71f2-9ffd-c0c0409aa0a7/complete: 
2025-10-14 11:27:10.973 | WARNING  | tasks.generation_task:generate_personalized_image:228 - Failed to send completion callback
2025-10-14 11:27:11.002 | INFO     | tasks.generation_task:generate_personalized_image:78 - Starting generation for 0199e0e3-289e-7106-a146-aa5b8810bc06
2025-10-14 11:27:11.002 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 1: Loading images
2025-10-14 11:27:41.070 | ERROR    | app.utils.helpers:download_image:28 - Failed to download image from http://127.0.0.1:8000/storage/campaigns/zo5Y7Qo5PSXxOJppd84fCNO5ZWwqWOE93eyBPysk.png: HTTPConnectionPool(host='127.0.0.1', port=8000): Read timed out. (read timeout=30)
2025-10-14 11:27:41.071 | ERROR    | tasks.generation_task:generate_personalized_image:238 - Generation failed for 0199e0e3-289e-7106-a146-aa5b8810bc06: Failed to download design image
2025-10-14 11:27:45.071 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199e0e3-289e-7106-a146-aa5b8810bc06/failed
2025-10-14 11:27:45.085 | ERROR    | tasks.generation_task:on_failure:46 - Task f03dd08d-8944-45df-aae2-4ac6d8777b4b failed: Failed to download design image
2025-10-14 11:27:45.735 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199e0e3-289e-7106-a146-aa5b8810bc06/failed
2025-10-14 11:34:07.591 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-14 11:35:25.263 | INFO     | tasks.generation_task:generate_personalized_image:78 - Starting generation for 0199e100-4a9f-7013-93e1-b02cfc5f205d
2025-10-14 11:35:25.264 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 1: Loading images
2025-10-14 11:35:25.336 | INFO     | tasks.generation_task:generate_personalized_image:101 - Images loaded successfully
2025-10-14 11:35:25.337 | INFO     | tasks.generation_task:generate_personalized_image:105 - Step 2: Generating person with pose: sitting_upright
2025-10-14 11:35:25.338 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-14 11:35:28.564 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-14 11:35:28.564 | INFO     | tasks.generation_task:generate_personalized_image:139 - Original size: 300x400
2025-10-14 11:35:28.564 | INFO     | tasks.generation_task:generate_personalized_image:140 - Generation size (scaled up): 576x768
2025-10-14 11:35:28.564 | INFO     | app.services.ai_generator:generate_person:113 - Generating person: sitting_upright, size: 576x768
2025-10-14 11:59:12.657 | INFO     | app.services.ai_generator:generate_person:134 - Person generated successfully
2025-10-14 11:59:12.664 | INFO     | tasks.generation_task:generate_personalized_image:153 - Person generated successfully at 576x768
2025-10-14 11:59:12.675 | INFO     | tasks.generation_task:generate_personalized_image:157 - Step 3: Performing face swap
2025-10-14 11:59:12.677 | INFO     | app.services.face_swapper:load_model:30 - Loading InsightFace models...
2025-10-14 11:59:14.618 | INFO     | app.services.face_swapper:load_model:47 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-14 11:59:18.063 | INFO     | app.services.face_swapper:load_model:52 - Face swap models loaded successfully
2025-10-14 11:59:18.066 | INFO     | app.services.face_swapper:swap_face:79 - Starting face swap process
2025-10-14 11:59:18.992 | INFO     | app.services.face_swapper:swap_face:103 - Source face detected at bbox: [ 149.97496  432.79843  725.81854 1191.7039 ]
2025-10-14 11:59:19.690 | INFO     | app.services.face_swapper:swap_face:117 - Target face detected at bbox: [121.391815 -72.8568   251.42851   84.90545 ]
2025-10-14 11:59:24.055 | INFO     | app.services.face_swapper:swap_face:126 - Face swap completed successfully
2025-10-14 11:59:24.289 | INFO     | app.services.face_swapper:enhance_face:289 - Face enhanced successfully
2025-10-14 11:59:24.292 | INFO     | tasks.generation_task:generate_personalized_image:172 - Face swap completed successfully
2025-10-14 11:59:24.294 | INFO     | tasks.generation_task:generate_personalized_image:176 - Step 4: Compositing into design
2025-10-14 11:59:24.297 | INFO     | app.services.image_composer:composite_person_into_design:25 - Compositing person into design at x=0.0 y=0.0 width=300.0 height=400.0 type='rectangle'
2025-10-14 11:59:24.297 | INFO     | app.services.image_composer:composite_person_into_design:26 - Design size: (152, 148)
2025-10-14 11:59:24.298 | INFO     | app.services.image_composer:composite_person_into_design:27 - Person size (before resize): (576, 768)
2025-10-14 11:59:24.300 | INFO     | app.services.image_composer:composite_person_into_design:34 - Resizing person to: (300, 400)
2025-10-14 11:59:24.329 | INFO     | app.services.image_composer:composite_person_into_design:49 - Composition completed successfully
2025-10-14 11:59:24.329 | INFO     | tasks.generation_task:generate_personalized_image:189 - Composition completed successfully
2025-10-14 11:59:24.331 | INFO     | tasks.generation_task:generate_personalized_image:193 - Step 5: Saving result
2025-10-14 11:59:24.343 | INFO     | app.utils.helpers:save_image:46 - Image saved to ./output\0199e100-4a9f-7013-93e1-b02cfc5f205d.jpg
2025-10-14 11:59:24.343 | INFO     | tasks.generation_task:generate_personalized_image:204 - Generation completed in 1439079ms
2025-10-14 11:59:24.344 | INFO     | tasks.generation_task:generate_personalized_image:207 - Step 6: Sending completion callback
2025-10-14 11:59:54.970 | ERROR    | app.utils.helpers:send_callback_to_laravel:110 - Failed to send callback to http://localhost:8000/api/internal/generations/0199e100-4a9f-7013-93e1-b02cfc5f205d/complete: 
2025-10-14 11:59:54.980 | WARNING  | tasks.generation_task:generate_personalized_image:232 - Failed to send completion callback
2025-10-14 13:26:35.945 | INFO     | tasks.generation_task:generate_personalized_image:78 - Starting generation for 0199e166-2c59-726b-b8cb-cebee1a5305c
2025-10-14 13:26:35.953 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 1: Loading images
2025-10-14 13:26:36.387 | INFO     | tasks.generation_task:generate_personalized_image:101 - Images loaded successfully
2025-10-14 13:26:36.389 | INFO     | tasks.generation_task:generate_personalized_image:105 - Step 2: Generating person with pose: standing_casual
2025-10-14 13:26:36.390 | INFO     | tasks.generation_task:generate_personalized_image:139 - Original size: 355x571
2025-10-14 13:26:36.391 | INFO     | tasks.generation_task:generate_personalized_image:140 - Generation size (scaled up): 472x768
2025-10-14 13:26:36.391 | INFO     | app.services.ai_generator:generate_person:113 - Generating person: standing_casual, size: 472x768
2025-10-14 13:46:27.725 | INFO     | app.services.ai_generator:generate_person:134 - Person generated successfully
2025-10-14 13:46:27.735 | INFO     | tasks.generation_task:generate_personalized_image:153 - Person generated successfully at 472x768
2025-10-14 13:46:27.746 | INFO     | tasks.generation_task:generate_personalized_image:157 - Step 3: Performing face swap
2025-10-14 13:46:27.748 | INFO     | app.services.face_swapper:swap_face:79 - Starting face swap process
2025-10-14 13:46:29.399 | INFO     | app.services.face_swapper:swap_face:103 - Source face detected at bbox: [ 149.97496  432.79843  725.81854 1191.7039 ]
2025-10-14 13:46:30.095 | INFO     | app.services.face_swapper:swap_face:117 - Target face detected at bbox: [235.82506  97.73518 278.25638 159.63237]
2025-10-14 13:46:35.476 | INFO     | app.services.face_swapper:swap_face:126 - Face swap completed successfully
2025-10-14 13:46:35.496 | INFO     | app.services.face_swapper:enhance_face:289 - Face enhanced successfully
2025-10-14 13:46:35.497 | INFO     | tasks.generation_task:generate_personalized_image:172 - Face swap completed successfully
2025-10-14 13:46:35.499 | INFO     | tasks.generation_task:generate_personalized_image:176 - Step 4: Compositing into design
2025-10-14 13:46:35.501 | INFO     | app.services.image_composer:composite_person_into_design:25 - Compositing person into design at x=760.0 y=511.0 width=355.0 height=571.0 type='rectangle'
2025-10-14 13:46:35.501 | INFO     | app.services.image_composer:composite_person_into_design:26 - Design size: (1125, 1360)
2025-10-14 13:46:35.502 | INFO     | app.services.image_composer:composite_person_into_design:27 - Person size (before resize): (472, 768)
2025-10-14 13:46:35.522 | INFO     | app.services.image_composer:composite_person_into_design:34 - Resizing person to: (355, 571)
2025-10-14 13:46:35.557 | INFO     | app.services.image_composer:composite_person_into_design:49 - Composition completed successfully
2025-10-14 13:46:35.558 | INFO     | tasks.generation_task:generate_personalized_image:189 - Composition completed successfully
2025-10-14 13:46:35.559 | INFO     | tasks.generation_task:generate_personalized_image:193 - Step 5: Saving result
2025-10-14 13:46:35.578 | INFO     | app.utils.helpers:save_image:46 - Image saved to ./output\0199e166-2c59-726b-b8cb-cebee1a5305c.jpg
2025-10-14 13:46:35.579 | INFO     | tasks.generation_task:generate_personalized_image:204 - Generation completed in 1199632ms
2025-10-14 13:46:35.579 | INFO     | tasks.generation_task:generate_personalized_image:207 - Step 6: Sending completion callback
2025-10-14 13:47:05.931 | ERROR    | app.utils.helpers:send_callback_to_laravel:110 - Failed to send callback to http://localhost:8000/api/internal/generations/0199e166-2c59-726b-b8cb-cebee1a5305c/complete: 
2025-10-14 13:47:05.937 | WARNING  | tasks.generation_task:generate_personalized_image:232 - Failed to send completion callback
2025-10-14 14:04:41.824 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-14 14:05:19.782 | INFO     | tasks.generation_task:generate_personalized_image:78 - Starting generation for 0199e189-896d-7108-be5b-bfa5ae768b06
2025-10-14 14:05:19.788 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 1: Loading images
2025-10-14 14:05:19.954 | INFO     | tasks.generation_task:generate_personalized_image:101 - Images loaded successfully
2025-10-14 14:05:19.956 | INFO     | tasks.generation_task:generate_personalized_image:105 - Step 2: Generating person with pose: standing_casual
2025-10-14 14:05:19.957 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-14 14:05:23.354 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-14 14:05:23.354 | INFO     | tasks.generation_task:generate_personalized_image:139 - Original size: 338x544
2025-10-14 14:05:23.355 | INFO     | tasks.generation_task:generate_personalized_image:140 - Generation size (scaled up): 472x768
2025-10-14 14:05:23.355 | INFO     | app.services.ai_generator:generate_person:113 - Generating person: standing_casual, size: 472x768
2025-10-14 14:26:40.306 | INFO     | app.services.ai_generator:generate_person:134 - Person generated successfully
2025-10-14 14:26:40.322 | INFO     | tasks.generation_task:generate_personalized_image:153 - Person generated successfully at 472x768
2025-10-14 14:26:40.358 | INFO     | tasks.generation_task:generate_personalized_image:157 - Step 3: Performing face swap
2025-10-14 14:26:40.360 | INFO     | app.services.face_swapper:load_model:30 - Loading InsightFace models...
2025-10-14 14:26:42.727 | INFO     | app.services.face_swapper:load_model:47 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-14 14:26:46.358 | INFO     | app.services.face_swapper:load_model:52 - Face swap models loaded successfully
2025-10-14 14:26:46.360 | INFO     | app.services.face_swapper:swap_face:79 - Starting face swap process
2025-10-14 14:26:47.532 | INFO     | app.services.face_swapper:swap_face:103 - Source face detected at bbox: [ 149.97496  432.79843  725.81854 1191.7039 ]
2025-10-14 14:26:48.427 | INFO     | app.services.face_swapper:swap_face:117 - Target face detected at bbox: [229.22305    7.556392 288.19003  101.86621 ]
2025-10-14 14:26:53.943 | INFO     | app.services.face_swapper:swap_face:126 - Face swap completed successfully
2025-10-14 14:26:54.185 | INFO     | app.services.face_swapper:enhance_face:289 - Face enhanced successfully
2025-10-14 14:26:54.185 | INFO     | tasks.generation_task:generate_personalized_image:172 - Face swap completed successfully
2025-10-14 14:26:54.194 | INFO     | tasks.generation_task:generate_personalized_image:176 - Step 4: Compositing into design
2025-10-14 14:26:54.203 | INFO     | app.services.image_composer:composite_person_into_design:25 - Compositing person into design at x=394.0 y=408.0 width=338.0 height=544.0 type='rectangle'
2025-10-14 14:26:54.203 | INFO     | app.services.image_composer:composite_person_into_design:26 - Design size: (1125, 1360)
2025-10-14 14:26:54.204 | INFO     | app.services.image_composer:composite_person_into_design:27 - Person size (before resize): (472, 768)
2025-10-14 14:26:54.234 | INFO     | app.services.image_composer:composite_person_into_design:34 - Resizing person to: (338, 544)
2025-10-14 14:26:54.276 | INFO     | app.services.image_composer:composite_person_into_design:49 - Composition completed successfully
2025-10-14 14:26:54.276 | INFO     | tasks.generation_task:generate_personalized_image:189 - Composition completed successfully
2025-10-14 14:26:54.278 | INFO     | tasks.generation_task:generate_personalized_image:193 - Step 5: Saving result
2025-10-14 14:26:54.305 | INFO     | app.utils.helpers:save_image:46 - Image saved to ./output\0199e189-896d-7108-be5b-bfa5ae768b06.jpg
2025-10-14 14:26:54.307 | INFO     | tasks.generation_task:generate_personalized_image:204 - Generation completed in 1294524ms
2025-10-14 14:26:54.308 | INFO     | tasks.generation_task:generate_personalized_image:207 - Step 6: Sending completion callback
2025-10-14 14:26:54.323 | ERROR    | tasks.generation_task:generate_personalized_image:244 - Generation failed for 0199e189-896d-7108-be5b-bfa5ae768b06: send_callback_to_laravel() got an unexpected keyword argument 'method'
2025-10-14 14:26:55.977 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199e189-896d-7108-be5b-bfa5ae768b06/failed
2025-10-14 14:26:56.047 | ERROR    | tasks.generation_task:on_failure:46 - Task eeb9c00c-b525-4250-9480-d122a57e7e5e failed: send_callback_to_laravel() got an unexpected keyword argument 'method'
2025-10-14 14:26:56.752 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199e189-896d-7108-be5b-bfa5ae768b06/failed
2025-10-14 14:30:04.681 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-14 14:30:19.491 | INFO     | tasks.generation_task:generate_personalized_image:78 - Starting generation for 0199e19f-44c1-713b-8204-e0a10073ad7d
2025-10-14 14:30:19.498 | ERROR    | tasks.generation_task:generate_personalized_image:242 - Generation failed for 0199e19f-44c1-713b-8204-e0a10073ad7d: 1 validation error for CampaignData
object_template.generation_params
  Input should be a valid dictionary [type=dict_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.12/v/dict_type
2025-10-14 14:30:20.386 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199e19f-44c1-713b-8204-e0a10073ad7d/failed
2025-10-14 14:30:20.398 | ERROR    | tasks.generation_task:on_failure:46 - Task b177d24b-a331-452f-b0bd-fcb135569c77 failed: 1 validation error for CampaignData
object_template.generation_params
  Input should be a valid dictionary [type=dict_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.12/v/dict_type
2025-10-14 14:30:21.141 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199e19f-44c1-713b-8204-e0a10073ad7d/failed
2025-10-14 14:30:43.761 | INFO     | tasks.generation_task:generate_personalized_image:78 - Starting generation for 0199e1a0-ea8c-7148-9241-93713222d153
2025-10-14 14:30:43.762 | ERROR    | tasks.generation_task:generate_personalized_image:242 - Generation failed for 0199e1a0-ea8c-7148-9241-93713222d153: 1 validation error for CampaignData
object_template.generation_params
  Input should be a valid dictionary [type=dict_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.12/v/dict_type
2025-10-14 14:30:44.967 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199e1a0-ea8c-7148-9241-93713222d153/failed
2025-10-14 14:30:44.976 | ERROR    | tasks.generation_task:on_failure:46 - Task 2f52d4d8-df60-498f-b396-132cd9e70c83 failed: 1 validation error for CampaignData
object_template.generation_params
  Input should be a valid dictionary [type=dict_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.12/v/dict_type
2025-10-14 14:30:45.927 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199e1a0-ea8c-7148-9241-93713222d153/failed
2025-10-14 14:31:34.412 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-14 14:32:02.519 | INFO     | tasks.generation_task:generate_personalized_image:78 - Starting generation for 0199e1a2-1628-7194-9418-d84f7d352d66
2025-10-14 14:32:02.522 | ERROR    | tasks.generation_task:generate_personalized_image:242 - Generation failed for 0199e1a2-1628-7194-9418-d84f7d352d66: 1 validation error for CampaignData
object_template.generation_params
  Input should be a valid dictionary [type=dict_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.12/v/dict_type
2025-10-14 14:32:03.410 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199e1a2-1628-7194-9418-d84f7d352d66/failed
2025-10-14 14:32:03.420 | ERROR    | tasks.generation_task:on_failure:46 - Task b144faed-1e11-4d44-977b-49a42e619912 failed: 1 validation error for CampaignData
object_template.generation_params
  Input should be a valid dictionary [type=dict_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.12/v/dict_type
2025-10-14 14:32:04.230 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199e1a2-1628-7194-9418-d84f7d352d66/failed
2025-10-14 14:33:20.623 | INFO     | tasks.generation_task:generate_personalized_image:78 - Starting generation for 0199e1a3-4f5b-7189-a7fb-f82a964ca754
2025-10-14 14:33:20.623 | ERROR    | tasks.generation_task:generate_personalized_image:242 - Generation failed for 0199e1a3-4f5b-7189-a7fb-f82a964ca754: 1 validation error for CampaignData
object_template.generation_params
  Input should be a valid dictionary [type=dict_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.12/v/dict_type
2025-10-14 14:33:21.764 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199e1a3-4f5b-7189-a7fb-f82a964ca754/failed
2025-10-14 14:33:21.772 | ERROR    | tasks.generation_task:on_failure:46 - Task fe5dfb13-dd00-4f15-989b-52afe8788045 failed: 1 validation error for CampaignData
object_template.generation_params
  Input should be a valid dictionary [type=dict_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.12/v/dict_type
2025-10-14 14:33:22.645 | INFO     | app.utils.helpers:send_callback_to_laravel:107 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199e1a3-4f5b-7189-a7fb-f82a964ca754/failed
2025-10-14 14:41:26.533 | INFO     | tasks.generation_task:generate_personalized_image:78 - Starting generation for 0199e1aa-b95c-72a0-a7b8-4c782e51c018
2025-10-14 14:41:26.535 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 1: Loading images
2025-10-14 14:41:27.289 | INFO     | tasks.generation_task:generate_personalized_image:101 - Images loaded successfully
2025-10-14 14:41:27.292 | INFO     | tasks.generation_task:generate_personalized_image:105 - Step 2: Generating person with pose: standing
2025-10-14 14:41:27.297 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-14 14:41:30.574 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-14 14:41:30.575 | INFO     | tasks.generation_task:generate_personalized_image:139 - Original size: 338x566
2025-10-14 14:41:30.575 | INFO     | tasks.generation_task:generate_personalized_image:140 - Generation size (scaled up): 456x768
2025-10-14 14:41:30.576 | INFO     | app.services.ai_generator:generate_person:113 - Generating person: standing, size: 456x768
2025-10-14 14:59:26.255 | INFO     | app.services.ai_generator:generate_person:134 - Person generated successfully
2025-10-14 14:59:26.256 | INFO     | tasks.generation_task:generate_personalized_image:153 - Person generated successfully at 456x768
2025-10-14 14:59:26.258 | INFO     | tasks.generation_task:generate_personalized_image:157 - Step 3: Performing face swap
2025-10-14 14:59:26.258 | INFO     | app.services.face_swapper:load_model:30 - Loading InsightFace models...
2025-10-14 14:59:28.144 | INFO     | app.services.face_swapper:load_model:47 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-14 14:59:31.135 | INFO     | app.services.face_swapper:load_model:52 - Face swap models loaded successfully
2025-10-14 14:59:31.135 | INFO     | app.services.face_swapper:swap_face:79 - Starting face swap process
2025-10-14 14:59:32.008 | INFO     | app.services.face_swapper:swap_face:103 - Source face detected at bbox: [ 149.97496  432.79843  725.81854 1191.7039 ]
2025-10-14 14:59:32.730 | INFO     | app.services.face_swapper:swap_face:117 - Target face detected at bbox: [160.0916  152.34816 226.21802 234.53796]
2025-10-14 14:59:37.000 | INFO     | app.services.face_swapper:swap_face:126 - Face swap completed successfully
2025-10-14 14:59:37.259 | INFO     | app.services.face_swapper:enhance_face:289 - Face enhanced successfully
2025-10-14 14:59:37.264 | INFO     | tasks.generation_task:generate_personalized_image:172 - Face swap completed successfully
2025-10-14 14:59:37.267 | INFO     | tasks.generation_task:generate_personalized_image:176 - Step 4: Compositing into design
2025-10-14 14:59:37.267 | INFO     | app.services.image_composer:composite_person_into_design:25 - Compositing person into design at x=765.0 y=520.0 width=338.0 height=566.0 type='rectangle'
2025-10-14 14:59:37.267 | INFO     | app.services.image_composer:composite_person_into_design:26 - Design size: (1125, 1360)
2025-10-14 14:59:37.267 | INFO     | app.services.image_composer:composite_person_into_design:27 - Person size (before resize): (456, 768)
2025-10-14 14:59:37.267 | INFO     | app.services.image_composer:composite_person_into_design:34 - Resizing person to: (338, 566)
2025-10-14 14:59:37.298 | INFO     | app.services.image_composer:composite_person_into_design:49 - Composition completed successfully
2025-10-14 14:59:37.299 | INFO     | tasks.generation_task:generate_personalized_image:189 - Composition completed successfully
2025-10-14 14:59:37.300 | INFO     | tasks.generation_task:generate_personalized_image:193 - Step 5: Saving result
2025-10-14 14:59:37.317 | INFO     | app.utils.helpers:save_image:46 - Image saved to ./output\0199e1aa-b95c-72a0-a7b8-4c782e51c018.jpg
2025-10-14 14:59:37.317 | INFO     | tasks.generation_task:generate_personalized_image:204 - Generation completed in 1090784ms
2025-10-14 14:59:37.317 | INFO     | tasks.generation_task:generate_personalized_image:207 - Step 6: Sending completion callback
2025-10-14 15:00:07.625 | ERROR    | app.utils.helpers:send_callback_to_laravel:110 - Failed to send callback to http://localhost:8000/api/internal/generations/0199e1aa-b95c-72a0-a7b8-4c782e51c018/complete: 
2025-10-14 15:00:07.630 | WARNING  | tasks.generation_task:generate_personalized_image:232 - Failed to send completion callback
2025-10-14 15:38:14.084 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-14 15:40:28.252 | INFO     | tasks.generation_task:generate_personalized_image:78 - 🚀 Starting generation for 0199e1e0-a3d8-73af-b06f-e089a5485a55
2025-10-14 15:40:28.253 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 0: Analyzing source face
2025-10-14 15:40:28.319 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-14 15:40:31.193 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-14 15:40:35.151 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-14 15:40:35.886 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-14 15:40:35.887 | INFO     | tasks.generation_task:generate_personalized_image:101 - ✅ Face Analysis Results:
2025-10-14 15:40:35.888 | INFO     | tasks.generation_task:generate_personalized_image:102 -    - Gender: male
2025-10-14 15:40:35.888 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Age: 38
2025-10-14 15:40:35.889 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Detection Score: 0.8678815364837646
2025-10-14 15:40:35.891 | INFO     | tasks.generation_task:generate_personalized_image:118 - Step 1: Loading design image
2025-10-14 15:40:35.957 | INFO     | tasks.generation_task:generate_personalized_image:123 - ✅ Images loaded successfully
2025-10-14 15:40:35.959 | INFO     | tasks.generation_task:generate_personalized_image:130 - Step 2: Generating male person with pose: standing
2025-10-14 15:40:35.960 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-14 15:40:38.343 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-14 15:40:38.343 | INFO     | tasks.generation_task:generate_personalized_image:164 - Original size: 338x566
2025-10-14 15:40:38.343 | INFO     | tasks.generation_task:generate_personalized_image:165 - Generation size (scaled up): 456x768
2025-10-14 15:40:38.343 | INFO     | app.utils.helpers:create_pose_prompt:226 - Generated prompt: professional photo, adult handsome Indonesian man, masculine features, male person, standing naturally with confident posture, full body visible, high quality, detailed, sharp focus, professional phot...
2025-10-14 15:40:38.343 | INFO     | app.services.ai_generator:generate_person:124 - 🎨 Generating male person: standing, size: 456x768
2025-10-14 15:58:15.002 | INFO     | app.services.ai_generator:generate_person:146 - ✅ Male person generated successfully
2025-10-14 15:58:15.007 | INFO     | tasks.generation_task:generate_personalized_image:181 - ✅ Male person generated at 456x768
2025-10-14 15:58:15.018 | INFO     | tasks.generation_task:generate_personalized_image:185 - Step 3: Performing face swap
2025-10-14 15:58:15.019 | INFO     | app.services.face_swapper:swap_face:225 - Starting face swap process
2025-10-14 15:58:15.991 | INFO     | app.services.face_swapper:swap_face:249 - ✅ Source face detected at bbox: [ 149.97496  432.79843  725.81854 1191.7039 ]
2025-10-14 15:58:16.766 | INFO     | app.services.face_swapper:swap_face:264 - ✅ Target face detected at bbox: [238.61658  81.74307 319.09995 193.43141]
2025-10-14 15:58:20.981 | INFO     | app.services.face_swapper:swap_face:273 - ✅ Face swap completed successfully
2025-10-14 15:58:21.295 | INFO     | app.services.face_swapper:enhance_face:436 - Face enhanced successfully
2025-10-14 15:58:21.296 | INFO     | tasks.generation_task:generate_personalized_image:199 - ✅ Face swap completed successfully
2025-10-14 15:58:21.299 | INFO     | tasks.generation_task:generate_personalized_image:204 - Step 4: Compositing into design
2025-10-14 15:58:21.302 | INFO     | app.services.image_composer:composite_person_into_design:25 - Compositing person into design at x=765.0 y=520.0 width=338.0 height=566.0 type='rectangle'
2025-10-14 15:58:21.303 | INFO     | app.services.image_composer:composite_person_into_design:26 - Design size: (1125, 1360)
2025-10-14 15:58:21.303 | INFO     | app.services.image_composer:composite_person_into_design:27 - Person size (before resize): (456, 768)
2025-10-14 15:58:21.318 | INFO     | app.services.image_composer:composite_person_into_design:34 - Resizing person to: (338, 566)
2025-10-14 15:58:21.351 | INFO     | app.services.image_composer:composite_person_into_design:49 - Composition completed successfully
2025-10-14 15:58:21.351 | INFO     | tasks.generation_task:generate_personalized_image:217 - ✅ Composition completed successfully
2025-10-14 15:58:21.353 | INFO     | tasks.generation_task:generate_personalized_image:221 - Step 5: Saving result
2025-10-14 15:58:21.374 | INFO     | app.utils.helpers:save_image:29 - Image saved to ./output\0199e1e0-a3d8-73af-b06f-e089a5485a55.jpg
2025-10-14 15:58:21.375 | INFO     | tasks.generation_task:generate_personalized_image:232 - ✅ Generation completed in 1073122ms
2025-10-14 15:58:21.375 | INFO     | tasks.generation_task:generate_personalized_image:235 - Step 6: Sending completion callback
2025-10-14 15:58:51.954 | ERROR    | app.utils.helpers:send_callback_to_laravel:73 - Failed to send callback to http://localhost:8000/api/internal/generations/0199e1e0-a3d8-73af-b06f-e089a5485a55/complete: 
2025-10-14 15:58:51.964 | WARNING  | tasks.generation_task:generate_personalized_image:262 - Failed to send completion callback
2025-10-16 09:23:21.498 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-16 09:54:52.342 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-16 09:55:27.802 | INFO     | tasks.generation_task:generate_personalized_image:78 - 🚀 Starting generation for 0199eaf1-7a95-732c-a694-1545c1796c8f
2025-10-16 09:55:27.807 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 0: Analyzing source face
2025-10-16 09:55:27.981 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-16 09:55:31.948 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-16 09:55:36.154 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-16 09:55:37.050 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-16 09:55:37.052 | INFO     | tasks.generation_task:generate_personalized_image:101 - ✅ Face Analysis Results:
2025-10-16 09:55:37.053 | INFO     | tasks.generation_task:generate_personalized_image:102 -    - Gender: male
2025-10-16 09:55:37.054 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Age: 38
2025-10-16 09:55:37.054 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Detection Score: 0.8678815364837646
2025-10-16 09:55:37.057 | INFO     | tasks.generation_task:generate_personalized_image:118 - Step 1: Loading design image
2025-10-16 09:55:37.114 | INFO     | tasks.generation_task:generate_personalized_image:123 - ✅ Images loaded successfully
2025-10-16 09:55:37.118 | INFO     | tasks.generation_task:generate_personalized_image:130 - Step 2: Generating male person with pose: custom
2025-10-16 09:55:37.120 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-16 09:55:40.248 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-16 09:55:40.249 | ERROR    | tasks.generation_task:generate_personalized_image:297 - ❌ Generation failed for 0199eaf1-7a95-732c-a694-1545c1796c8f: 'ObjectTemplate' object has no attribute 'get'
2025-10-16 09:55:41.108 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199eaf1-7a95-732c-a694-1545c1796c8f/failed
2025-10-16 09:55:41.138 | ERROR    | tasks.generation_task:on_failure:46 - Task 22564852-ebc0-442a-82a1-269005f0da75 failed: 'ObjectTemplate' object has no attribute 'get'
2025-10-16 09:55:41.770 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199eaf1-7a95-732c-a694-1545c1796c8f/failed
2025-10-16 09:56:30.457 | INFO     | tasks.generation_task:generate_personalized_image:78 - 🚀 Starting generation for 0199eaf2-93d6-710e-b6fe-938a1e291b39
2025-10-16 09:56:30.457 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 0: Analyzing source face
2025-10-16 09:56:31.516 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-16 09:56:31.517 | INFO     | tasks.generation_task:generate_personalized_image:101 - ✅ Face Analysis Results:
2025-10-16 09:56:31.517 | INFO     | tasks.generation_task:generate_personalized_image:102 -    - Gender: male
2025-10-16 09:56:31.521 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Age: 38
2025-10-16 09:56:31.527 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Detection Score: 0.8678815364837646
2025-10-16 09:56:31.529 | INFO     | tasks.generation_task:generate_personalized_image:118 - Step 1: Loading design image
2025-10-16 09:56:31.587 | INFO     | tasks.generation_task:generate_personalized_image:123 - ✅ Images loaded successfully
2025-10-16 09:56:31.589 | INFO     | tasks.generation_task:generate_personalized_image:130 - Step 2: Generating male person with pose: custom
2025-10-16 09:56:31.592 | ERROR    | tasks.generation_task:generate_personalized_image:297 - ❌ Generation failed for 0199eaf2-93d6-710e-b6fe-938a1e291b39: 'ObjectTemplate' object has no attribute 'get'
2025-10-16 09:56:32.883 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199eaf2-93d6-710e-b6fe-938a1e291b39/failed
2025-10-16 09:56:32.893 | ERROR    | tasks.generation_task:on_failure:46 - Task 7e98b6dc-8e38-4077-aa4c-851d85e063a3 failed: 'ObjectTemplate' object has no attribute 'get'
2025-10-16 09:56:33.561 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199eaf2-93d6-710e-b6fe-938a1e291b39/failed
2025-10-16 09:59:29.054 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-16 10:00:24.762 | INFO     | tasks.generation_task:generate_personalized_image:78 - 🚀 Starting generation for 0199eaf6-064f-72e9-a89b-1155428c34e7
2025-10-16 10:00:24.762 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 0: Analyzing source face
2025-10-16 10:00:24.823 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-16 10:00:26.933 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-16 10:00:30.607 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-16 10:00:31.397 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-16 10:00:31.398 | INFO     | tasks.generation_task:generate_personalized_image:101 - ✅ Face Analysis Results:
2025-10-16 10:00:31.399 | INFO     | tasks.generation_task:generate_personalized_image:102 -    - Gender: male
2025-10-16 10:00:31.399 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Age: 38
2025-10-16 10:00:31.399 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Detection Score: 0.8678815364837646
2025-10-16 10:00:31.401 | INFO     | tasks.generation_task:generate_personalized_image:118 - Step 1: Loading design image
2025-10-16 10:00:31.451 | INFO     | tasks.generation_task:generate_personalized_image:123 - ✅ Images loaded successfully
2025-10-16 10:00:31.452 | INFO     | tasks.generation_task:generate_personalized_image:130 - Step 2: Generating male person with pose: custom
2025-10-16 10:00:31.453 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-16 10:00:34.499 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-16 10:00:34.499 | ERROR    | tasks.generation_task:generate_personalized_image:297 - ❌ Generation failed for 0199eaf6-064f-72e9-a89b-1155428c34e7: 'ObjectTemplate' object has no attribute 'get'
2025-10-16 10:00:35.285 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199eaf6-064f-72e9-a89b-1155428c34e7/failed
2025-10-16 10:00:35.295 | ERROR    | tasks.generation_task:on_failure:46 - Task f6f655b5-1e7d-460c-95fb-df8c903d06a5 failed: 'ObjectTemplate' object has no attribute 'get'
2025-10-16 10:00:35.911 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199eaf6-064f-72e9-a89b-1155428c34e7/failed
2025-10-16 10:01:53.553 | INFO     | tasks.generation_task:generate_personalized_image:78 - 🚀 Starting generation for 0199eaf7-4718-72a7-b649-cbaa5dd04de9
2025-10-16 10:01:53.556 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 0: Analyzing source face
2025-10-16 10:01:54.287 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-16 10:01:54.288 | INFO     | tasks.generation_task:generate_personalized_image:101 - ✅ Face Analysis Results:
2025-10-16 10:01:54.289 | INFO     | tasks.generation_task:generate_personalized_image:102 -    - Gender: male
2025-10-16 10:01:54.289 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Age: 38
2025-10-16 10:01:54.289 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Detection Score: 0.8678815364837646
2025-10-16 10:01:54.291 | INFO     | tasks.generation_task:generate_personalized_image:118 - Step 1: Loading design image
2025-10-16 10:01:54.347 | INFO     | tasks.generation_task:generate_personalized_image:123 - ✅ Images loaded successfully
2025-10-16 10:01:54.350 | INFO     | tasks.generation_task:generate_personalized_image:130 - Step 2: Generating male person with pose: custom
2025-10-16 10:01:54.350 | ERROR    | tasks.generation_task:generate_personalized_image:297 - ❌ Generation failed for 0199eaf7-4718-72a7-b649-cbaa5dd04de9: 'ObjectTemplate' object has no attribute 'get'
2025-10-16 10:01:55.172 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199eaf7-4718-72a7-b649-cbaa5dd04de9/failed
2025-10-16 10:01:55.186 | ERROR    | tasks.generation_task:on_failure:46 - Task efe6180d-092a-42ee-abaf-363a0b3bbbf9 failed: 'ObjectTemplate' object has no attribute 'get'
2025-10-16 10:01:55.932 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199eaf7-4718-72a7-b649-cbaa5dd04de9/failed
2025-10-16 10:02:24.047 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-16 10:04:24.967 | INFO     | tasks.generation_task:generate_personalized_image:78 - 🚀 Starting generation for 0199eaf9-b15f-724f-9a11-bd9d86ddfba1
2025-10-16 10:04:24.969 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 0: Analyzing source face
2025-10-16 10:04:25.035 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-16 10:04:26.793 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-16 10:04:29.342 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-16 10:04:30.087 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-16 10:04:30.087 | INFO     | tasks.generation_task:generate_personalized_image:101 - ✅ Face Analysis Results:
2025-10-16 10:04:30.087 | INFO     | tasks.generation_task:generate_personalized_image:102 -    - Gender: male
2025-10-16 10:04:30.087 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Age: 38
2025-10-16 10:04:30.087 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Detection Score: 0.8678815364837646
2025-10-16 10:04:30.087 | INFO     | tasks.generation_task:generate_personalized_image:118 - Step 1: Loading design image
2025-10-16 10:04:30.417 | INFO     | tasks.generation_task:generate_personalized_image:123 - ✅ Images loaded successfully
2025-10-16 10:04:30.432 | INFO     | tasks.generation_task:generate_personalized_image:130 - Step 2: Generating male person with pose: custom
2025-10-16 10:04:30.432 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-16 10:04:33.687 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-16 10:04:33.688 | INFO     | tasks.generation_task:generate_personalized_image:146 - 📋 Template Config:
2025-10-16 10:04:33.688 | INFO     | tasks.generation_task:generate_personalized_image:147 -    - Has base_prompt: False
2025-10-16 10:04:33.689 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has negative_prompt: False
2025-10-16 10:04:33.689 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Min size: 768x1024
2025-10-16 10:04:33.689 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Guidance: 7.5, Steps: 30
2025-10-16 10:04:33.689 | INFO     | tasks.generation_task:generate_personalized_image:179 - Original size: 338x544
2025-10-16 10:04:33.689 | INFO     | tasks.generation_task:generate_personalized_image:180 - Generation size (scaled up): 632x1024
2025-10-16 10:04:33.691 | INFO     | app.utils.helpers:create_pose_prompt:162 - 🔧 Using AUTO-GENERATED prompt
2025-10-16 10:04:33.691 | INFO     | app.utils.helpers:create_pose_prompt:276 - Generated prompt: professional photo, adult handsome Indonesian man, masculine features, male person, custom pose, high quality, detailed, sharp focus, professional photography, 8k uhd, photorealistic, full body visibl...
2025-10-16 10:04:33.691 | INFO     | app.utils.helpers:create_negative_prompt:301 - 🔧 Using AUTO-GENERATED negative prompt
2025-10-16 10:04:33.691 | INFO     | app.services.ai_generator:generate_person:124 - 🎨 Generating male person: custom, size: 632x1024
2025-10-16 10:23:30.342 | ERROR    | app.services.ai_generator:generate_person:151 - ❌ Failed to generate person: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-16 10:23:30.351 | ERROR    | tasks.generation_task:generate_personalized_image:297 - ❌ Generation failed for 0199eaf9-b15f-724f-9a11-bd9d86ddfba1: Failed to generate person image
2025-10-16 10:23:30.430 | ERROR    | app.utils.helpers:send_callback_to_laravel:73 - Failed to send callback to http://localhost:8000/api/internal/generations/0199eaf9-b15f-724f-9a11-bd9d86ddfba1/failed: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-16 10:23:30.468 | ERROR    | tasks.generation_task:on_failure:46 - Task e809f040-e0db-4376-888a-7ac829010331 failed: Failed to generate person image
2025-10-16 10:24:14.015 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-16 10:24:28.880 | INFO     | tasks.generation_task:generate_personalized_image:78 - 🚀 Starting generation for 0199eaf9-b15f-724f-9a11-bd9d86ddfba1
2025-10-16 10:24:28.882 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 0: Analyzing source face
2025-10-16 10:24:28.942 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-16 10:24:31.019 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-16 10:24:34.597 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-16 10:24:35.337 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-16 10:24:35.340 | INFO     | tasks.generation_task:generate_personalized_image:101 - ✅ Face Analysis Results:
2025-10-16 10:24:35.340 | INFO     | tasks.generation_task:generate_personalized_image:102 -    - Gender: male
2025-10-16 10:24:35.340 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Age: 38
2025-10-16 10:24:35.340 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Detection Score: 0.8678815364837646
2025-10-16 10:24:35.343 | INFO     | tasks.generation_task:generate_personalized_image:118 - Step 1: Loading design image
2025-10-16 10:24:35.410 | INFO     | tasks.generation_task:generate_personalized_image:123 - ✅ Images loaded successfully
2025-10-16 10:24:35.412 | INFO     | tasks.generation_task:generate_personalized_image:130 - Step 2: Generating male person with pose: custom
2025-10-16 10:24:35.413 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-16 10:24:38.139 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-16 10:24:38.141 | INFO     | tasks.generation_task:generate_personalized_image:146 - 📋 Template Config:
2025-10-16 10:24:38.142 | INFO     | tasks.generation_task:generate_personalized_image:147 -    - Has base_prompt: False
2025-10-16 10:24:38.142 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has negative_prompt: False
2025-10-16 10:24:38.142 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Min size: 768x1024
2025-10-16 10:24:38.144 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Guidance: 7.5, Steps: 30
2025-10-16 10:24:38.144 | INFO     | tasks.generation_task:generate_personalized_image:179 - Original size: 338x544
2025-10-16 10:24:38.144 | INFO     | tasks.generation_task:generate_personalized_image:180 - Generation size (scaled up): 632x1024
2025-10-16 10:24:38.144 | INFO     | app.utils.helpers:create_pose_prompt:162 - 🔧 Using AUTO-GENERATED prompt
2025-10-16 10:24:38.144 | INFO     | app.utils.helpers:create_pose_prompt:276 - Generated prompt: professional photo, adult handsome Indonesian man, masculine features, male person, custom pose, high quality, detailed, sharp focus, professional photography, 8k uhd, photorealistic, full body visibl...
2025-10-16 10:24:38.144 | INFO     | app.utils.helpers:create_negative_prompt:301 - 🔧 Using AUTO-GENERATED negative prompt
2025-10-16 10:24:38.144 | INFO     | app.services.ai_generator:generate_person:124 - 🎨 Generating male person: custom, size: 632x1024
2025-10-16 10:32:52.375 | ERROR    | app.services.ai_generator:generate_person:151 - ❌ Failed to generate person: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-16 10:32:52.380 | ERROR    | tasks.generation_task:generate_personalized_image:297 - ❌ Generation failed for 0199eaf9-b15f-724f-9a11-bd9d86ddfba1: Failed to generate person image
2025-10-16 10:32:52.522 | ERROR    | app.utils.helpers:send_callback_to_laravel:73 - Failed to send callback to http://localhost:8000/api/internal/generations/0199eaf9-b15f-724f-9a11-bd9d86ddfba1/failed: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-16 10:32:52.538 | ERROR    | tasks.generation_task:on_failure:46 - Task e809f040-e0db-4376-888a-7ac829010331 failed: Failed to generate person image
2025-10-16 10:33:38.950 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-16 10:33:53.823 | INFO     | tasks.generation_task:generate_personalized_image:78 - 🚀 Starting generation for 0199eaf9-b15f-724f-9a11-bd9d86ddfba1
2025-10-16 10:33:53.828 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 0: Analyzing source face
2025-10-16 10:33:53.933 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-16 10:33:56.414 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-16 10:34:00.574 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-16 10:34:01.327 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-16 10:34:01.329 | INFO     | tasks.generation_task:generate_personalized_image:101 - ✅ Face Analysis Results:
2025-10-16 10:34:01.330 | INFO     | tasks.generation_task:generate_personalized_image:102 -    - Gender: male
2025-10-16 10:34:01.331 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Age: 38
2025-10-16 10:34:01.332 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Detection Score: 0.8678815364837646
2025-10-16 10:34:01.333 | INFO     | tasks.generation_task:generate_personalized_image:118 - Step 1: Loading design image
2025-10-16 10:34:01.384 | INFO     | tasks.generation_task:generate_personalized_image:123 - ✅ Images loaded successfully
2025-10-16 10:34:01.398 | INFO     | tasks.generation_task:generate_personalized_image:130 - Step 2: Generating male person with pose: custom
2025-10-16 10:34:01.398 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-16 10:34:04.939 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-16 10:34:04.939 | INFO     | tasks.generation_task:generate_personalized_image:146 - 📋 Template Config:
2025-10-16 10:34:04.939 | INFO     | tasks.generation_task:generate_personalized_image:147 -    - Has base_prompt: False
2025-10-16 10:34:04.939 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has negative_prompt: False
2025-10-16 10:34:04.939 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Min size: 768x1024
2025-10-16 10:34:04.939 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Guidance: 7.5, Steps: 30
2025-10-16 10:34:04.939 | INFO     | tasks.generation_task:generate_personalized_image:179 - Original size: 338x544
2025-10-16 10:34:04.939 | INFO     | tasks.generation_task:generate_personalized_image:180 - Generation size (scaled up): 632x1024
2025-10-16 10:34:04.939 | INFO     | app.utils.helpers:create_pose_prompt:162 - 🔧 Using AUTO-GENERATED prompt
2025-10-16 10:34:04.939 | INFO     | app.utils.helpers:create_pose_prompt:276 - Generated prompt: professional photo, adult handsome Indonesian man, masculine features, male person, custom pose, high quality, detailed, sharp focus, professional photography, 8k uhd, photorealistic, full body visibl...
2025-10-16 10:34:04.939 | INFO     | app.utils.helpers:create_negative_prompt:301 - 🔧 Using AUTO-GENERATED negative prompt
2025-10-16 10:34:04.939 | INFO     | app.services.ai_generator:generate_person:124 - 🎨 Generating male person: custom, size: 632x1024
2025-10-16 10:34:11.837 | ERROR    | app.services.ai_generator:generate_person:151 - ❌ Failed to generate person: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-16 10:34:11.838 | ERROR    | tasks.generation_task:generate_personalized_image:297 - ❌ Generation failed for 0199eaf9-b15f-724f-9a11-bd9d86ddfba1: Failed to generate person image
2025-10-16 10:34:12.026 | ERROR    | app.utils.helpers:send_callback_to_laravel:73 - Failed to send callback to http://localhost:8000/api/internal/generations/0199eaf9-b15f-724f-9a11-bd9d86ddfba1/failed: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-16 10:34:12.029 | ERROR    | tasks.generation_task:on_failure:46 - Task e809f040-e0db-4376-888a-7ac829010331 failed: Failed to generate person image
2025-10-16 10:34:12.687 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199eaf9-b15f-724f-9a11-bd9d86ddfba1/failed
2025-10-16 10:34:29.882 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-16 10:34:44.650 | INFO     | tasks.generation_task:generate_personalized_image:78 - 🚀 Starting generation for 0199eb11-ee5c-728d-b7c3-08961d6e5c2b
2025-10-16 10:34:44.650 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 0: Analyzing source face
2025-10-16 10:34:44.694 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-16 10:34:46.418 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-16 10:34:48.566 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-16 10:34:48.972 | WARNING  | app.services.face_swapper:get_face_attributes:164 - No face detected
2025-10-16 10:34:48.974 | INFO     | tasks.generation_task:generate_personalized_image:101 - ✅ Face Analysis Results:
2025-10-16 10:34:48.974 | INFO     | tasks.generation_task:generate_personalized_image:102 -    - Gender: neutral
2025-10-16 10:34:48.975 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Age: None
2025-10-16 10:34:48.975 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Detection Score: N/A
2025-10-16 10:34:48.976 | ERROR    | tasks.generation_task:generate_personalized_image:297 - ❌ Generation failed for 0199eb11-ee5c-728d-b7c3-08961d6e5c2b: ❌ No face detected in source image!
2025-10-16 10:34:49.830 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199eb11-ee5c-728d-b7c3-08961d6e5c2b/failed
2025-10-16 10:34:49.837 | ERROR    | tasks.generation_task:on_failure:46 - Task f50634ee-5972-4abc-8c35-80dfd743b89a failed: ❌ No face detected in source image!
2025-10-16 10:34:50.521 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199eb11-ee5c-728d-b7c3-08961d6e5c2b/failed
2025-10-16 10:36:01.002 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-16 10:36:27.918 | INFO     | tasks.generation_task:generate_personalized_image:78 - 🚀 Starting generation for 0199eb17-0895-710b-8e23-93ed73abe949
2025-10-16 10:36:27.920 | INFO     | tasks.generation_task:generate_personalized_image:88 - Step 0: Analyzing source face
2025-10-16 10:36:27.971 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-16 10:36:29.764 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-16 10:36:31.692 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-16 10:36:32.328 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-16 10:36:32.329 | INFO     | tasks.generation_task:generate_personalized_image:101 - ✅ Face Analysis Results:
2025-10-16 10:36:32.329 | INFO     | tasks.generation_task:generate_personalized_image:102 -    - Gender: male
2025-10-16 10:36:32.330 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Age: 38
2025-10-16 10:36:32.330 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Detection Score: 0.8678815364837646
2025-10-16 10:36:32.331 | INFO     | tasks.generation_task:generate_personalized_image:118 - Step 1: Loading design image
2025-10-16 10:36:32.350 | INFO     | tasks.generation_task:generate_personalized_image:123 - ✅ Images loaded successfully
2025-10-16 10:36:32.352 | INFO     | tasks.generation_task:generate_personalized_image:130 - Step 2: Generating male person with pose: sitting
2025-10-16 10:36:32.353 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-16 10:36:35.515 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-16 10:36:35.516 | INFO     | tasks.generation_task:generate_personalized_image:146 - 📋 Template Config:
2025-10-16 10:36:35.516 | INFO     | tasks.generation_task:generate_personalized_image:147 -    - Has base_prompt: False
2025-10-16 10:36:35.517 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has negative_prompt: False
2025-10-16 10:36:35.517 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Min size: 768x1024
2025-10-16 10:36:35.518 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Guidance: 7.5, Steps: 30
2025-10-16 10:36:35.519 | INFO     | tasks.generation_task:generate_personalized_image:179 - Original size: 565x625
2025-10-16 10:36:35.519 | INFO     | tasks.generation_task:generate_personalized_image:180 - Generation size (scaled up): 920x1024
2025-10-16 10:36:35.519 | INFO     | app.utils.helpers:create_pose_prompt:162 - 🔧 Using AUTO-GENERATED prompt
2025-10-16 10:36:35.519 | INFO     | app.utils.helpers:create_pose_prompt:276 - Generated prompt: professional photo, adult handsome Indonesian man, masculine features, male person, sitting upright on a chair with good posture, formal seated position, high quality, detailed, sharp focus, professio...
2025-10-16 10:36:35.519 | INFO     | app.utils.helpers:create_negative_prompt:301 - 🔧 Using AUTO-GENERATED negative prompt
2025-10-16 10:36:35.519 | INFO     | app.services.ai_generator:generate_person:124 - 🎨 Generating male person: sitting, size: 920x1024
2025-10-16 11:48:00.882 | INFO     | app.services.ai_generator:generate_person:146 - ✅ Male person generated successfully
2025-10-16 11:48:00.901 | INFO     | tasks.generation_task:generate_personalized_image:202 - ✅ Male person generated at 920x1024
2025-10-16 11:48:00.939 | INFO     | tasks.generation_task:generate_personalized_image:206 - Step 3: Performing face swap
2025-10-16 11:48:00.941 | INFO     | app.services.face_swapper:swap_face:225 - Starting face swap process
2025-10-16 11:48:02.193 | INFO     | app.services.face_swapper:swap_face:249 - ✅ Source face detected at bbox: [ 149.97496  432.79843  725.81854 1191.7039 ]
2025-10-16 11:48:02.988 | INFO     | app.services.face_swapper:swap_face:264 - ✅ Target face detected at bbox: [238.1137    46.310192 357.11237  211.09834 ]
2025-10-16 11:48:07.748 | INFO     | app.services.face_swapper:swap_face:273 - ✅ Face swap completed successfully
2025-10-16 11:48:08.005 | INFO     | app.services.face_swapper:enhance_face:436 - Face enhanced successfully
2025-10-16 11:48:08.007 | INFO     | tasks.generation_task:generate_personalized_image:220 - ✅ Face swap completed successfully
2025-10-16 11:48:08.009 | INFO     | tasks.generation_task:generate_personalized_image:225 - Step 4: Compositing into design
2025-10-16 11:48:08.014 | INFO     | app.services.image_composer:composite_person_into_design:25 - Compositing person into design at x=21.0 y=0.0 width=565.0 height=625.0 type='rectangle'
2025-10-16 11:48:08.014 | INFO     | app.services.image_composer:composite_person_into_design:26 - Design size: (600, 600)
2025-10-16 11:48:08.015 | INFO     | app.services.image_composer:composite_person_into_design:27 - Person size (before resize): (920, 1024)
2025-10-16 11:48:08.019 | INFO     | app.services.image_composer:composite_person_into_design:34 - Resizing person to: (565, 625)
2025-10-16 11:48:08.070 | INFO     | app.services.image_composer:composite_person_into_design:49 - Composition completed successfully
2025-10-16 11:48:08.071 | INFO     | tasks.generation_task:generate_personalized_image:238 - ✅ Composition completed successfully
2025-10-16 11:48:08.073 | INFO     | tasks.generation_task:generate_personalized_image:242 - Step 5: Saving result
2025-10-16 11:48:08.092 | INFO     | app.utils.helpers:save_image:29 - Image saved to ./output\0199eb17-0895-710b-8e23-93ed73abe949.jpg
2025-10-16 11:48:08.094 | INFO     | tasks.generation_task:generate_personalized_image:253 - ✅ Generation completed in 4300174ms
2025-10-16 11:48:08.094 | INFO     | tasks.generation_task:generate_personalized_image:256 - Step 6: Sending completion callback
2025-10-16 11:48:38.887 | ERROR    | app.utils.helpers:send_callback_to_laravel:73 - Failed to send callback to http://localhost:8000/api/internal/generations/0199eb17-0895-710b-8e23-93ed73abe949/complete: 
2025-10-16 11:48:38.897 | WARNING  | tasks.generation_task:generate_personalized_image:285 - Failed to send completion callback
2025-10-16 13:20:05.449 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-16 13:20:53.088 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199ebad-8511-727e-8591-891348882418
2025-10-16 13:20:53.092 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-16 13:20:53.292 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-16 13:20:57.804 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-16 13:21:03.271 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-16 13:21:04.230 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-16 13:21:04.232 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-16 13:21:04.232 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-16 13:21:04.233 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-16 13:21:04.233 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-16 13:21:04.235 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-16 13:21:04.760 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-16 13:21:04.760 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-16 13:21:04.760 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-16 13:21:07.871 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-16 13:21:07.871 | INFO     | tasks.generation_task:generate_personalized_image:147 - 📋 Template Config:
2025-10-16 13:21:07.873 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has base_prompt: False
2025-10-16 13:21:07.874 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Has negative_prompt: False
2025-10-16 13:21:07.876 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Min size: 768x1024
2025-10-16 13:21:07.876 | INFO     | tasks.generation_task:generate_personalized_image:151 -    - Guidance: 7.5, Steps: 30
2025-10-16 13:21:07.876 | INFO     | tasks.generation_task:generate_personalized_image:180 - Original size: 570x600
2025-10-16 13:21:07.876 | INFO     | tasks.generation_task:generate_personalized_image:181 - Generation size (scaled up): 968x1024
2025-10-16 13:21:07.876 | INFO     | app.utils.helpers:create_pose_prompt:160 - 🔧 Using AUTO-GENERATED prompt with isolation
2025-10-16 13:21:07.876 | INFO     | app.utils.helpers:create_pose_prompt:231 - Generated isolated person prompt: single person only, isolated on plain white background, no background elements, studio portrait, adult handsome Indonesian man, masculine features, sitting upright on a chair with good posture, formal...
2025-10-16 13:21:07.876 | INFO     | app.utils.helpers:create_negative_prompt:256 - 🔧 Using AUTO-GENERATED negative prompt
2025-10-16 13:21:07.882 | INFO     | app.services.ai_generator:generate_person:124 - 🎨 Generating male person: sitting, size: 968x1024
2025-10-16 14:26:58.657 | ERROR    | app.services.ai_generator:generate_person:151 - ❌ Failed to generate person: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-16 14:26:58.673 | ERROR    | tasks.generation_task:generate_personalized_image:304 - ❌ Generation failed for 0199ebad-8511-727e-8591-891348882418: Failed to generate person image
2025-10-16 14:28:53.786 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-16 14:29:09.499 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199ebad-8511-727e-8591-891348882418
2025-10-16 14:29:09.509 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-16 14:29:09.598 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-16 14:29:13.664 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-16 14:29:19.349 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-16 14:29:20.268 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-16 14:29:20.272 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-16 14:29:20.275 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-16 14:29:20.278 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-16 14:29:20.279 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-16 14:29:20.283 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-16 14:29:20.336 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-16 14:29:20.375 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-16 14:29:20.439 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-16 14:29:21.906 | ERROR    | app.services.ai_generator:load_model:69 - Failed to load Stable Diffusion model: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-16 14:29:21.907 | ERROR    | tasks.generation_task:generate_personalized_image:304 - ❌ Generation failed for 0199ebad-8511-727e-8591-891348882418: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-16 14:29:22.115 | ERROR    | app.utils.helpers:send_callback_to_laravel:73 - Failed to send callback to http://localhost:8000/api/internal/generations/0199ebad-8511-727e-8591-891348882418/failed: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-16 14:29:22.179 | ERROR    | tasks.generation_task:on_failure:47 - Task eb5a1c37-466b-434c-9d39-c8bbb908b44d failed: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-16 14:30:14.334 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-16 14:30:29.559 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199ebad-8511-727e-8591-891348882418
2025-10-16 14:30:29.561 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-16 14:30:29.625 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-16 14:30:32.574 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-16 14:30:36.798 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-16 14:30:37.836 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-16 14:30:37.838 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-16 14:30:37.839 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-16 14:30:37.840 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-16 14:30:37.840 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-16 14:30:37.844 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-16 14:30:45.553 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-16 14:30:45.555 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-16 14:30:45.556 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-16 14:30:48.366 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-16 14:30:48.367 | INFO     | tasks.generation_task:generate_personalized_image:147 - 📋 Template Config:
2025-10-16 14:30:48.368 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has base_prompt: False
2025-10-16 14:30:48.368 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Has negative_prompt: False
2025-10-16 14:30:48.369 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Min size: 768x1024
2025-10-16 14:30:48.369 | INFO     | tasks.generation_task:generate_personalized_image:151 -    - Guidance: 7.5, Steps: 30
2025-10-16 14:30:48.370 | INFO     | tasks.generation_task:generate_personalized_image:180 - Original size: 570x600
2025-10-16 14:30:48.370 | INFO     | tasks.generation_task:generate_personalized_image:181 - Generation size (scaled up): 968x1024
2025-10-16 14:30:48.371 | INFO     | app.utils.helpers:create_pose_prompt:160 - 🔧 Using AUTO-GENERATED prompt with isolation
2025-10-16 14:30:48.371 | INFO     | app.utils.helpers:create_pose_prompt:231 - Generated isolated person prompt: single person only, isolated on plain white background, no background elements, studio portrait, adult handsome Indonesian man, masculine features, sitting upright on a chair with good posture, formal...
2025-10-16 14:30:48.371 | INFO     | app.utils.helpers:create_negative_prompt:256 - 🔧 Using AUTO-GENERATED negative prompt
2025-10-16 14:30:48.372 | INFO     | app.services.ai_generator:generate_person:124 - 🎨 Generating male person: sitting, size: 968x1024
2025-10-16 14:44:57.479 | ERROR    | app.services.ai_generator:generate_person:151 - ❌ Failed to generate person: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-16 14:44:57.483 | ERROR    | tasks.generation_task:generate_personalized_image:304 - ❌ Generation failed for 0199ebad-8511-727e-8591-891348882418: Failed to generate person image
2025-10-16 14:44:57.687 | ERROR    | app.utils.helpers:send_callback_to_laravel:73 - Failed to send callback to http://localhost:8000/api/internal/generations/0199ebad-8511-727e-8591-891348882418/failed: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-16 14:44:57.706 | ERROR    | tasks.generation_task:on_failure:47 - Task eb5a1c37-466b-434c-9d39-c8bbb908b44d failed: Failed to generate person image
2025-10-16 14:45:31.126 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-16 14:45:46.278 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199ebad-8511-727e-8591-891348882418
2025-10-16 14:45:46.281 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-16 14:45:46.342 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-16 14:46:47.809 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-16 14:47:02.699 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199ebad-8511-727e-8591-891348882418
2025-10-16 14:47:02.700 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-16 14:47:02.737 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-16 14:47:05.334 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-16 14:47:09.117 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-16 14:47:09.955 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-16 14:47:09.957 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-16 14:47:09.957 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-16 14:47:09.958 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-16 14:47:09.958 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-16 14:47:09.960 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-16 14:47:09.981 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-16 14:47:09.984 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-16 14:47:09.987 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-16 14:47:12.229 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-16 14:47:12.229 | INFO     | tasks.generation_task:generate_personalized_image:147 - 📋 Template Config:
2025-10-16 14:47:12.230 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has base_prompt: False
2025-10-16 14:47:12.230 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Has negative_prompt: False
2025-10-16 14:47:12.231 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Min size: 768x1024
2025-10-16 14:47:12.231 | INFO     | tasks.generation_task:generate_personalized_image:151 -    - Guidance: 7.5, Steps: 30
2025-10-16 14:47:12.231 | INFO     | tasks.generation_task:generate_personalized_image:180 - Original size: 570x600
2025-10-16 14:47:12.231 | INFO     | tasks.generation_task:generate_personalized_image:181 - Generation size (scaled up): 968x1024
2025-10-16 14:47:12.232 | INFO     | app.utils.helpers:create_pose_prompt:160 - 🔧 Using AUTO-GENERATED prompt with isolation
2025-10-16 14:47:12.232 | INFO     | app.utils.helpers:create_pose_prompt:231 - Generated isolated person prompt: single person only, isolated on plain white background, no background elements, studio portrait, adult handsome Indonesian man, masculine features, sitting upright on a chair with good posture, formal...
2025-10-16 14:47:12.233 | INFO     | app.utils.helpers:create_negative_prompt:256 - 🔧 Using AUTO-GENERATED negative prompt
2025-10-16 14:47:12.233 | INFO     | app.services.ai_generator:generate_person:124 - 🎨 Generating male person: sitting, size: 968x1024
2025-10-16 14:47:14.746 | ERROR    | app.services.ai_generator:generate_person:151 - ❌ Failed to generate person: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-16 14:47:14.747 | ERROR    | tasks.generation_task:generate_personalized_image:304 - ❌ Generation failed for 0199ebad-8511-727e-8591-891348882418: Failed to generate person image
2025-10-16 14:47:15.651 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199ebad-8511-727e-8591-891348882418/failed
2025-10-16 14:47:15.665 | ERROR    | tasks.generation_task:on_failure:47 - Task eb5a1c37-466b-434c-9d39-c8bbb908b44d failed: Failed to generate person image
2025-10-16 14:47:16.320 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199ebad-8511-727e-8591-891348882418/failed
2025-10-16 14:47:43.491 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-16 14:47:58.390 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199ebed-8f5e-72b3-805c-8226cc49c765
2025-10-16 14:47:58.390 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-16 14:47:58.445 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-16 14:48:00.060 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-16 14:48:01.956 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-16 14:48:02.660 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-16 14:48:02.660 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-16 14:48:02.660 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-16 14:48:02.660 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-16 14:48:02.660 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-16 14:48:02.660 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-16 14:48:02.682 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-16 14:48:02.685 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-16 14:48:02.686 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-16 14:48:04.889 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-16 14:48:04.891 | INFO     | tasks.generation_task:generate_personalized_image:147 - 📋 Template Config:
2025-10-16 14:48:04.891 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has base_prompt: True
2025-10-16 14:48:04.892 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Has negative_prompt: True
2025-10-16 14:48:04.892 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Min size: 768x1024
2025-10-16 14:48:04.893 | INFO     | tasks.generation_task:generate_personalized_image:151 -    - Guidance: 7.5, Steps: 30
2025-10-16 14:48:04.893 | INFO     | tasks.generation_task:generate_personalized_image:180 - Original size: 570x600
2025-10-16 14:48:04.894 | INFO     | tasks.generation_task:generate_personalized_image:181 - Generation size (scaled up): 968x1024
2025-10-16 14:48:04.894 | INFO     | app.utils.helpers:create_pose_prompt:156 - 🎯 Using TEMPLATE prompt with isolation: professional full body photo of man person, sitting upright on chair with straight back, formal posture, hands on lap or armrests, wearing casual clothing, simple background, photorealistic, sharp foc...
2025-10-16 14:48:04.894 | INFO     | app.utils.helpers:create_negative_prompt:252 - 🎯 Using TEMPLATE negative prompt
2025-10-16 14:48:04.895 | INFO     | app.services.ai_generator:generate_person:124 - 🎨 Generating male person: sitting, size: 968x1024
2025-10-16 14:48:46.947 | ERROR    | app.services.ai_generator:generate_person:151 - ❌ Failed to generate person: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-16 14:48:46.948 | ERROR    | tasks.generation_task:generate_personalized_image:304 - ❌ Generation failed for 0199ebed-8f5e-72b3-805c-8226cc49c765: Failed to generate person image
2025-10-16 14:48:48.043 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199ebed-8f5e-72b3-805c-8226cc49c765/failed
2025-10-16 14:48:48.050 | ERROR    | tasks.generation_task:on_failure:47 - Task d54448e5-b411-4895-a55b-9d0671792a7b failed: Failed to generate person image
2025-10-16 14:48:48.798 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199ebed-8f5e-72b3-805c-8226cc49c765/failed
2025-10-16 14:49:20.001 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-16 14:50:29.622 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199ebff-9a44-7387-92e1-614630bd64a4
2025-10-16 14:50:29.622 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-16 14:50:29.680 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-16 14:50:31.300 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-16 14:50:33.796 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-16 14:50:34.388 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-16 14:50:34.389 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-16 14:50:34.389 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-16 14:50:34.390 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-16 14:50:34.390 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-16 14:50:34.391 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-16 14:50:34.432 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-16 14:50:34.434 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-16 14:50:34.435 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-16 14:50:36.635 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-16 14:50:36.635 | INFO     | tasks.generation_task:generate_personalized_image:147 - 📋 Template Config:
2025-10-16 14:50:36.636 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has base_prompt: True
2025-10-16 14:50:36.636 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Has negative_prompt: True
2025-10-16 14:50:36.636 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Min size: 768x1024
2025-10-16 14:50:36.637 | INFO     | tasks.generation_task:generate_personalized_image:151 -    - Guidance: 7.5, Steps: 30
2025-10-16 14:50:36.637 | INFO     | tasks.generation_task:generate_personalized_image:180 - Original size: 570x600
2025-10-16 14:50:36.638 | INFO     | tasks.generation_task:generate_personalized_image:181 - Generation size (scaled up): 968x1024
2025-10-16 14:50:36.638 | INFO     | app.utils.helpers:create_pose_prompt:156 - 🎯 Using TEMPLATE prompt with isolation: professional full body photo of man person, sitting upright on chair with straight back, formal posture, hands on lap or armrests, wearing casual clothing, simple background, photorealistic, sharp foc...
2025-10-16 14:50:36.638 | INFO     | app.utils.helpers:create_negative_prompt:252 - 🎯 Using TEMPLATE negative prompt
2025-10-16 14:50:36.639 | INFO     | app.services.ai_generator:generate_person:124 - 🎨 Generating male person: sitting, size: 968x1024
2025-10-16 14:51:49.304 | ERROR    | app.services.ai_generator:generate_person:151 - ❌ Failed to generate person: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-16 14:51:49.304 | ERROR    | tasks.generation_task:generate_personalized_image:304 - ❌ Generation failed for 0199ebff-9a44-7387-92e1-614630bd64a4: Failed to generate person image
2025-10-16 14:51:49.326 | ERROR    | app.utils.helpers:send_callback_to_laravel:73 - Failed to send callback to http://localhost:8000/api/internal/generations/0199ebff-9a44-7387-92e1-614630bd64a4/failed: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-16 14:51:49.339 | ERROR    | tasks.generation_task:on_failure:47 - Task 2e4a2398-0048-49ae-bea4-aef304dbb0f4 failed: Failed to generate person image
2025-10-16 14:54:25.678 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-16 14:55:43.579 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199ec04-64d9-7153-8bf6-eaf3c5e43fed
2025-10-16 14:55:43.580 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-16 14:55:43.641 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-16 14:55:45.613 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-16 14:55:49.047 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-16 14:55:49.667 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-16 14:55:49.682 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-16 14:55:49.682 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-16 14:55:49.682 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-16 14:55:49.684 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-16 14:55:49.684 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-16 14:55:49.706 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-16 14:55:49.709 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-16 14:55:49.710 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-16 14:55:51.782 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-16 14:55:51.782 | INFO     | tasks.generation_task:generate_personalized_image:147 - 📋 Template Config:
2025-10-16 14:55:51.783 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has base_prompt: True
2025-10-16 14:55:51.783 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Has negative_prompt: True
2025-10-16 14:55:51.784 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Min size: 512x512
2025-10-16 14:55:51.784 | INFO     | tasks.generation_task:generate_personalized_image:151 -    - Guidance: 7.5, Steps: 15
2025-10-16 14:55:51.785 | INFO     | tasks.generation_task:generate_personalized_image:180 - Original size: 570x600
2025-10-16 14:55:51.786 | INFO     | tasks.generation_task:generate_personalized_image:181 - Generation size (scaled up): 568x600
2025-10-16 14:55:51.786 | INFO     | app.utils.helpers:create_pose_prompt:156 - 🎯 Using TEMPLATE prompt with isolation: isolated man person, {pose} pose, wearing casual clothing, plain white background, no props, single subject, studio portrait, photorealistic, sharp focus, full body, plain white background, isolated s...
2025-10-16 14:55:51.787 | INFO     | app.utils.helpers:create_negative_prompt:252 - 🎯 Using TEMPLATE negative prompt
2025-10-16 14:55:51.788 | INFO     | app.services.ai_generator:generate_person:124 - 🎨 Generating male person: sitting, size: 568x600
2025-10-16 15:05:13.912 | INFO     | app.services.ai_generator:generate_person:146 - ✅ Male person generated successfully
2025-10-16 15:05:13.917 | INFO     | tasks.generation_task:generate_personalized_image:202 - ✅ Male person generated at 568x600
2025-10-16 15:05:13.918 | INFO     | tasks.generation_task:generate_personalized_image:203 - Step 2.5: Removing background from generated person
2025-10-16 15:05:49.926 | INFO     | tasks.generation_task:generate_personalized_image:206 - ✅ Background removed successfully
2025-10-16 15:05:49.935 | INFO     | tasks.generation_task:generate_personalized_image:213 - Step 3: Performing face swap
2025-10-16 15:05:49.935 | INFO     | app.services.face_swapper:swap_face:225 - Starting face swap process
2025-10-16 15:05:50.617 | INFO     | app.services.face_swapper:swap_face:249 - ✅ Source face detected at bbox: [ 149.97496  432.79843  725.81854 1191.7039 ]
2025-10-16 15:05:51.233 | INFO     | app.services.face_swapper:swap_face:264 - ✅ Target face detected at bbox: [183.84929  82.54145 287.20093 220.77345]
2025-10-16 15:05:54.850 | INFO     | app.services.face_swapper:swap_face:273 - ✅ Face swap completed successfully
2025-10-16 15:05:55.061 | INFO     | app.services.face_swapper:enhance_face:436 - Face enhanced successfully
2025-10-16 15:05:55.062 | INFO     | tasks.generation_task:generate_personalized_image:227 - ✅ Face swap completed successfully
2025-10-16 15:05:55.063 | INFO     | tasks.generation_task:generate_personalized_image:232 - Step 4: Compositing into design
2025-10-16 15:05:55.065 | INFO     | app.services.image_composer:composite_person_into_design:25 - Compositing person into design at x=21.0 y=0.0 width=570.0 height=600.0 type='rectangle'
2025-10-16 15:05:55.065 | INFO     | app.services.image_composer:composite_person_into_design:26 - Design size: (600, 600)
2025-10-16 15:05:55.066 | INFO     | app.services.image_composer:composite_person_into_design:27 - Person size (before resize): (568, 600)
2025-10-16 15:05:55.069 | INFO     | app.services.image_composer:composite_person_into_design:34 - Resizing person to: (570, 600)
2025-10-16 15:05:55.091 | INFO     | app.services.image_composer:composite_person_into_design:49 - Composition completed successfully
2025-10-16 15:05:55.092 | INFO     | tasks.generation_task:generate_personalized_image:245 - ✅ Composition completed successfully
2025-10-16 15:05:55.094 | INFO     | tasks.generation_task:generate_personalized_image:249 - Step 5: Saving result
2025-10-16 15:05:55.104 | INFO     | app.utils.helpers:save_image:29 - Image saved to ./output\0199ec04-64d9-7153-8bf6-eaf3c5e43fed.jpg
2025-10-16 15:05:55.106 | INFO     | tasks.generation_task:generate_personalized_image:260 - ✅ Generation completed in 611527ms
2025-10-16 15:05:55.106 | INFO     | tasks.generation_task:generate_personalized_image:263 - Step 6: Sending completion callback
2025-10-16 15:06:25.672 | ERROR    | app.utils.helpers:send_callback_to_laravel:73 - Failed to send callback to http://localhost:8000/api/internal/generations/0199ec04-64d9-7153-8bf6-eaf3c5e43fed/complete: 
2025-10-16 15:06:25.677 | WARNING  | tasks.generation_task:generate_personalized_image:292 - Failed to send completion callback
2025-10-16 15:49:30.461 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-16 15:56:39.841 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-16 15:57:33.825 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199ec3d-016f-71e8-89da-5727bb3218d6
2025-10-16 15:57:33.825 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-16 15:57:33.893 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-16 15:57:37.234 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-16 15:57:41.461 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-16 15:57:42.152 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-16 15:57:42.153 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-16 15:57:42.154 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-16 15:57:42.154 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-16 15:57:42.154 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-16 15:57:42.156 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-16 15:57:42.188 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-16 15:57:42.191 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-16 15:57:42.191 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-16 15:57:44.460 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-16 15:57:44.460 | INFO     | tasks.generation_task:generate_personalized_image:147 - 📋 Template Config:
2025-10-16 15:57:44.460 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has base_prompt: True
2025-10-16 15:57:44.460 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Has negative_prompt: True
2025-10-16 15:57:44.460 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Min size: 768x1024
2025-10-16 15:57:44.460 | INFO     | tasks.generation_task:generate_personalized_image:151 -    - Guidance: 7.5, Steps: 30
2025-10-16 15:57:44.460 | INFO     | tasks.generation_task:generate_personalized_image:180 - Original size: 570x600
2025-10-16 15:57:44.467 | INFO     | tasks.generation_task:generate_personalized_image:181 - Generation size (scaled up): 968x1024
2025-10-16 15:57:44.467 | INFO     | app.utils.helpers:create_pose_prompt:163 - 🎯 Using TEMPLATE prompt with isolation: full body photo of man person in sitting position, wearing casual clothing, hands resting naturally on lap or sides, feet flat on ground, plain light gray background, no furniture visible, no props, s...
2025-10-16 15:57:44.468 | INFO     | app.utils.helpers:create_negative_prompt:259 - 🎯 Using TEMPLATE negative prompt
2025-10-16 15:57:44.468 | INFO     | app.services.ai_generator:generate_person:124 - 🎨 Generating male person: sitting, size: 968x1024
2025-10-16 17:07:51.052 | INFO     | app.services.ai_generator:generate_person:146 - ✅ Male person generated successfully
2025-10-16 17:07:51.073 | INFO     | tasks.generation_task:generate_personalized_image:202 - ✅ Male person generated at 968x1024
2025-10-16 17:07:51.073 | INFO     | tasks.generation_task:generate_personalized_image:203 - Step 2.5: Removing background from generated person
2025-10-16 17:07:53.810 | INFO     | tasks.generation_task:generate_personalized_image:206 - ✅ Background removed successfully
2025-10-16 17:07:53.865 | INFO     | tasks.generation_task:generate_personalized_image:213 - Step 3: Performing face swap
2025-10-16 17:07:53.868 | INFO     | app.services.face_swapper:swap_face:225 - Starting face swap process
2025-10-16 17:07:55.138 | INFO     | app.services.face_swapper:swap_face:249 - ✅ Source face detected at bbox: [ 149.97496  432.79843  725.81854 1191.7039 ]
2025-10-16 17:07:55.810 | INFO     | app.services.face_swapper:swap_face:264 - ✅ Target face detected at bbox: [200.577     85.024475 338.09833  256.0861  ]
2025-10-16 17:07:59.954 | INFO     | app.services.face_swapper:swap_face:273 - ✅ Face swap completed successfully
2025-10-16 17:08:00.191 | INFO     | app.services.face_swapper:enhance_face:436 - Face enhanced successfully
2025-10-16 17:08:00.194 | INFO     | tasks.generation_task:generate_personalized_image:227 - ✅ Face swap completed successfully
2025-10-16 17:08:00.196 | INFO     | tasks.generation_task:generate_personalized_image:232 - Step 4: Compositing into design
2025-10-16 17:08:00.205 | INFO     | app.services.image_composer:composite_person_into_design:25 - Compositing person into design at x=21.0 y=0.0 width=570.0 height=600.0 type='rectangle'
2025-10-16 17:08:00.207 | INFO     | app.services.image_composer:composite_person_into_design:26 - Design size: (600, 600)
2025-10-16 17:08:00.207 | INFO     | app.services.image_composer:composite_person_into_design:27 - Person size (before resize): (968, 1024)
2025-10-16 17:08:00.215 | INFO     | app.services.image_composer:composite_person_into_design:34 - Resizing person to: (570, 600)
2025-10-16 17:08:00.255 | INFO     | app.services.image_composer:composite_person_into_design:49 - Composition completed successfully
2025-10-16 17:08:00.260 | INFO     | tasks.generation_task:generate_personalized_image:245 - ✅ Composition completed successfully
2025-10-16 17:08:00.262 | INFO     | tasks.generation_task:generate_personalized_image:249 - Step 5: Saving result
2025-10-16 17:08:00.281 | INFO     | app.utils.helpers:save_image:29 - Image saved to ./output\0199ec3d-016f-71e8-89da-5727bb3218d6.jpg
2025-10-16 17:08:00.282 | INFO     | tasks.generation_task:generate_personalized_image:260 - ✅ Generation completed in 4226456ms
2025-10-16 17:08:00.282 | INFO     | tasks.generation_task:generate_personalized_image:263 - Step 6: Sending completion callback
2025-10-16 17:08:30.979 | ERROR    | app.utils.helpers:send_callback_to_laravel:73 - Failed to send callback to http://localhost:8000/api/internal/generations/0199ec3d-016f-71e8-89da-5727bb3218d6/complete: 
2025-10-16 17:08:30.992 | WARNING  | tasks.generation_task:generate_personalized_image:292 - Failed to send completion callback
2025-10-17 09:23:48.616 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-17 09:29:49.537 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-17 09:32:00.680 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199f002-5b66-7257-b33f-0c951db5b1f9
2025-10-17 09:32:00.700 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-17 09:32:00.814 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-17 09:32:03.974 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-17 09:32:08.026 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-17 09:32:08.847 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-17 09:32:08.849 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-17 09:32:08.849 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-17 09:32:08.851 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-17 09:32:08.851 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-17 09:32:08.853 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-17 09:32:09.018 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-17 09:32:09.018 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-17 09:32:09.018 | INFO     | app.services.ai_generator:load_model:29 - Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-17 09:32:11.257 | INFO     | app.services.ai_generator:load_model:66 - Stable Diffusion model loaded successfully
2025-10-17 09:32:11.258 | INFO     | tasks.generation_task:generate_personalized_image:147 - 📋 Template Config:
2025-10-17 09:32:11.258 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has base_prompt: True
2025-10-17 09:32:11.258 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Has negative_prompt: True
2025-10-17 09:32:11.258 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Min size: 768x1024
2025-10-17 09:32:11.259 | INFO     | tasks.generation_task:generate_personalized_image:151 -    - Guidance: 7.0, Steps: 35
2025-10-17 09:32:11.259 | INFO     | tasks.generation_task:generate_personalized_image:180 - Original size: 570x600
2025-10-17 09:32:11.259 | INFO     | tasks.generation_task:generate_personalized_image:181 - Generation size (scaled up): 968x1024
2025-10-17 09:32:11.260 | INFO     | app.utils.helpers:create_pose_prompt:163 - 🎯 Using TEMPLATE prompt with isolation: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 09:32:11.261 | INFO     | app.utils.helpers:create_negative_prompt:259 - 🎯 Using TEMPLATE negative prompt
2025-10-17 09:32:11.261 | INFO     | app.services.ai_generator:generate_person:124 - 🎨 Generating male person: sitting, size: 968x1024
2025-10-17 09:51:20.074 | ERROR    | app.services.ai_generator:generate_person:151 - ❌ Failed to generate person: <class 'celery.concurrency.solo.TaskPool'> does not implement kill_job
2025-10-17 09:51:20.083 | ERROR    | tasks.generation_task:generate_personalized_image:316 - ❌ Generation failed for 0199f002-5b66-7257-b33f-0c951db5b1f9: Failed to generate person image
2025-10-17 09:51:21.133 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f002-5b66-7257-b33f-0c951db5b1f9/failed
2025-10-17 09:51:21.192 | ERROR    | tasks.generation_task:on_failure:47 - Task 933d93bf-396c-44cc-af64-e74127a77f98 failed: Failed to generate person image
2025-10-17 09:51:21.898 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f002-5b66-7257-b33f-0c951db5b1f9/failed
2025-10-17 09:56:41.435 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-17 09:58:12.541 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199f01a-5ca4-7080-bb69-7b7bf297bd9f
2025-10-17 09:58:12.541 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-17 09:58:12.609 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-17 09:58:14.760 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-17 09:58:18.287 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-17 09:58:19.013 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-17 09:58:19.014 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-17 09:58:19.014 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-17 09:58:19.014 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-17 09:58:19.015 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-17 09:58:19.017 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-17 09:58:19.043 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-17 09:58:19.046 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-17 09:58:19.131 | INFO     | app.services.ai_generator:get_device:21 - ✅ Using DirectML device (AMD GPU): privateuseone:0
2025-10-17 09:58:19.132 | INFO     | app.services.ai_generator:__init__:54 - 🎮 DirectML (AMD GPU) mode enabled
2025-10-17 09:58:19.132 | INFO     | app.services.ai_generator:load_model:65 - ⏳ Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-17 09:58:19.133 | INFO     | app.services.ai_generator:load_model:66 - 🖥️ Target device: privateuseone:0
2025-10-17 09:58:19.133 | INFO     | app.services.ai_generator:load_model:71 - Using FP16 precision for GPU
2025-10-17 09:58:30.621 | INFO     | app.services.ai_generator:load_model:91 - 📦 Moving model to privateuseone:0...
2025-10-17 09:58:34.979 | INFO     | app.services.ai_generator:load_model:96 - 🔧 Applying DirectML (AMD) optimizations...
2025-10-17 09:58:34.990 | INFO     | app.services.ai_generator:load_model:99 - ✅ DirectML optimizations applied
2025-10-17 09:58:34.991 | INFO     | app.services.ai_generator:load_model:131 - ✅ Stable Diffusion model loaded successfully!
2025-10-17 09:58:34.992 | INFO     | app.services.ai_generator:load_model:132 - 📊 Model info: {'model_id': 'runwayml/stable-diffusion-v1-5', 'device': 'DirectML (AMD)', 'device_raw': 'privateuseone:0', 'loaded': True, 'is_directml': True, 'xformers_enabled': False, 'cpu_offload_enabled': False}
2025-10-17 09:58:34.993 | INFO     | tasks.generation_task:generate_personalized_image:147 - 📋 Template Config:
2025-10-17 09:58:34.994 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has base_prompt: True
2025-10-17 09:58:34.994 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Has negative_prompt: True
2025-10-17 09:58:34.995 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Min size: 768x1024
2025-10-17 09:58:34.995 | INFO     | tasks.generation_task:generate_personalized_image:151 -    - Guidance: 7.0, Steps: 35
2025-10-17 09:58:34.995 | INFO     | tasks.generation_task:generate_personalized_image:180 - Original size: 570x600
2025-10-17 09:58:34.996 | INFO     | tasks.generation_task:generate_personalized_image:181 - Generation size (scaled up): 968x1024
2025-10-17 09:58:34.997 | INFO     | app.utils.helpers:create_pose_prompt:163 - 🎯 Using TEMPLATE prompt with isolation: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 09:58:34.997 | INFO     | app.utils.helpers:create_negative_prompt:259 - 🎯 Using TEMPLATE negative prompt
2025-10-17 09:58:34.997 | INFO     | app.services.ai_generator:generate_person:182 - 🎨 Generating male person: sitting, size: 968x1024
2025-10-17 09:58:34.998 | INFO     | app.services.ai_generator:generate_person:183 - ⚙️ Steps: 35, Guidance: 7.0
2025-10-17 09:58:34.999 | INFO     | app.services.ai_generator:generate_person:184 - 📝 Prompt: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 09:58:34.999 | INFO     | app.services.ai_generator:generate_person:185 - 🚫 Negative: extra limbs, duplicate arms, duplicate legs, multiple hands, multiple feet, third arm, third leg, fo...
2025-10-17 09:58:35.000 | INFO     | app.services.ai_generator:generate_person:196 - 🚀 Starting generation...
2025-10-17 09:58:35.036 | ERROR    | app.services.ai_generator:generate_person:220 - ❌ Failed to generate person: Cannot set version_counter for inference tensor
2025-10-17 09:58:35.036 | ERROR    | app.services.ai_generator:generate_person:221 - Cannot set version_counter for inference tensor
Traceback (most recent call last):

  File "C:\laragon\www\interactive-signage\digital-signage-ai\celery_worker.py", line 49, in <module>
    celery_app.worker_main([
    │          └ <function Celery.worker_main at 0x000002595D3DB0A0>
    └ <Celery digital_signage_tasks at 0x2595c9e5cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\base.py", line 470, in worker_main
    self.start(argv=argv)
    │    │          └ ['worker', '--loglevel=info', '--concurrency=1', '--pool=solo', '--task-events', '--without-gossip', '--without-mingle']
    │    └ <function Celery.start at 0x000002595D3DB010>
    └ <Celery digital_signage_tasks at 0x2595c9e5cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\base.py", line 450, in start
    celery.main(args=argv, standalone_mode=False)
    │      │         └ ['worker', '--loglevel=info', '--concurrency=1', '--pool=solo', '--task-events', '--without-gossip', '--without-mingle']
    │      └ <function Command.main at 0x000002595D2D89D0>
    └ <DYMGroup celery>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1383, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x0000025911BC6770>
         │    └ <function Group.invoke at 0x000002595D2D9360>
         └ <DYMGroup celery>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1850, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x000002591202F4C0>
           │               │       │       └ <function Command.invoke at 0x000002595D2D88B0>
           │               │       └ <CeleryDaemonCommand worker>
           │               └ <click.core.Context object at 0x000002591202F4C0>
           └ <function Group.invoke.<locals>._process_result at 0x0000025912040940>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1246, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │   │      │    │           └ <click.core.Context object at 0x000002591202F4C0>
           │   │      │    └ <function worker at 0x00000259120416C0>
           │   │      └ <CeleryDaemonCommand worker>
           │   └ <function Context.invoke at 0x000002595D2C3BE0>
           └ <click.core.Context object at 0x000002591202F4C0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 814, in invoke
    return callback(*args, **kwargs)
           │         │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │         └ ()
           └ <function worker at 0x00000259120416C0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\decorators.py", line 34, in new_func
    return f(get_current_context(), *args, **kwargs)
           │ │                       │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │ │                       └ ()
           │ └ <function get_current_context at 0x000002595D27B910>
           └ <function worker at 0x0000025912041630>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bin\base.py", line 135, in caller
    return f(ctx, *args, **kwargs)
           │ │     │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │ │     └ ()
           │ └ <click.core.Context object at 0x000002591202F4C0>
           └ <function worker at 0x00000259120415A0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bin\worker.py", line 356, in worker
    worker.start()
    │      └ <function WorkController.start at 0x0000025911F94F70>
    └ <Worker: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\worker.py", line 203, in start
    self.blueprint.start(self)
    │    │         │     └ <Worker: celery@soulmate-plus (running)>
    │    │         └ <function Blueprint.start at 0x0000025911F69510>
    │    └ <celery.worker.worker.WorkController.Blueprint object at 0x00000259122E2440>
    └ <Worker: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
    │    │     └ <Worker: celery@soulmate-plus (running)>
    │    └ <function StartStopStep.start at 0x0000025911F6A5F0>
    └ <step: Consumer>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 365, in start
    return self.obj.start()
           │    │   └ <function Consumer.start at 0x0000025912329630>
           │    └ <Consumer: celery@soulmate-plus (running)>
           └ <step: Consumer>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 341, in start
    blueprint.start(self)
    │         │     └ <Consumer: celery@soulmate-plus (running)>
    │         └ <function Blueprint.start at 0x0000025911F69510>
    └ <celery.worker.consumer.consumer.Consumer.Blueprint object at 0x00000259122E3670>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
    │    │     └ <Consumer: celery@soulmate-plus (running)>
    │    └ <function Evloop.start at 0x000002591232A7A0>
    └ <step: event loop>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 772, in start
    c.loop(*c.loop_args())
    │ │     │ └ <function Consumer.loop_args at 0x0000025912329AB0>
    │ │     └ <Consumer: celery@soulmate-plus (running)>
    │ └ <function synloop at 0x0000025912328E50>
    └ <Consumer: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\loops.py", line 143, in synloop
    _loop_cycle()
    └ <function synloop.<locals>._loop_cycle at 0x0000025912405480>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\loops.py", line 132, in _loop_cycle
    connection.drain_events(timeout=2.0)
    │          └ <function Connection.drain_events at 0x000002595D112440>
    └ <Connection: redis://localhost:6379/0 at 0x259123a6ce0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\connection.py", line 341, in drain_events
    return self.transport.drain_events(self.connection, **kwargs)
           │    │                      │    │             └ {'timeout': 2.0}
           │    │                      │    └ <property object at 0x000002595D122430>
           │    │                      └ <Connection: redis://localhost:6379/0 at 0x259123a6ce0>
           │    └ <property object at 0x000002595D122520>
           └ <Connection: redis://localhost:6379/0 at 0x259123a6ce0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 997, in drain_events
    get(self._deliver, timeout=timeout)
    │   │    │                 └ 2.0
    │   │    └ <function Transport._deliver at 0x00000259120EFB50>
    │   └ <kombu.transport.redis.Transport object at 0x00000259123A6E00>
    └ <bound method MultiChannelPoller.get of <kombu.transport.redis.MultiChannelPoller object at 0x00000259123A6EF0>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 598, in get
    ret = self.handle_event(fileno, event)
          │    │            │       └ 1
          │    │            └ 4472
          │    └ <function MultiChannelPoller.handle_event at 0x00000259122EFEB0>
          └ <kombu.transport.redis.MultiChannelPoller object at 0x00000259123A6EF0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 580, in handle_event
    return self.on_readable(fileno), self
           │    │           │        └ <kombu.transport.redis.MultiChannelPoller object at 0x00000259123A6EF0>
           │    │           └ 4472
           │    └ <function MultiChannelPoller.on_readable at 0x00000259122EFE20>
           └ <kombu.transport.redis.MultiChannelPoller object at 0x00000259123A6EF0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 576, in on_readable
    chan.handlers[type]()
    │    │        └ 'BRPOP'
    │    └ {'BRPOP': <bound method Channel._brpop_read of <kombu.transport.redis.Channel object at 0x00000259123A6E90>>, 'LISTEN': <boun...
    └ <kombu.transport.redis.Channel object at 0x00000259123A6E90>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 986, in _brpop_read
    self.connection._deliver(loads(bytes_to_str(item)), dest)
    │    │          │        │     │            │       └ 'celery'
    │    │          │        │     │            └ b'{"body": "W1tdLCB7ImdlbmVyYXRpb25faWQiOiAiMDE5OWYwMWEtNWNhNC03MDgwLWJiNjktN2I3YmYyOTdiZDlmIiwgImZhY2VfaW1hZ2VfcGF0aCI6ICIuL...
    │    │          │        │     └ <function bytes_to_str at 0x000002595D0B1B40>
    │    │          │        └ <function loads at 0x000002595D1327A0>
    │    │          └ <function Transport._deliver at 0x00000259120EFB50>
    │    └ <kombu.transport.redis.Transport object at 0x00000259123A6E00>
    └ <kombu.transport.redis.Channel object at 0x00000259123A6E90>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 1017, in _deliver
    callback(message)
    │        └ {'body': 'W1tdLCB7ImdlbmVyYXRpb25faWQiOiAiMDE5OWYwMWEtNWNhNC03MDgwLWJiNjktN2I3YmYyOTdiZDlmIiwgImZhY2VfaW1hZ2VfcGF0aCI6ICIuL3R...
    └ <function Channel.basic_consume.<locals>._callback at 0x00000259124053F0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 639, in _callback
    return callback(message)
           │        └ <Message object at 0x259124055a0 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '0d86...
           └ <bound method Consumer._receive_callback of <Consumer: [<Queue celery -> <Exchange celery(direct) bound to chan:1> -> celery ...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\messaging.py", line 668, in _receive_callback
    return on_m(message) if on_m else self.receive(decoded, message)
           │    │           │         │    │       │        └ <Message object at 0x259124055a0 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '0d86...
           │    │           │         │    │       └ None
           │    │           │         │    └ <function Consumer.receive at 0x000002595D355C60>
           │    │           │         └ <Consumer: [<Queue celery -> <Exchange celery(direct) bound to chan:1> -> celery bound to chan:1>]>
           │    │           └ <function Consumer.create_task_handler.<locals>.on_task_received at 0x0000025912405360>
           │    └ <Message object at 0x259124055a0 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '0d86...
           └ <function Consumer.create_task_handler.<locals>.on_task_received at 0x0000025912405360>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 688, in on_task_received
    strategy(
    └ <function default.<locals>.task_message_handler at 0x00000259123C30A0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\strategy.py", line 207, in task_message_handler
    handle(req)
    │      └ <Request: tasks.generate_personalized_image[2b4acb01-b13a-44a0-953a-fe54248959dc] () {'generation_id': '0199f01a-5ca4-7080-bb...
    └ <bound method WorkController._process_task of <Worker: celery@soulmate-plus (running)>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\worker.py", line 226, in _process_task
    req.execute_using_pool(self.pool)
    │   │                  │    └ <celery.concurrency.solo.TaskPool object at 0x00000259122E3910>
    │   │                  └ <Worker: celery@soulmate-plus (running)>
    │   └ <function create_request_cls.<locals>.Request.execute_using_pool at 0x00000259123C2B00>
    └ <Request: tasks.generate_personalized_image[2b4acb01-b13a-44a0-953a-fe54248959dc] () {'generation_id': '0199f01a-5ca4-7080-bb...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\request.py", line 754, in execute_using_pool
    result = apply_async(
             └ <bound method BasePool.apply_async of <celery.concurrency.solo.TaskPool object at 0x00000259122E3910>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\concurrency\base.py", line 153, in apply_async
    return self.on_apply(target, args, kwargs,
           │    │        │       │     └ {}
           │    │        │       └ ('tasks.generate_personalized_image', '2b4acb01-b13a-44a0-953a-fe54248959dc', {'lang': 'py', 'task': 'tasks.generate_personal...
           │    │        └ <function fast_trace_task at 0x0000025911FCCF70>
           │    └ <function apply_target at 0x0000025911FCD240>
           └ <celery.concurrency.solo.TaskPool object at 0x00000259122E3910>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\concurrency\base.py", line 30, in apply_target
    ret = target(*args, **kwargs)
          │       │       └ {}
          │       └ ('tasks.generate_personalized_image', '2b4acb01-b13a-44a0-953a-fe54248959dc', {'lang': 'py', 'task': 'tasks.generate_personal...
          └ <function fast_trace_task at 0x0000025911FCCF70>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 651, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
                    │     └ 'tasks.generate_personalized_image'
                    └ {'celery.chunks': <@task: celery.chunks of digital_signage_tasks at 0x2595c9e5cc0>, 'celery.chord_unlock': <@task: celery.cho...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 453, in trace_task
    R = retval = fun(*args, **kwargs)
                 │    │       └ {'generation_id': '0199f01a-5ca4-7080-bb69-7b7bf297bd9f', 'face_image_path': './temp\\0199f01a-5ca4-7080-bb69-7b7bf297bd9f_fa...
                 │    └ []
                 └ <@task: tasks.generate_personalized_image of digital_signage_tasks at 0x2595c9e5cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 736, in __protected_call__
    return self.run(*args, **kwargs)
           │    │    │       └ {'generation_id': '0199f01a-5ca4-7080-bb69-7b7bf297bd9f', 'face_image_path': './temp\\0199f01a-5ca4-7080-bb69-7b7bf297bd9f_fa...
           │    │    └ ()
           │    └ <function generate_personalized_image at 0x0000025911BB7BE0>
           └ <@task: tasks.generate_personalized_image of digital_signage_tasks at 0x2595c9e5cc0>

  File "C:\laragon\www\interactive-signage\digital-signage-ai\tasks\generation_task.py", line 184, in generate_personalized_image
    person_image = generator.generate_person(
                   │         └ <function AIGenerator.generate_person at 0x000002590B8EF6D0>
                   └ <app.services.ai_generator.AIGenerator object at 0x0000025912419690>

> File "C:\laragon\www\interactive-signage\digital-signage-ai\app\services\ai_generator.py", line 201, in generate_person
    result = self.pipe(
             │    └ StableDiffusionPipeline {
             │        "_class_name": "StableDiffusionPipeline",
             │        "_diffusers_version": "0.31.0",
             │        "_name_or_path": "r...
             └ <app.services.ai_generator.AIGenerator object at 0x0000025912419690>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           │     │       └ {'prompt': 'professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothi...
           │     └ (StableDiffusionPipeline {
           │         "_class_name": "StableDiffusionPipeline",
           │         "_diffusers_version": "0.31.0",
           │         "_name_or_path": "...
           └ <function StableDiffusionPipeline.__call__ at 0x000002590B8EF520>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\pipelines\stable_diffusion\pipeline_stable_diffusion.py", line 944, in __call__
    prompt_embeds, negative_prompt_embeds = self.encode_prompt(
    │                                       │    └ <function StableDiffusionPipeline.encode_prompt at 0x000002590B8EEB90>
    │                                       └ StableDiffusionPipeline {
    │                                           "_class_name": "StableDiffusionPipeline",
    │                                           "_diffusers_version": "0.31.0",
    │                                           "_name_or_path": "r...
    └ None

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\pipelines\stable_diffusion\pipeline_stable_diffusion.py", line 413, in encode_prompt
    prompt_embeds = self.text_encoder(text_input_ids.to(device), attention_mask=attention_mask)
                    │    │            │              │  │                       └ None
                    │    │            │              │  └ device(type='privateuseone', index=0)
                    │    │            │              └ <method 'to' of 'torch._C.TensorBase' objects>
                    │    │            └ tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
                    │    │                        4129,  1449,  4269,   267,  4919,  4...
                    │    └ CLIPTextModel(
                    │        (text_model): CLIPTextTransformer(
                    │          (embeddings): CLIPTextEmbeddings(
                    │            (token_embedding): Embedding(...
                    └ StableDiffusionPipeline {
                        "_class_name": "StableDiffusionPipeline",
                        "_diffusers_version": "0.31.0",
                        "_name_or_path": "r...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'attention_mask': None}
           │    │           └ (tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │    │                       4129,  1449,  4269,   267,  4919,  ...
           │    └ <function Module._call_impl at 0x00000259036A31C0>
           └ CLIPTextModel(
               (text_model): CLIPTextTransformer(
                 (embeddings): CLIPTextEmbeddings(
                   (token_embedding): Embedding(...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'attention_mask': None}
           │             └ (tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │                         4129,  1449,  4269,   267,  4919,  ...
           └ <bound method CLIPTextModel.forward of CLIPTextModel(
               (text_model): CLIPTextTransformer(
                 (embeddings): CLIPTextEmbeddin...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\transformers\models\clip\modeling_clip.py", line 986, in forward
    return self.text_model(
           └ CLIPTextModel(
               (text_model): CLIPTextTransformer(
                 (embeddings): CLIPTextEmbeddings(
                   (token_embedding): Embedding(...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'input_ids': tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │    │           │                   4129,  1449,  4269,   ...
           │    │           └ ()
           │    └ <function Module._call_impl at 0x00000259036A31C0>
           └ CLIPTextTransformer(
               (embeddings): CLIPTextEmbeddings(
                 (token_embedding): Embedding(49408, 768)
                 (position_embedding...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'input_ids': tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │             │                   4129,  1449,  4269,   ...
           │             └ ()
           └ <bound method CLIPTextTransformer.forward of CLIPTextTransformer(
               (embeddings): CLIPTextEmbeddings(
                 (token_embedding): ...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\transformers\models\clip\modeling_clip.py", line 877, in forward
    hidden_states = self.embeddings(input_ids=input_ids, position_ids=position_ids)
                    │                         │                       └ None
                    │                         └ tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
                    │                                     4129,  1449,  4269,   267,  4919,  4...
                    └ CLIPTextTransformer(
                        (embeddings): CLIPTextEmbeddings(
                          (token_embedding): Embedding(49408, 768)
                          (position_embedding...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'input_ids': tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │    │           │                   4129,  1449,  4269,   ...
           │    │           └ ()
           │    └ <function Module._call_impl at 0x00000259036A31C0>
           └ CLIPTextEmbeddings(
               (token_embedding): Embedding(49408, 768)
               (position_embedding): Embedding(77, 768)
             )

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'input_ids': tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │             │                   4129,  1449,  4269,   ...
           │             └ ()
           └ <bound method CLIPTextEmbeddings.forward of CLIPTextEmbeddings(
               (token_embedding): Embedding(49408, 768)
               (position_embedd...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\transformers\models\clip\modeling_clip.py", line 222, in forward
    position_ids = self.position_ids[:, :seq_length]
                   │                     └ 77
                   └ CLIPTextEmbeddings(
                       (token_embedding): Embedding(49408, 768)
                       (position_embedding): Embedding(77, 768)
                     )

RuntimeError: Cannot set version_counter for inference tensor
2025-10-17 09:58:36.090 | ERROR    | tasks.generation_task:generate_personalized_image:316 - ❌ Generation failed for 0199f01a-5ca4-7080-bb69-7b7bf297bd9f: Failed to generate person image
2025-10-17 09:58:37.013 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f01a-5ca4-7080-bb69-7b7bf297bd9f/failed
2025-10-17 09:58:37.021 | ERROR    | tasks.generation_task:on_failure:47 - Task 2b4acb01-b13a-44a0-953a-fe54248959dc failed: Failed to generate person image
2025-10-17 09:58:37.633 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f01a-5ca4-7080-bb69-7b7bf297bd9f/failed
2025-10-17 10:13:22.414 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-17 10:13:57.730 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199f028-c92c-7210-87bf-8d46a4d24268
2025-10-17 10:13:57.730 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-17 10:13:57.789 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-17 10:14:01.406 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-17 10:14:05.518 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-17 10:14:06.382 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-17 10:14:06.383 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-17 10:14:06.384 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-17 10:14:06.384 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-17 10:14:06.385 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-17 10:14:06.387 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-17 10:14:06.409 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-17 10:14:06.412 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-17 10:14:06.490 | INFO     | app.services.ai_generator:get_device:21 - ✅ Using DirectML device (AMD GPU): privateuseone:0
2025-10-17 10:14:06.490 | INFO     | app.services.ai_generator:__init__:54 - 🎮 DirectML (AMD GPU) mode enabled
2025-10-17 10:14:06.491 | INFO     | app.services.ai_generator:load_model:65 - ⏳ Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-17 10:14:06.491 | INFO     | app.services.ai_generator:load_model:66 - 🖥️ Target device: privateuseone:0
2025-10-17 10:14:06.491 | INFO     | app.services.ai_generator:load_model:71 - Using FP16 precision for GPU
2025-10-17 10:19:06.848 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-17 10:19:39.314 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199f02e-0009-72b9-b733-64adccc13fe0
2025-10-17 10:19:39.314 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-17 10:19:39.372 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-17 10:19:41.606 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-17 10:19:44.704 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-17 10:19:45.418 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-17 10:19:45.419 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-17 10:19:45.420 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-17 10:19:45.420 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-17 10:19:45.420 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-17 10:19:45.422 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-17 10:19:45.464 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-17 10:19:45.466 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-17 10:19:45.556 | INFO     | app.services.ai_generator:get_device:21 - ✅ Using DirectML device (AMD GPU): privateuseone:0
2025-10-17 10:19:45.557 | INFO     | app.services.ai_generator:__init__:54 - 🎮 DirectML (AMD GPU) mode enabled
2025-10-17 10:19:45.557 | INFO     | app.services.ai_generator:load_model:65 - ⏳ Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-17 10:19:45.557 | INFO     | app.services.ai_generator:load_model:66 - 🖥️ Target device: privateuseone:0
2025-10-17 10:19:45.558 | INFO     | app.services.ai_generator:load_model:71 - Using FP16 precision for GPU
2025-10-17 10:19:57.310 | INFO     | app.services.ai_generator:load_model:91 - 📦 Moving model to privateuseone:0...
2025-10-17 10:20:01.287 | INFO     | app.services.ai_generator:load_model:96 - 🔧 Applying DirectML (AMD) optimizations...
2025-10-17 10:20:01.298 | INFO     | app.services.ai_generator:load_model:99 - ✅ DirectML optimizations applied
2025-10-17 10:20:01.298 | INFO     | app.services.ai_generator:load_model:131 - ✅ Stable Diffusion model loaded successfully!
2025-10-17 10:20:01.300 | INFO     | app.services.ai_generator:load_model:132 - 📊 Model info: {'model_id': 'runwayml/stable-diffusion-v1-5', 'device': 'DirectML (AMD)', 'device_raw': 'privateuseone:0', 'loaded': True, 'is_directml': True, 'xformers_enabled': False, 'cpu_offload_enabled': False}
2025-10-17 10:20:01.301 | INFO     | tasks.generation_task:generate_personalized_image:147 - 📋 Template Config:
2025-10-17 10:20:01.302 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has base_prompt: True
2025-10-17 10:20:01.303 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Has negative_prompt: True
2025-10-17 10:20:01.303 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Min size: 768x1024
2025-10-17 10:20:01.303 | INFO     | tasks.generation_task:generate_personalized_image:151 -    - Guidance: 7.0, Steps: 35
2025-10-17 10:20:01.304 | INFO     | tasks.generation_task:generate_personalized_image:180 - Original size: 570x600
2025-10-17 10:20:01.305 | INFO     | tasks.generation_task:generate_personalized_image:181 - Generation size (scaled up): 968x1024
2025-10-17 10:20:01.309 | INFO     | app.utils.helpers:create_pose_prompt:163 - 🎯 Using TEMPLATE prompt with isolation: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 10:20:01.310 | INFO     | app.utils.helpers:create_negative_prompt:259 - 🎯 Using TEMPLATE negative prompt
2025-10-17 10:20:01.313 | INFO     | app.services.ai_generator:generate_person:182 - 🎨 Generating male person: sitting, size: 968x1024
2025-10-17 10:20:01.314 | INFO     | app.services.ai_generator:generate_person:183 - ⚙️ Steps: 35, Guidance: 7.0
2025-10-17 10:20:01.315 | INFO     | app.services.ai_generator:generate_person:184 - 📝 Prompt: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 10:20:01.315 | INFO     | app.services.ai_generator:generate_person:185 - 🚫 Negative: extra limbs, duplicate arms, duplicate legs, multiple hands, multiple feet, third arm, third leg, fo...
2025-10-17 10:20:01.316 | INFO     | app.services.ai_generator:generate_person:196 - 🚀 Starting generation...
2025-10-17 10:20:01.348 | ERROR    | app.services.ai_generator:generate_person:220 - ❌ Failed to generate person: Cannot set version_counter for inference tensor
2025-10-17 10:20:01.349 | ERROR    | app.services.ai_generator:generate_person:221 - Cannot set version_counter for inference tensor
Traceback (most recent call last):

  File "C:\laragon\www\interactive-signage\digital-signage-ai\celery_worker.py", line 49, in <module>
    celery_app.worker_main([
    │          └ <function Celery.worker_main at 0x0000026F64D9B0A0>
    └ <Celery digital_signage_tasks at 0x26f643a5cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\base.py", line 470, in worker_main
    self.start(argv=argv)
    │    │          └ ['worker', '--loglevel=info', '--concurrency=1', '--pool=solo', '--task-events', '--without-gossip', '--without-mingle']
    │    └ <function Celery.start at 0x0000026F64D9B010>
    └ <Celery digital_signage_tasks at 0x26f643a5cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\base.py", line 450, in start
    celery.main(args=argv, standalone_mode=False)
    │      │         └ ['worker', '--loglevel=info', '--concurrency=1', '--pool=solo', '--task-events', '--without-gossip', '--without-mingle']
    │      └ <function Command.main at 0x0000026F64C989D0>
    └ <DYMGroup celery>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1383, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x0000026F17A688E0>
         │    └ <function Group.invoke at 0x0000026F64C99360>
         └ <DYMGroup celery>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1850, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x0000026F17EBE6B0>
           │               │       │       └ <function Command.invoke at 0x0000026F64C988B0>
           │               │       └ <CeleryDaemonCommand worker>
           │               └ <click.core.Context object at 0x0000026F17EBE6B0>
           └ <function Group.invoke.<locals>._process_result at 0x0000026F17EB9990>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1246, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │   │      │    │           └ <click.core.Context object at 0x0000026F17EBE6B0>
           │   │      │    └ <function worker at 0x0000026F17EBA710>
           │   │      └ <CeleryDaemonCommand worker>
           │   └ <function Context.invoke at 0x0000026F64C83BE0>
           └ <click.core.Context object at 0x0000026F17EBE6B0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 814, in invoke
    return callback(*args, **kwargs)
           │         │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │         └ ()
           └ <function worker at 0x0000026F17EBA710>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\decorators.py", line 34, in new_func
    return f(get_current_context(), *args, **kwargs)
           │ │                       │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │ │                       └ ()
           │ └ <function get_current_context at 0x0000026F64C3B910>
           └ <function worker at 0x0000026F17EBA680>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bin\base.py", line 135, in caller
    return f(ctx, *args, **kwargs)
           │ │     │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │ │     └ ()
           │ └ <click.core.Context object at 0x0000026F17EBE6B0>
           └ <function worker at 0x0000026F17EBA5F0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bin\worker.py", line 356, in worker
    worker.start()
    │      └ <function WorkController.start at 0x0000026F17E220E0>
    └ <Worker: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\worker.py", line 203, in start
    self.blueprint.start(self)
    │    │         │     └ <Worker: celery@soulmate-plus (running)>
    │    │         └ <function Blueprint.start at 0x0000026F17DE6680>
    │    └ <celery.worker.worker.WorkController.Blueprint object at 0x0000026F181844F0>
    └ <Worker: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
    │    │     └ <Worker: celery@soulmate-plus (running)>
    │    └ <function StartStopStep.start at 0x0000026F17DE7760>
    └ <step: Consumer>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 365, in start
    return self.obj.start()
           │    │   └ <function Consumer.start at 0x0000026F1819E950>
           │    └ <Consumer: celery@soulmate-plus (running)>
           └ <step: Consumer>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 341, in start
    blueprint.start(self)
    │         │     └ <Consumer: celery@soulmate-plus (running)>
    │         └ <function Blueprint.start at 0x0000026F17DE6680>
    └ <celery.worker.consumer.consumer.Consumer.Blueprint object at 0x0000026F18168550>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
    │    │     └ <Consumer: celery@soulmate-plus (running)>
    │    └ <function Evloop.start at 0x0000026F1815E200>
    └ <step: event loop>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 772, in start
    c.loop(*c.loop_args())
    │ │     │ └ <function Consumer.loop_args at 0x0000026F1819EDD0>
    │ │     └ <Consumer: celery@soulmate-plus (running)>
    │ └ <function synloop at 0x0000026F1819E0E0>
    └ <Consumer: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\loops.py", line 143, in synloop
    _loop_cycle()
    └ <function synloop.<locals>._loop_cycle at 0x0000026F1826E710>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\loops.py", line 132, in _loop_cycle
    connection.drain_events(timeout=2.0)
    │          └ <function Connection.drain_events at 0x0000026F64AD2440>
    └ <Connection: redis://localhost:6379/0 at 0x26f18234910>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\connection.py", line 341, in drain_events
    return self.transport.drain_events(self.connection, **kwargs)
           │    │                      │    │             └ {'timeout': 2.0}
           │    │                      │    └ <property object at 0x0000026F64AE2390>
           │    │                      └ <Connection: redis://localhost:6379/0 at 0x26f18234910>
           │    └ <property object at 0x0000026F64AE2480>
           └ <Connection: redis://localhost:6379/0 at 0x26f18234910>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 997, in drain_events
    get(self._deliver, timeout=timeout)
    │   │    │                 └ 2.0
    │   │    └ <function Transport._deliver at 0x0000026F17F78D30>
    │   └ <kombu.transport.redis.Transport object at 0x0000026F18234A30>
    └ <bound method MultiChannelPoller.get of <kombu.transport.redis.MultiChannelPoller object at 0x0000026F18234B20>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 598, in get
    ret = self.handle_event(fileno, event)
          │    │            │       └ 1
          │    │            └ 3616
          │    └ <function MultiChannelPoller.handle_event at 0x0000026F181811B0>
          └ <kombu.transport.redis.MultiChannelPoller object at 0x0000026F18234B20>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 580, in handle_event
    return self.on_readable(fileno), self
           │    │           │        └ <kombu.transport.redis.MultiChannelPoller object at 0x0000026F18234B20>
           │    │           └ 3616
           │    └ <function MultiChannelPoller.on_readable at 0x0000026F18181120>
           └ <kombu.transport.redis.MultiChannelPoller object at 0x0000026F18234B20>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 576, in on_readable
    chan.handlers[type]()
    │    │        └ 'BRPOP'
    │    └ {'BRPOP': <bound method Channel._brpop_read of <kombu.transport.redis.Channel object at 0x0000026F18234AC0>>, 'LISTEN': <boun...
    └ <kombu.transport.redis.Channel object at 0x0000026F18234AC0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 986, in _brpop_read
    self.connection._deliver(loads(bytes_to_str(item)), dest)
    │    │          │        │     │            │       └ 'celery'
    │    │          │        │     │            └ b'{"body": "W1tdLCB7ImdlbmVyYXRpb25faWQiOiAiMDE5OWYwMmUtMDAwOS03MmI5LWI3MzMtNjRhZGNjYzEzZmUwIiwgImZhY2VfaW1hZ2VfcGF0aCI6ICIuL...
    │    │          │        │     └ <function bytes_to_str at 0x0000026F64A71B40>
    │    │          │        └ <function loads at 0x0000026F64AF27A0>
    │    │          └ <function Transport._deliver at 0x0000026F17F78D30>
    │    └ <kombu.transport.redis.Transport object at 0x0000026F18234A30>
    └ <kombu.transport.redis.Channel object at 0x0000026F18234AC0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 1017, in _deliver
    callback(message)
    │        └ {'body': 'W1tdLCB7ImdlbmVyYXRpb25faWQiOiAiMDE5OWYwMmUtMDAwOS03MmI5LWI3MzMtNjRhZGNjYzEzZmUwIiwgImZhY2VfaW1hZ2VfcGF0aCI6ICIuL3R...
    └ <function Channel.basic_consume.<locals>._callback at 0x0000026F1826E170>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 639, in _callback
    return callback(message)
           │        └ <Message object at 0x26f1826e7a0 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '384a...
           └ <bound method Consumer._receive_callback of <Consumer: [<Queue celery -> <Exchange celery(direct) bound to chan:1> -> celery ...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\messaging.py", line 668, in _receive_callback
    return on_m(message) if on_m else self.receive(decoded, message)
           │    │           │         │    │       │        └ <Message object at 0x26f1826e7a0 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '384a...
           │    │           │         │    │       └ None
           │    │           │         │    └ <function Consumer.receive at 0x0000026F64D15C60>
           │    │           │         └ <Consumer: [<Queue celery -> <Exchange celery(direct) bound to chan:1> -> celery bound to chan:1>]>
           │    │           └ <function Consumer.create_task_handler.<locals>.on_task_received at 0x0000026F1826E200>
           │    └ <Message object at 0x26f1826e7a0 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '384a...
           └ <function Consumer.create_task_handler.<locals>.on_task_received at 0x0000026F1826E200>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 688, in on_task_received
    strategy(
    └ <function default.<locals>.task_message_handler at 0x0000026F1826D5A0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\strategy.py", line 207, in task_message_handler
    handle(req)
    │      └ <Request: tasks.generate_personalized_image[c9d20daf-c83f-4312-862d-fdf44fd4c33c] () {'generation_id': '0199f02e-0009-72b9-b7...
    └ <bound method WorkController._process_task of <Worker: celery@soulmate-plus (running)>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\worker.py", line 226, in _process_task
    req.execute_using_pool(self.pool)
    │   │                  │    └ <celery.concurrency.solo.TaskPool object at 0x0000026F181859C0>
    │   │                  └ <Worker: celery@soulmate-plus (running)>
    │   └ <function create_request_cls.<locals>.Request.execute_using_pool at 0x0000026F1826D630>
    └ <Request: tasks.generate_personalized_image[c9d20daf-c83f-4312-862d-fdf44fd4c33c] () {'generation_id': '0199f02e-0009-72b9-b7...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\request.py", line 754, in execute_using_pool
    result = apply_async(
             └ <bound method BasePool.apply_async of <celery.concurrency.solo.TaskPool object at 0x0000026F181859C0>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\concurrency\base.py", line 153, in apply_async
    return self.on_apply(target, args, kwargs,
           │    │        │       │     └ {}
           │    │        │       └ ('tasks.generate_personalized_image', 'c9d20daf-c83f-4312-862d-fdf44fd4c33c', {'lang': 'py', 'task': 'tasks.generate_personal...
           │    │        └ <function fast_trace_task at 0x0000026F17E4A0E0>
           │    └ <function apply_target at 0x0000026F17E4A3B0>
           └ <celery.concurrency.solo.TaskPool object at 0x0000026F181859C0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\concurrency\base.py", line 30, in apply_target
    ret = target(*args, **kwargs)
          │       │       └ {}
          │       └ ('tasks.generate_personalized_image', 'c9d20daf-c83f-4312-862d-fdf44fd4c33c', {'lang': 'py', 'task': 'tasks.generate_personal...
          └ <function fast_trace_task at 0x0000026F17E4A0E0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 651, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
                    │     └ 'tasks.generate_personalized_image'
                    └ {'celery.chunks': <@task: celery.chunks of digital_signage_tasks at 0x26f643a5cc0>, 'digital_signage_tasks.warmup_models': <@...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 453, in trace_task
    R = retval = fun(*args, **kwargs)
                 │    │       └ {'generation_id': '0199f02e-0009-72b9-b733-64adccc13fe0', 'face_image_path': './temp\\0199f02e-0009-72b9-b733-64adccc13fe0_fa...
                 │    └ []
                 └ <@task: tasks.generate_personalized_image of digital_signage_tasks at 0x26f643a5cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 736, in __protected_call__
    return self.run(*args, **kwargs)
           │    │    │       └ {'generation_id': '0199f02e-0009-72b9-b733-64adccc13fe0', 'face_image_path': './temp\\0199f02e-0009-72b9-b733-64adccc13fe0_fa...
           │    │    └ ()
           │    └ <function generate_personalized_image at 0x0000026F17A58EE0>
           └ <@task: tasks.generate_personalized_image of digital_signage_tasks at 0x26f643a5cc0>

  File "C:\laragon\www\interactive-signage\digital-signage-ai\tasks\generation_task.py", line 184, in generate_personalized_image
    person_image = generator.generate_person(
                   │         └ <function AIGenerator.generate_person at 0x0000026F125C9360>
                   └ <app.services.ai_generator.AIGenerator object at 0x0000026F182C7A30>

> File "C:\laragon\www\interactive-signage\digital-signage-ai\app\services\ai_generator.py", line 201, in generate_person
    result = self.pipe(
             │    └ StableDiffusionPipeline {
             │        "_class_name": "StableDiffusionPipeline",
             │        "_diffusers_version": "0.21.4",
             │        "_name_or_path": "r...
             └ <app.services.ai_generator.AIGenerator object at 0x0000026F182C7A30>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           │     │       └ {'prompt': 'professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothi...
           │     └ (StableDiffusionPipeline {
           │         "_class_name": "StableDiffusionPipeline",
           │         "_diffusers_version": "0.21.4",
           │         "_name_or_path": "...
           └ <function StableDiffusionPipeline.__call__ at 0x0000026F125C85E0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\pipelines\stable_diffusion\pipeline_stable_diffusion.py", line 635, in __call__
    prompt_embeds, negative_prompt_embeds = self.encode_prompt(
    │                                       │    └ <function StableDiffusionPipeline.encode_prompt at 0x0000026F125C81F0>
    │                                       └ StableDiffusionPipeline {
    │                                           "_class_name": "StableDiffusionPipeline",
    │                                           "_diffusers_version": "0.21.4",
    │                                           "_name_or_path": "r...
    └ None

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\pipelines\stable_diffusion\pipeline_stable_diffusion.py", line 338, in encode_prompt
    prompt_embeds = self.text_encoder(
                    │    └ CLIPTextModel(
                    │        (text_model): CLIPTextTransformer(
                    │          (embeddings): CLIPTextEmbeddings(
                    │            (token_embedding): Embedding(...
                    └ StableDiffusionPipeline {
                        "_class_name": "StableDiffusionPipeline",
                        "_diffusers_version": "0.21.4",
                        "_name_or_path": "r...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'attention_mask': None}
           │    │           └ (tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │    │                       4129,  1449,  4269,   267,  4919,  ...
           │    └ <function Module._call_impl at 0x0000026F0B0031C0>
           └ CLIPTextModel(
               (text_model): CLIPTextTransformer(
                 (embeddings): CLIPTextEmbeddings(
                   (token_embedding): Embedding(...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'attention_mask': None}
           │             └ (tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │                         4129,  1449,  4269,   267,  4919,  ...
           └ <bound method CLIPTextModel.forward of CLIPTextModel(
               (text_model): CLIPTextTransformer(
                 (embeddings): CLIPTextEmbeddin...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\transformers\models\clip\modeling_clip.py", line 822, in forward
    return self.text_model(
           └ CLIPTextModel(
               (text_model): CLIPTextTransformer(
                 (embeddings): CLIPTextEmbeddings(
                   (token_embedding): Embedding(...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'input_ids': tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │    │           │                   4129,  1449,  4269,   ...
           │    │           └ ()
           │    └ <function Module._call_impl at 0x0000026F0B0031C0>
           └ CLIPTextTransformer(
               (embeddings): CLIPTextEmbeddings(
                 (token_embedding): Embedding(49408, 768)
                 (position_embedding...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'input_ids': tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │             │                   4129,  1449,  4269,   ...
           │             └ ()
           └ <bound method CLIPTextTransformer.forward of CLIPTextTransformer(
               (embeddings): CLIPTextEmbeddings(
                 (token_embedding): ...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\transformers\models\clip\modeling_clip.py", line 730, in forward
    hidden_states = self.embeddings(input_ids=input_ids, position_ids=position_ids)
                    │                         │                       └ None
                    │                         └ tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
                    │                                     4129,  1449,  4269,   267,  4919,  4...
                    └ CLIPTextTransformer(
                        (embeddings): CLIPTextEmbeddings(
                          (token_embedding): Embedding(49408, 768)
                          (position_embedding...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'input_ids': tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │    │           │                   4129,  1449,  4269,   ...
           │    │           └ ()
           │    └ <function Module._call_impl at 0x0000026F0B0031C0>
           └ CLIPTextEmbeddings(
               (token_embedding): Embedding(49408, 768)
               (position_embedding): Embedding(77, 768)
             )

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'input_ids': tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │             │                   4129,  1449,  4269,   ...
           │             └ ()
           └ <bound method CLIPTextEmbeddings.forward of CLIPTextEmbeddings(
               (token_embedding): Embedding(49408, 768)
               (position_embedd...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\transformers\models\clip\modeling_clip.py", line 224, in forward
    position_ids = self.position_ids[:, :seq_length]
                   │                     └ 77
                   └ CLIPTextEmbeddings(
                       (token_embedding): Embedding(49408, 768)
                       (position_embedding): Embedding(77, 768)
                     )

RuntimeError: Cannot set version_counter for inference tensor
2025-10-17 10:20:01.994 | ERROR    | tasks.generation_task:generate_personalized_image:316 - ❌ Generation failed for 0199f02e-0009-72b9-b733-64adccc13fe0: Failed to generate person image
2025-10-17 10:20:03.259 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f02e-0009-72b9-b733-64adccc13fe0/failed
2025-10-17 10:20:03.268 | ERROR    | tasks.generation_task:on_failure:47 - Task c9d20daf-c83f-4312-862d-fdf44fd4c33c failed: Failed to generate person image
2025-10-17 10:20:03.956 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f02e-0009-72b9-b733-64adccc13fe0/failed
2025-10-17 10:23:39.348 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-17 10:24:16.354 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199f032-3a3c-7387-be59-11bceae50eb3
2025-10-17 10:24:16.357 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-17 10:24:16.422 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-17 10:24:18.597 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-17 10:24:21.625 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-17 10:24:22.450 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-17 10:24:22.451 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-17 10:24:22.451 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-17 10:24:22.451 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-17 10:24:22.451 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-17 10:24:22.455 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-17 10:24:22.474 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-17 10:24:22.481 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-17 10:24:22.559 | INFO     | app.services.ai_generator:get_device:21 - ✅ Using DirectML device (AMD GPU): privateuseone:0
2025-10-17 10:24:22.559 | INFO     | app.services.ai_generator:__init__:54 - 🎮 DirectML (AMD GPU) mode enabled
2025-10-17 10:24:22.559 | INFO     | app.services.ai_generator:load_model:65 - ⏳ Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-17 10:24:22.559 | INFO     | app.services.ai_generator:load_model:66 - 🖥️ Target device: privateuseone:0
2025-10-17 10:24:22.559 | INFO     | app.services.ai_generator:load_model:71 - Using FP16 precision for GPU
2025-10-17 10:24:33.227 | INFO     | app.services.ai_generator:load_model:91 - 📦 Moving model to privateuseone:0...
2025-10-17 10:24:36.682 | INFO     | app.services.ai_generator:load_model:96 - 🔧 Applying DirectML compatibility fixes...
2025-10-17 10:24:36.941 | INFO     | app.services.ai_generator:load_model:100 - ✅ Text encoder moved to CPU
2025-10-17 10:24:36.941 | INFO     | app.services.ai_generator:load_model:101 - ✅ UNet & VAE remain on DirectML (AMD GPU)
2025-10-17 10:24:36.941 | INFO     | app.services.ai_generator:load_model:106 - 🔧 Applying DirectML (AMD) optimizations...
2025-10-17 10:24:36.953 | INFO     | app.services.ai_generator:load_model:109 - ✅ DirectML optimizations applied
2025-10-17 10:24:36.953 | INFO     | app.services.ai_generator:load_model:136 - ✅ Stable Diffusion model loaded successfully!
2025-10-17 10:24:36.953 | INFO     | app.services.ai_generator:load_model:137 - 📊 Model info: {'model_id': 'runwayml/stable-diffusion-v1-5', 'device': 'DirectML (AMD)', 'device_raw': 'privateuseone:0', 'loaded': True, 'is_directml': True, 'xformers_enabled': False, 'cpu_offload_enabled': False}
2025-10-17 10:24:36.953 | INFO     | tasks.generation_task:generate_personalized_image:147 - 📋 Template Config:
2025-10-17 10:24:36.953 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has base_prompt: True
2025-10-17 10:24:36.958 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Has negative_prompt: True
2025-10-17 10:24:36.958 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Min size: 768x1024
2025-10-17 10:24:36.958 | INFO     | tasks.generation_task:generate_personalized_image:151 -    - Guidance: 7.0, Steps: 35
2025-10-17 10:24:36.959 | INFO     | tasks.generation_task:generate_personalized_image:180 - Original size: 570x600
2025-10-17 10:24:36.959 | INFO     | tasks.generation_task:generate_personalized_image:181 - Generation size (scaled up): 968x1024
2025-10-17 10:24:36.959 | INFO     | app.utils.helpers:create_pose_prompt:163 - 🎯 Using TEMPLATE prompt with isolation: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 10:24:36.960 | INFO     | app.utils.helpers:create_negative_prompt:259 - 🎯 Using TEMPLATE negative prompt
2025-10-17 10:24:36.960 | INFO     | app.services.ai_generator:generate_person:187 - 🎨 Generating male person: sitting, size: 968x1024
2025-10-17 10:24:36.960 | INFO     | app.services.ai_generator:generate_person:188 - ⚙️ Steps: 35, Guidance: 7.0
2025-10-17 10:24:36.960 | INFO     | app.services.ai_generator:generate_person:189 - 📝 Prompt: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 10:24:36.961 | INFO     | app.services.ai_generator:generate_person:190 - 🚫 Negative: extra limbs, duplicate arms, duplicate legs, multiple hands, multiple feet, third arm, third leg, fo...
2025-10-17 10:24:36.961 | INFO     | app.services.ai_generator:generate_person:201 - 🚀 Starting generation...
2025-10-17 10:24:36.979 | ERROR    | app.services.ai_generator:generate_person:225 - ❌ Failed to generate person: tensor.device().type() == at::DeviceType::PrivateUse1 INTERNAL ASSERT FAILED at "C:\\__w\\1\\s\\pytorch-directml-plugin\\torch_directml\\csrc\\dml\\DMLTensor.cpp":31, please report a bug to PyTorch. unbox expects Dml at::Tensor as inputs
2025-10-17 10:24:36.979 | ERROR    | app.services.ai_generator:generate_person:226 - tensor.device().type() == at::DeviceType::PrivateUse1 INTERNAL ASSERT FAILED at "C:\\__w\\1\\s\\pytorch-directml-plugin\\torch_directml\\csrc\\dml\\DMLTensor.cpp":31, please report a bug to PyTorch. unbox expects Dml at::Tensor as inputs
Traceback (most recent call last):

  File "C:\laragon\www\interactive-signage\digital-signage-ai\celery_worker.py", line 49, in <module>
    celery_app.worker_main([
    │          └ <function Celery.worker_main at 0x00000171968AB0A0>
    └ <Celery digital_signage_tasks at 0x17195e85cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\base.py", line 470, in worker_main
    self.start(argv=argv)
    │    │          └ ['worker', '--loglevel=info', '--concurrency=1', '--pool=solo', '--task-events', '--without-gossip', '--without-mingle']
    │    └ <function Celery.start at 0x00000171968AB010>
    └ <Celery digital_signage_tasks at 0x17195e85cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\base.py", line 450, in start
    celery.main(args=argv, standalone_mode=False)
    │      │         └ ['worker', '--loglevel=info', '--concurrency=1', '--pool=solo', '--task-events', '--without-gossip', '--without-mingle']
    │      └ <function Command.main at 0x00000171967A89D0>
    └ <DYMGroup celery>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1383, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x00000171C9354850>
         │    └ <function Group.invoke at 0x00000171967A9360>
         └ <DYMGroup celery>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1850, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x00000171C97AE620>
           │               │       │       └ <function Command.invoke at 0x00000171967A88B0>
           │               │       └ <CeleryDaemonCommand worker>
           │               └ <click.core.Context object at 0x00000171C97AE620>
           └ <function Group.invoke.<locals>._process_result at 0x00000171C97A1AB0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1246, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │   │      │    │           └ <click.core.Context object at 0x00000171C97AE620>
           │   │      │    └ <function worker at 0x00000171C97A2830>
           │   │      └ <CeleryDaemonCommand worker>
           │   └ <function Context.invoke at 0x0000017196793BE0>
           └ <click.core.Context object at 0x00000171C97AE620>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 814, in invoke
    return callback(*args, **kwargs)
           │         │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │         └ ()
           └ <function worker at 0x00000171C97A2830>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\decorators.py", line 34, in new_func
    return f(get_current_context(), *args, **kwargs)
           │ │                       │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │ │                       └ ()
           │ └ <function get_current_context at 0x000001719674B910>
           └ <function worker at 0x00000171C97A27A0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bin\base.py", line 135, in caller
    return f(ctx, *args, **kwargs)
           │ │     │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │ │     └ ()
           │ └ <click.core.Context object at 0x00000171C97AE620>
           └ <function worker at 0x00000171C97A2710>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bin\worker.py", line 356, in worker
    worker.start()
    │      └ <function WorkController.start at 0x00000171C9706200>
    └ <Worker: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\worker.py", line 203, in start
    self.blueprint.start(self)
    │    │         │     └ <Worker: celery@soulmate-plus (running)>
    │    │         └ <function Blueprint.start at 0x00000171C96D67A0>
    │    └ <celery.worker.worker.WorkController.Blueprint object at 0x00000171C9A78460>
    └ <Worker: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
    │    │     └ <Worker: celery@soulmate-plus (running)>
    │    └ <function StartStopStep.start at 0x00000171C96D7880>
    └ <step: Consumer>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 365, in start
    return self.obj.start()
           │    │   └ <function Consumer.start at 0x00000171C9A8E560>
           │    └ <Consumer: celery@soulmate-plus (running)>
           └ <step: Consumer>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 341, in start
    blueprint.start(self)
    │         │     └ <Consumer: celery@soulmate-plus (running)>
    │         └ <function Blueprint.start at 0x00000171C96D67A0>
    └ <celery.worker.consumer.consumer.Consumer.Blueprint object at 0x00000171C9A584C0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
    │    │     └ <Consumer: celery@soulmate-plus (running)>
    │    └ <function Evloop.start at 0x00000171C9A8F6D0>
    └ <step: event loop>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 772, in start
    c.loop(*c.loop_args())
    │ │     │ └ <function Consumer.loop_args at 0x00000171C9A8E9E0>
    │ │     └ <Consumer: celery@soulmate-plus (running)>
    │ └ <function synloop at 0x00000171C9A8E200>
    └ <Consumer: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\loops.py", line 143, in synloop
    _loop_cycle()
    └ <function synloop.<locals>._loop_cycle at 0x00000171C9B568C0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\loops.py", line 132, in _loop_cycle
    connection.drain_events(timeout=2.0)
    │          └ <function Connection.drain_events at 0x00000171965E2440>
    └ <Connection: redis://localhost:6379/0 at 0x171c9b28850>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\connection.py", line 341, in drain_events
    return self.transport.drain_events(self.connection, **kwargs)
           │    │                      │    │             └ {'timeout': 2.0}
           │    │                      │    └ <property object at 0x00000171965F2390>
           │    │                      └ <Connection: redis://localhost:6379/0 at 0x171c9b28850>
           │    └ <property object at 0x00000171965F2480>
           └ <Connection: redis://localhost:6379/0 at 0x171c9b28850>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 997, in drain_events
    get(self._deliver, timeout=timeout)
    │   │    │                 └ 2.0
    │   │    └ <function Transport._deliver at 0x00000171C9864E50>
    │   └ <kombu.transport.redis.Transport object at 0x00000171C9B28970>
    └ <bound method MultiChannelPoller.get of <kombu.transport.redis.MultiChannelPoller object at 0x00000171C9B28A60>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 598, in get
    ret = self.handle_event(fileno, event)
          │    │            │       └ 1
          │    │            └ 3876
          │    └ <function MultiChannelPoller.handle_event at 0x00000171C9A752D0>
          └ <kombu.transport.redis.MultiChannelPoller object at 0x00000171C9B28A60>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 580, in handle_event
    return self.on_readable(fileno), self
           │    │           │        └ <kombu.transport.redis.MultiChannelPoller object at 0x00000171C9B28A60>
           │    │           └ 3876
           │    └ <function MultiChannelPoller.on_readable at 0x00000171C9A75240>
           └ <kombu.transport.redis.MultiChannelPoller object at 0x00000171C9B28A60>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 576, in on_readable
    chan.handlers[type]()
    │    │        └ 'BRPOP'
    │    └ {'BRPOP': <bound method Channel._brpop_read of <kombu.transport.redis.Channel object at 0x00000171C9B28A00>>, 'LISTEN': <boun...
    └ <kombu.transport.redis.Channel object at 0x00000171C9B28A00>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 986, in _brpop_read
    self.connection._deliver(loads(bytes_to_str(item)), dest)
    │    │          │        │     │            │       └ 'celery'
    │    │          │        │     │            └ b'{"body": "W1tdLCB7ImdlbmVyYXRpb25faWQiOiAiMDE5OWYwMzItM2EzYy03Mzg3LWJlNTktMTFiY2VhZTUwZWIzIiwgImZhY2VfaW1hZ2VfcGF0aCI6ICIuL...
    │    │          │        │     └ <function bytes_to_str at 0x0000017196581B40>
    │    │          │        └ <function loads at 0x00000171966027A0>
    │    │          └ <function Transport._deliver at 0x00000171C9864E50>
    │    └ <kombu.transport.redis.Transport object at 0x00000171C9B28970>
    └ <kombu.transport.redis.Channel object at 0x00000171C9B28A00>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 1017, in _deliver
    callback(message)
    │        └ {'body': 'W1tdLCB7ImdlbmVyYXRpb25faWQiOiAiMDE5OWYwMzItM2EzYy03Mzg3LWJlNTktMTFiY2VhZTUwZWIzIiwgImZhY2VfaW1hZ2VfcGF0aCI6ICIuL3R...
    └ <function Channel.basic_consume.<locals>._callback at 0x00000171C9B56830>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 639, in _callback
    return callback(message)
           │        └ <Message object at 0x171c9b56950 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '3a4e...
           └ <bound method Consumer._receive_callback of <Consumer: [<Queue celery -> <Exchange celery(direct) bound to chan:1> -> celery ...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\messaging.py", line 668, in _receive_callback
    return on_m(message) if on_m else self.receive(decoded, message)
           │    │           │         │    │       │        └ <Message object at 0x171c9b56950 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '3a4e...
           │    │           │         │    │       └ None
           │    │           │         │    └ <function Consumer.receive at 0x0000017196825C60>
           │    │           │         └ <Consumer: [<Queue celery -> <Exchange celery(direct) bound to chan:1> -> celery bound to chan:1>]>
           │    │           └ <function Consumer.create_task_handler.<locals>.on_task_received at 0x00000171C9B567A0>
           │    └ <Message object at 0x171c9b56950 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '3a4e...
           └ <function Consumer.create_task_handler.<locals>.on_task_received at 0x00000171C9B567A0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 688, in on_task_received
    strategy(
    └ <function default.<locals>.task_message_handler at 0x00000171C9B54820>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\strategy.py", line 207, in task_message_handler
    handle(req)
    │      └ <Request: tasks.generate_personalized_image[17e8c950-d9f2-4d79-9438-799799467d57] () {'generation_id': '0199f032-3a3c-7387-be...
    └ <bound method WorkController._process_task of <Worker: celery@soulmate-plus (running)>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\worker.py", line 226, in _process_task
    req.execute_using_pool(self.pool)
    │   │                  │    └ <celery.concurrency.solo.TaskPool object at 0x00000171C9A79930>
    │   │                  └ <Worker: celery@soulmate-plus (running)>
    │   └ <function create_request_cls.<locals>.Request.execute_using_pool at 0x00000171C9B548B0>
    └ <Request: tasks.generate_personalized_image[17e8c950-d9f2-4d79-9438-799799467d57] () {'generation_id': '0199f032-3a3c-7387-be...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\request.py", line 754, in execute_using_pool
    result = apply_async(
             └ <bound method BasePool.apply_async of <celery.concurrency.solo.TaskPool object at 0x00000171C9A79930>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\concurrency\base.py", line 153, in apply_async
    return self.on_apply(target, args, kwargs,
           │    │        │       │     └ {}
           │    │        │       └ ('tasks.generate_personalized_image', '17e8c950-d9f2-4d79-9438-799799467d57', {'lang': 'py', 'task': 'tasks.generate_personal...
           │    │        └ <function fast_trace_task at 0x00000171C973A200>
           │    └ <function apply_target at 0x00000171C973A4D0>
           └ <celery.concurrency.solo.TaskPool object at 0x00000171C9A79930>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\concurrency\base.py", line 30, in apply_target
    ret = target(*args, **kwargs)
          │       │       └ {}
          │       └ ('tasks.generate_personalized_image', '17e8c950-d9f2-4d79-9438-799799467d57', {'lang': 'py', 'task': 'tasks.generate_personal...
          └ <function fast_trace_task at 0x00000171C973A200>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 651, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
                    │     └ 'tasks.generate_personalized_image'
                    └ {'celery.chunks': <@task: celery.chunks of digital_signage_tasks at 0x17195e85cc0>, 'celery.chord_unlock': <@task: celery.cho...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 453, in trace_task
    R = retval = fun(*args, **kwargs)
                 │    │       └ {'generation_id': '0199f032-3a3c-7387-be59-11bceae50eb3', 'face_image_path': './temp\\0199f032-3a3c-7387-be59-11bceae50eb3_fa...
                 │    └ []
                 └ <@task: tasks.generate_personalized_image of digital_signage_tasks at 0x17195e85cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 736, in __protected_call__
    return self.run(*args, **kwargs)
           │    │    │       └ {'generation_id': '0199f032-3a3c-7387-be59-11bceae50eb3', 'face_image_path': './temp\\0199f032-3a3c-7387-be59-11bceae50eb3_fa...
           │    │    └ ()
           │    └ <function generate_personalized_image at 0x00000171C9345000>
           └ <@task: tasks.generate_personalized_image of digital_signage_tasks at 0x17195e85cc0>

  File "C:\laragon\www\interactive-signage\digital-signage-ai\tasks\generation_task.py", line 184, in generate_personalized_image
    person_image = generator.generate_person(
                   │         └ <function AIGenerator.generate_person at 0x00000171C3EA9480>
                   └ <app.services.ai_generator.AIGenerator object at 0x00000171C9B6A2C0>

> File "C:\laragon\www\interactive-signage\digital-signage-ai\app\services\ai_generator.py", line 206, in generate_person
    result = self.pipe(
             │    └ StableDiffusionPipeline {
             │        "_class_name": "StableDiffusionPipeline",
             │        "_diffusers_version": "0.21.4",
             │        "_name_or_path": "r...
             └ <app.services.ai_generator.AIGenerator object at 0x00000171C9B6A2C0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           │     │       └ {'prompt': 'professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothi...
           │     └ (StableDiffusionPipeline {
           │         "_class_name": "StableDiffusionPipeline",
           │         "_diffusers_version": "0.21.4",
           │         "_name_or_path": "...
           └ <function StableDiffusionPipeline.__call__ at 0x00000171C3EA8700>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\pipelines\stable_diffusion\pipeline_stable_diffusion.py", line 635, in __call__
    prompt_embeds, negative_prompt_embeds = self.encode_prompt(
    │                                       │    └ <function StableDiffusionPipeline.encode_prompt at 0x00000171C3EA8310>
    │                                       └ StableDiffusionPipeline {
    │                                           "_class_name": "StableDiffusionPipeline",
    │                                           "_diffusers_version": "0.21.4",
    │                                           "_name_or_path": "r...
    └ None

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\pipelines\stable_diffusion\pipeline_stable_diffusion.py", line 338, in encode_prompt
    prompt_embeds = self.text_encoder(
                    │    └ CLIPTextModel(
                    │        (text_model): CLIPTextTransformer(
                    │          (embeddings): CLIPTextEmbeddings(
                    │            (token_embedding): Embedding(...
                    └ StableDiffusionPipeline {
                        "_class_name": "StableDiffusionPipeline",
                        "_diffusers_version": "0.21.4",
                        "_name_or_path": "r...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'attention_mask': None}
           │    │           └ (tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │    │                       4129,  1449,  4269,   267,  4919,  ...
           │    └ <function Module._call_impl at 0x00000171BCB231C0>
           └ CLIPTextModel(
               (text_model): CLIPTextTransformer(
                 (embeddings): CLIPTextEmbeddings(
                   (token_embedding): Embedding(...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'attention_mask': None}
           │             └ (tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │                         4129,  1449,  4269,   267,  4919,  ...
           └ <bound method CLIPTextModel.forward of CLIPTextModel(
               (text_model): CLIPTextTransformer(
                 (embeddings): CLIPTextEmbeddin...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\transformers\models\clip\modeling_clip.py", line 822, in forward
    return self.text_model(
           └ CLIPTextModel(
               (text_model): CLIPTextTransformer(
                 (embeddings): CLIPTextEmbeddings(
                   (token_embedding): Embedding(...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'input_ids': tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │    │           │                   4129,  1449,  4269,   ...
           │    │           └ ()
           │    └ <function Module._call_impl at 0x00000171BCB231C0>
           └ CLIPTextTransformer(
               (embeddings): CLIPTextEmbeddings(
                 (token_embedding): Embedding(49408, 768)
                 (position_embedding...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'input_ids': tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │             │                   4129,  1449,  4269,   ...
           │             └ ()
           └ <bound method CLIPTextTransformer.forward of CLIPTextTransformer(
               (embeddings): CLIPTextEmbeddings(
                 (token_embedding): ...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\transformers\models\clip\modeling_clip.py", line 730, in forward
    hidden_states = self.embeddings(input_ids=input_ids, position_ids=position_ids)
                    │                         │                       └ None
                    │                         └ tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
                    │                                     4129,  1449,  4269,   267,  4919,  4...
                    └ CLIPTextTransformer(
                        (embeddings): CLIPTextEmbeddings(
                          (token_embedding): Embedding(49408, 768)
                          (position_embedding...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'input_ids': tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │    │           │                   4129,  1449,  4269,   ...
           │    │           └ ()
           │    └ <function Module._call_impl at 0x00000171BCB231C0>
           └ CLIPTextEmbeddings(
               (token_embedding): Embedding(49408, 768)
               (position_embedding): Embedding(77, 768)
             )

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'input_ids': tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │             │                   4129,  1449,  4269,   ...
           │             └ ()
           └ <bound method CLIPTextEmbeddings.forward of CLIPTextEmbeddings(
               (token_embedding): Embedding(49408, 768)
               (position_embedd...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\transformers\models\clip\modeling_clip.py", line 227, in forward
    inputs_embeds = self.token_embedding(input_ids)
                    │                    └ tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
                    │                                4129,  1449,  4269,   267,  4919,  4...
                    └ CLIPTextEmbeddings(
                        (token_embedding): Embedding(49408, 768)
                        (position_embedding): Embedding(77, 768)
                      )

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {}
           │    │           └ (tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │    │                       4129,  1449,  4269,   267,  4919,  ...
           │    └ <function Module._call_impl at 0x00000171BCB231C0>
           └ Embedding(49408, 768)

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {}
           │             └ (tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │                         4129,  1449,  4269,   267,  4919,  ...
           └ <bound method Embedding.forward of Embedding(49408, 768)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\sparse.py", line 164, in forward
    return F.embedding(
           │ └ <function embedding at 0x00000171BCC42290>
           └ <module 'torch.nn.functional' from 'C:\\laragon\\bin\\python\\python-3.10\\lib\\site-packages\\torch\\nn\\functional.py'>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\functional.py", line 2267, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
           │     │         │       │      │            │                   └ False
           │     │         │       │      │            └ False
           │     │         │       │      └ -1
           │     │         │       └ tensor([[49406,  4774,  1476,  1774,  1125,   539,   786,  2533,  4919,   525,
           │     │         │                   4129,  1449,  4269,   267,  4919,  4...
           │     │         └ Parameter containing:
           │     │           tensor([[-0.0012,  0.0368,  0.0221,  ...,  0.0158,  0.0046, -0.0219],
           │     │                   [ 0.0152,  0.0262, -0.013...
           │     └ <built-in method embedding of type object at 0x00007FFA80A7DE80>
           └ <module 'torch' from 'C:\\laragon\\bin\\python\\python-3.10\\lib\\site-packages\\torch\\__init__.py'>

RuntimeError: tensor.device().type() == at::DeviceType::PrivateUse1 INTERNAL ASSERT FAILED at "C:\\__w\\1\\s\\pytorch-directml-plugin\\torch_directml\\csrc\\dml\\DMLTensor.cpp":31, please report a bug to PyTorch. unbox expects Dml at::Tensor as inputs
2025-10-17 10:24:38.075 | ERROR    | tasks.generation_task:generate_personalized_image:316 - ❌ Generation failed for 0199f032-3a3c-7387-be59-11bceae50eb3: Failed to generate person image
2025-10-17 10:24:38.930 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f032-3a3c-7387-be59-11bceae50eb3/failed
2025-10-17 10:24:38.936 | ERROR    | tasks.generation_task:on_failure:47 - Task 17e8c950-d9f2-4d79-9438-799799467d57 failed: Failed to generate person image
2025-10-17 10:24:39.651 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f032-3a3c-7387-be59-11bceae50eb3/failed
2025-10-17 10:29:02.026 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-17 10:29:40.238 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199f037-2ae9-728b-8257-59b664a593f1
2025-10-17 10:29:40.239 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-17 10:29:40.307 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-17 10:29:42.237 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-17 10:29:44.673 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-17 10:29:45.481 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-17 10:29:45.482 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-17 10:29:45.483 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-17 10:29:45.483 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-17 10:29:45.484 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-17 10:29:45.486 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-17 10:29:45.798 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-17 10:29:45.801 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-17 10:29:45.884 | INFO     | app.services.ai_generator:get_device:21 - ✅ Using DirectML device (AMD GPU): privateuseone:0
2025-10-17 10:29:45.885 | INFO     | app.services.ai_generator:__init__:54 - 🎮 DirectML (AMD GPU) mode enabled
2025-10-17 10:29:45.885 | INFO     | app.services.ai_generator:load_model:110 - ⏳ Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-17 10:29:45.886 | INFO     | app.services.ai_generator:load_model:111 - 🖥️ Target device: privateuseone:0
2025-10-17 10:29:45.886 | INFO     | app.services.ai_generator:load_model:116 - Using FP16 precision for GPU
2025-10-17 10:29:56.203 | INFO     | app.services.ai_generator:load_model:136 - 📦 Moving model to privateuseone:0...
2025-10-17 10:30:00.025 | INFO     | app.services.ai_generator:load_model:141 - 🔧 Applying DirectML compatibility fixes...
2025-10-17 10:30:00.304 | INFO     | app.services.ai_generator:load_model:145 - ✅ Text encoder moved to CPU
2025-10-17 10:30:00.305 | INFO     | app.services.ai_generator:load_model:146 - ✅ UNet & VAE remain on DirectML (AMD GPU)
2025-10-17 10:30:00.305 | INFO     | app.services.ai_generator:_patch_pipeline_for_directml:101 - ✅ Pipeline patched for DirectML compatibility
2025-10-17 10:30:00.306 | INFO     | app.services.ai_generator:load_model:155 - 🔧 Applying DirectML (AMD) optimizations...
2025-10-17 10:30:00.313 | INFO     | app.services.ai_generator:load_model:158 - ✅ DirectML optimizations applied
2025-10-17 10:30:00.313 | INFO     | app.services.ai_generator:load_model:185 - ✅ Stable Diffusion model loaded successfully!
2025-10-17 10:30:00.313 | INFO     | app.services.ai_generator:load_model:186 - 📊 Model info: {'model_id': 'runwayml/stable-diffusion-v1-5', 'device': 'DirectML (AMD)', 'device_raw': 'privateuseone:0', 'loaded': True, 'is_directml': True, 'xformers_enabled': False, 'cpu_offload_enabled': False}
2025-10-17 10:30:00.314 | INFO     | tasks.generation_task:generate_personalized_image:147 - 📋 Template Config:
2025-10-17 10:30:00.315 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has base_prompt: True
2025-10-17 10:30:00.316 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Has negative_prompt: True
2025-10-17 10:30:00.316 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Min size: 768x1024
2025-10-17 10:30:00.317 | INFO     | tasks.generation_task:generate_personalized_image:151 -    - Guidance: 7.0, Steps: 35
2025-10-17 10:30:00.317 | INFO     | tasks.generation_task:generate_personalized_image:180 - Original size: 570x600
2025-10-17 10:30:00.318 | INFO     | tasks.generation_task:generate_personalized_image:181 - Generation size (scaled up): 968x1024
2025-10-17 10:30:00.318 | INFO     | app.utils.helpers:create_pose_prompt:163 - 🎯 Using TEMPLATE prompt with isolation: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 10:30:00.319 | INFO     | app.utils.helpers:create_negative_prompt:259 - 🎯 Using TEMPLATE negative prompt
2025-10-17 10:30:00.319 | INFO     | app.services.ai_generator:generate_person:236 - 🎨 Generating male person: sitting, size: 968x1024
2025-10-17 10:30:00.320 | INFO     | app.services.ai_generator:generate_person:237 - ⚙️ Steps: 35, Guidance: 7.0
2025-10-17 10:30:00.320 | INFO     | app.services.ai_generator:generate_person:238 - 📝 Prompt: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 10:30:00.321 | INFO     | app.services.ai_generator:generate_person:239 - 🚫 Negative: extra limbs, duplicate arms, duplicate legs, multiple hands, multiple feet, third arm, third leg, fo...
2025-10-17 10:30:00.321 | INFO     | app.services.ai_generator:generate_person:250 - 🚀 Starting generation...
2025-10-17 10:30:26.646 | ERROR    | app.services.ai_generator:generate_person:274 - ❌ Failed to generate person: Cannot set version_counter for inference tensor
2025-10-17 10:30:26.646 | ERROR    | app.services.ai_generator:generate_person:275 - Cannot set version_counter for inference tensor
Traceback (most recent call last):

  File "C:\laragon\www\interactive-signage\digital-signage-ai\celery_worker.py", line 49, in <module>
    celery_app.worker_main([
    │          └ <function Celery.worker_main at 0x0000015ABF78B0A0>
    └ <Celery digital_signage_tasks at 0x15abed65cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\base.py", line 470, in worker_main
    self.start(argv=argv)
    │    │          └ ['worker', '--loglevel=info', '--concurrency=1', '--pool=solo', '--task-events', '--without-gossip', '--without-mingle']
    │    └ <function Celery.start at 0x0000015ABF78B010>
    └ <Celery digital_signage_tasks at 0x15abed65cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\base.py", line 450, in start
    celery.main(args=argv, standalone_mode=False)
    │      │         └ ['worker', '--loglevel=info', '--concurrency=1', '--pool=solo', '--task-events', '--without-gossip', '--without-mingle']
    │      └ <function Command.main at 0x0000015ABF6889D0>
    └ <DYMGroup celery>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1383, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x0000015AF21F88E0>
         │    └ <function Group.invoke at 0x0000015ABF689360>
         └ <DYMGroup celery>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1850, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x0000015AF26526B0>
           │               │       │       └ <function Command.invoke at 0x0000015ABF6888B0>
           │               │       └ <CeleryDaemonCommand worker>
           │               └ <click.core.Context object at 0x0000015AF26526B0>
           └ <function Group.invoke.<locals>._process_result at 0x0000015AF264D750>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1246, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │   │      │    │           └ <click.core.Context object at 0x0000015AF26526B0>
           │   │      │    └ <function worker at 0x0000015AF264E4D0>
           │   │      └ <CeleryDaemonCommand worker>
           │   └ <function Context.invoke at 0x0000015ABF673BE0>
           └ <click.core.Context object at 0x0000015AF26526B0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 814, in invoke
    return callback(*args, **kwargs)
           │         │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │         └ ()
           └ <function worker at 0x0000015AF264E4D0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\decorators.py", line 34, in new_func
    return f(get_current_context(), *args, **kwargs)
           │ │                       │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │ │                       └ ()
           │ └ <function get_current_context at 0x0000015ABF62B910>
           └ <function worker at 0x0000015AF264E440>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bin\base.py", line 135, in caller
    return f(ctx, *args, **kwargs)
           │ │     │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │ │     └ ()
           │ └ <click.core.Context object at 0x0000015AF26526B0>
           └ <function worker at 0x0000015AF264E3B0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bin\worker.py", line 356, in worker
    worker.start()
    │      └ <function WorkController.start at 0x0000015AF25B5EA0>
    └ <Worker: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\worker.py", line 203, in start
    self.blueprint.start(self)
    │    │         │     └ <Worker: celery@soulmate-plus (running)>
    │    │         └ <function Blueprint.start at 0x0000015AF2582440>
    │    └ <celery.worker.worker.WorkController.Blueprint object at 0x0000015AF29184F0>
    └ <Worker: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
    │    │     └ <Worker: celery@soulmate-plus (running)>
    │    └ <function StartStopStep.start at 0x0000015AF2583520>
    └ <step: Consumer>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 365, in start
    return self.obj.start()
           │    │   └ <function Consumer.start at 0x0000015AF2936200>
           │    └ <Consumer: celery@soulmate-plus (running)>
           └ <step: Consumer>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 341, in start
    blueprint.start(self)
    │         │     └ <Consumer: celery@soulmate-plus (running)>
    │         └ <function Blueprint.start at 0x0000015AF2582440>
    └ <celery.worker.consumer.consumer.Consumer.Blueprint object at 0x0000015AF28FC550>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
    │    │     └ <Consumer: celery@soulmate-plus (running)>
    │    └ <function Evloop.start at 0x0000015AF2937370>
    └ <step: event loop>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 772, in start
    c.loop(*c.loop_args())
    │ │     │ └ <function Consumer.loop_args at 0x0000015AF2936680>
    │ │     └ <Consumer: celery@soulmate-plus (running)>
    │ └ <function synloop at 0x0000015AF2935EA0>
    └ <Consumer: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\loops.py", line 143, in synloop
    _loop_cycle()
    └ <function synloop.<locals>._loop_cycle at 0x0000015AF2A02560>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\loops.py", line 132, in _loop_cycle
    connection.drain_events(timeout=2.0)
    │          └ <function Connection.drain_events at 0x0000015ABF4C2440>
    └ <Connection: redis://localhost:6379/0 at 0x15af29c48e0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\connection.py", line 341, in drain_events
    return self.transport.drain_events(self.connection, **kwargs)
           │    │                      │    │             └ {'timeout': 2.0}
           │    │                      │    └ <property object at 0x0000015ABF4D2390>
           │    │                      └ <Connection: redis://localhost:6379/0 at 0x15af29c48e0>
           │    └ <property object at 0x0000015ABF4D2480>
           └ <Connection: redis://localhost:6379/0 at 0x15af29c48e0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 997, in drain_events
    get(self._deliver, timeout=timeout)
    │   │    │                 └ 2.0
    │   │    └ <function Transport._deliver at 0x0000015AF2708AF0>
    │   └ <kombu.transport.redis.Transport object at 0x0000015AF29C4A00>
    └ <bound method MultiChannelPoller.get of <kombu.transport.redis.MultiChannelPoller object at 0x0000015AF29C4AF0>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 598, in get
    ret = self.handle_event(fileno, event)
          │    │            │       └ 1
          │    │            └ 3772
          │    └ <function MultiChannelPoller.handle_event at 0x0000015AF2914F70>
          └ <kombu.transport.redis.MultiChannelPoller object at 0x0000015AF29C4AF0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 580, in handle_event
    return self.on_readable(fileno), self
           │    │           │        └ <kombu.transport.redis.MultiChannelPoller object at 0x0000015AF29C4AF0>
           │    │           └ 3772
           │    └ <function MultiChannelPoller.on_readable at 0x0000015AF2914EE0>
           └ <kombu.transport.redis.MultiChannelPoller object at 0x0000015AF29C4AF0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 576, in on_readable
    chan.handlers[type]()
    │    │        └ 'BRPOP'
    │    └ {'BRPOP': <bound method Channel._brpop_read of <kombu.transport.redis.Channel object at 0x0000015AF29C4A90>>, 'LISTEN': <boun...
    └ <kombu.transport.redis.Channel object at 0x0000015AF29C4A90>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 986, in _brpop_read
    self.connection._deliver(loads(bytes_to_str(item)), dest)
    │    │          │        │     │            │       └ 'celery'
    │    │          │        │     │            └ b'{"body": "W1tdLCB7ImdlbmVyYXRpb25faWQiOiAiMDE5OWYwMzctMmFlOS03MjhiLTgyNTctNTliNjY0YTU5M2YxIiwgImZhY2VfaW1hZ2VfcGF0aCI6ICIuL...
    │    │          │        │     └ <function bytes_to_str at 0x0000015ABF461B40>
    │    │          │        └ <function loads at 0x0000015ABF4E27A0>
    │    │          └ <function Transport._deliver at 0x0000015AF2708AF0>
    │    └ <kombu.transport.redis.Transport object at 0x0000015AF29C4A00>
    └ <kombu.transport.redis.Channel object at 0x0000015AF29C4A90>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 1017, in _deliver
    callback(message)
    │        └ {'body': 'W1tdLCB7ImdlbmVyYXRpb25faWQiOiAiMDE5OWYwMzctMmFlOS03MjhiLTgyNTctNTliNjY0YTU5M2YxIiwgImZhY2VfaW1hZ2VfcGF0aCI6ICIuL3R...
    └ <function Channel.basic_consume.<locals>._callback at 0x0000015AF2A024D0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 639, in _callback
    return callback(message)
           │        └ <Message object at 0x15af2a025f0 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '1f91...
           └ <bound method Consumer._receive_callback of <Consumer: [<Queue celery -> <Exchange celery(direct) bound to chan:1> -> celery ...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\messaging.py", line 668, in _receive_callback
    return on_m(message) if on_m else self.receive(decoded, message)
           │    │           │         │    │       │        └ <Message object at 0x15af2a025f0 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '1f91...
           │    │           │         │    │       └ None
           │    │           │         │    └ <function Consumer.receive at 0x0000015ABF705C60>
           │    │           │         └ <Consumer: [<Queue celery -> <Exchange celery(direct) bound to chan:1> -> celery bound to chan:1>]>
           │    │           └ <function Consumer.create_task_handler.<locals>.on_task_received at 0x0000015AF2A02440>
           │    └ <Message object at 0x15af2a025f0 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '1f91...
           └ <function Consumer.create_task_handler.<locals>.on_task_received at 0x0000015AF2A02440>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 688, in on_task_received
    strategy(
    └ <function default.<locals>.task_message_handler at 0x0000015AF2A00AF0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\strategy.py", line 207, in task_message_handler
    handle(req)
    │      └ <Request: tasks.generate_personalized_image[48f7529a-3289-47b6-b0fb-12b867946447] () {'generation_id': '0199f037-2ae9-728b-82...
    └ <bound method WorkController._process_task of <Worker: celery@soulmate-plus (running)>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\worker.py", line 226, in _process_task
    req.execute_using_pool(self.pool)
    │   │                  │    └ <celery.concurrency.solo.TaskPool object at 0x0000015AF29199C0>
    │   │                  └ <Worker: celery@soulmate-plus (running)>
    │   └ <function create_request_cls.<locals>.Request.execute_using_pool at 0x0000015AF2A00B80>
    └ <Request: tasks.generate_personalized_image[48f7529a-3289-47b6-b0fb-12b867946447] () {'generation_id': '0199f037-2ae9-728b-82...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\request.py", line 754, in execute_using_pool
    result = apply_async(
             └ <bound method BasePool.apply_async of <celery.concurrency.solo.TaskPool object at 0x0000015AF29199C0>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\concurrency\base.py", line 153, in apply_async
    return self.on_apply(target, args, kwargs,
           │    │        │       │     └ {}
           │    │        │       └ ('tasks.generate_personalized_image', '48f7529a-3289-47b6-b0fb-12b867946447', {'lang': 'py', 'task': 'tasks.generate_personal...
           │    │        └ <function fast_trace_task at 0x0000015AF25DDEA0>
           │    └ <function apply_target at 0x0000015AF25DE170>
           └ <celery.concurrency.solo.TaskPool object at 0x0000015AF29199C0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\concurrency\base.py", line 30, in apply_target
    ret = target(*args, **kwargs)
          │       │       └ {}
          │       └ ('tasks.generate_personalized_image', '48f7529a-3289-47b6-b0fb-12b867946447', {'lang': 'py', 'task': 'tasks.generate_personal...
          └ <function fast_trace_task at 0x0000015AF25DDEA0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 651, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
                    │     └ 'tasks.generate_personalized_image'
                    └ {'celery.chunks': <@task: celery.chunks of digital_signage_tasks at 0x15abed65cc0>, 'tasks.cleanup_old_files': <@task: tasks....

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 453, in trace_task
    R = retval = fun(*args, **kwargs)
                 │    │       └ {'generation_id': '0199f037-2ae9-728b-8257-59b664a593f1', 'face_image_path': './temp\\0199f037-2ae9-728b-8257-59b664a593f1_fa...
                 │    └ []
                 └ <@task: tasks.generate_personalized_image of digital_signage_tasks at 0x15abed65cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 736, in __protected_call__
    return self.run(*args, **kwargs)
           │    │    │       └ {'generation_id': '0199f037-2ae9-728b-8257-59b664a593f1', 'face_image_path': './temp\\0199f037-2ae9-728b-8257-59b664a593f1_fa...
           │    │    └ ()
           │    └ <function generate_personalized_image at 0x0000015AF21F0CA0>
           └ <@task: tasks.generate_personalized_image of digital_signage_tasks at 0x15abed65cc0>

  File "C:\laragon\www\interactive-signage\digital-signage-ai\tasks\generation_task.py", line 184, in generate_personalized_image
    person_image = generator.generate_person(
                   │         └ <function AIGenerator.generate_person at 0x0000015AECD79120>
                   └ <app.services.ai_generator.AIGenerator object at 0x0000015AF2A12410>

> File "C:\laragon\www\interactive-signage\digital-signage-ai\app\services\ai_generator.py", line 255, in generate_person
    result = self.pipe(
             │    └ StableDiffusionPipeline {
             │        "_class_name": "StableDiffusionPipeline",
             │        "_diffusers_version": "0.21.4",
             │        "_name_or_path": "r...
             └ <app.services.ai_generator.AIGenerator object at 0x0000015AF2A12410>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           │     │       └ {'prompt': 'professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothi...
           │     └ (StableDiffusionPipeline {
           │         "_class_name": "StableDiffusionPipeline",
           │         "_diffusers_version": "0.21.4",
           │         "_name_or_path": "...
           └ <function StableDiffusionPipeline.__call__ at 0x0000015AECD78310>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\pipelines\stable_diffusion\pipeline_stable_diffusion.py", line 680, in __call__
    noise_pred = self.unet(
                 │    └ UNet2DConditionModel(
                 │        (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
                 │        (time_proj): Timesteps...
                 └ StableDiffusionPipeline {
                     "_class_name": "StableDiffusionPipeline",
                     "_diffusers_version": "0.21.4",
                     "_name_or_path": "r...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'encoder_hidden_states': tensor([[[-0.3884,  0.0229, -0.0523,  ..., -0.4902, -0.3066,  0.0674],
           │    │           │                  [ 0.8726, -0.1622, ...
           │    │           └ (tensor([[[[ 4.1675e-01, -1.2314e+00,  4.4092e-01,  ...,  5.0342e-01,
           │    │                         1.1841e-02,  8.0518e-01],
           │    │                       [-7.773...
           │    └ <function Module._call_impl at 0x0000015AE59F31C0>
           └ UNet2DConditionModel(
               (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
               (time_proj): Timesteps...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'encoder_hidden_states': tensor([[[-0.3884,  0.0229, -0.0523,  ..., -0.4902, -0.3066,  0.0674],
           │             │                  [ 0.8726, -0.1622, ...
           │             └ (tensor([[[[ 4.1675e-01, -1.2314e+00,  4.4092e-01,  ...,  5.0342e-01,
           │                           1.1841e-02,  8.0518e-01],
           │                         [-7.773...
           └ <bound method UNet2DConditionModel.forward of UNet2DConditionModel(
               (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\unet_2d_condition.py", line 841, in forward
    emb = self.time_embedding(t_emb, timestep_cond)
          │                   │      └ None
          │                   └ tensor([[ 0.9995,  0.8022, -0.2781,  0.1768, -0.2778,  0.1252, -0.9287, -0.0869,
          │                              -0.4231, -0.2622, -0.8438, -0.8384,...
          └ UNet2DConditionModel(
              (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
              (time_proj): Timesteps...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {}
           │    │           └ (tensor([[ 0.9995,  0.8022, -0.2781,  0.1768, -0.2778,  0.1252, -0.9287, -0.0869,
           │    │                      -0.4231, -0.2622, -0.8438, -0.8384...
           │    └ <function Module._call_impl at 0x0000015AE59F31C0>
           └ TimestepEmbedding(
               (linear_1): Linear(in_features=320, out_features=1280, bias=True)
               (act): SiLU()
               (linear_2): Linear(i...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {}
           │             └ (tensor([[ 0.9995,  0.8022, -0.2781,  0.1768, -0.2778,  0.1252, -0.9287, -0.0869,
           │                        -0.4231, -0.2622, -0.8438, -0.8384...
           └ <bound method TimestepEmbedding.forward of TimestepEmbedding(
               (linear_1): Linear(in_features=320, out_features=1280, bias=T...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\embeddings.py", line 192, in forward
    sample = self.linear_1(sample)
             │             └ tensor([[ 0.9995,  0.8022, -0.2781,  0.1768, -0.2778,  0.1252, -0.9287, -0.0869,
             │                        -0.4231, -0.2622, -0.8438, -0.8384,...
             └ TimestepEmbedding(
                 (linear_1): Linear(in_features=320, out_features=1280, bias=True)
                 (act): SiLU()
                 (linear_2): Linear(i...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {}
           │    │           └ (tensor([[ 0.9995,  0.8022, -0.2781,  0.1768, -0.2778,  0.1252, -0.9287, -0.0869,
           │    │                      -0.4231, -0.2622, -0.8438, -0.8384...
           │    └ <function Module._call_impl at 0x0000015AE59F31C0>
           └ Linear(in_features=320, out_features=1280, bias=True)

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {}
           │             └ (tensor([[ 0.9995,  0.8022, -0.2781,  0.1768, -0.2778,  0.1252, -0.9287, -0.0869,
           │                        -0.4231, -0.2622, -0.8438, -0.8384...
           └ <bound method Linear.forward of Linear(in_features=320, out_features=1280, bias=True)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\linear.py", line 117, in forward
    return F.linear(input, self.weight, self.bias)
           │ │      │      │            └ Linear(in_features=320, out_features=1280, bias=True)
           │ │      │      └ Linear(in_features=320, out_features=1280, bias=True)
           │ │      └ tensor([[ 0.9995,  0.8022, -0.2781,  0.1768, -0.2778,  0.1252, -0.9287, -0.0869,
           │ │                 -0.4231, -0.2622, -0.8438, -0.8384,...
           │ └ <built-in function linear>
           └ <module 'torch.nn.functional' from 'C:\\laragon\\bin\\python\\python-3.10\\lib\\site-packages\\torch\\nn\\functional.py'>

RuntimeError: Cannot set version_counter for inference tensor
2025-10-17 10:30:33.436 | ERROR    | tasks.generation_task:generate_personalized_image:316 - ❌ Generation failed for 0199f037-2ae9-728b-8257-59b664a593f1: Failed to generate person image
2025-10-17 10:30:34.449 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f037-2ae9-728b-8257-59b664a593f1/failed
2025-10-17 10:30:34.456 | ERROR    | tasks.generation_task:on_failure:47 - Task 48f7529a-3289-47b6-b0fb-12b867946447 failed: Failed to generate person image
2025-10-17 10:30:35.117 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f037-2ae9-728b-8257-59b664a593f1/failed
2025-10-17 10:33:58.050 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-17 10:34:36.677 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199f03b-b1ce-71f8-ba73-d749c475a2f1
2025-10-17 10:34:36.698 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-17 10:34:36.771 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-17 10:34:38.809 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-17 10:34:41.139 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-17 10:34:41.994 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-17 10:34:41.995 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-17 10:34:41.995 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-17 10:34:41.996 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-17 10:34:41.996 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-17 10:34:41.998 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-17 10:34:42.021 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-17 10:34:42.024 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-17 10:34:42.108 | INFO     | app.services.ai_generator:get_device:21 - ✅ Using DirectML device (AMD GPU): privateuseone:0
2025-10-17 10:34:42.108 | INFO     | app.services.ai_generator:__init__:54 - 🎮 DirectML (AMD GPU) mode enabled
2025-10-17 10:34:42.109 | INFO     | app.services.ai_generator:load_model:110 - ⏳ Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-17 10:34:42.109 | INFO     | app.services.ai_generator:load_model:111 - 🖥️ Target device: privateuseone:0
2025-10-17 10:34:42.110 | INFO     | app.services.ai_generator:load_model:116 - Using FP16 precision for GPU
2025-10-17 10:34:52.822 | INFO     | app.services.ai_generator:load_model:136 - 📦 Moving model to privateuseone:0...
2025-10-17 10:34:56.592 | INFO     | app.services.ai_generator:load_model:141 - 🔧 Applying DirectML compatibility fixes...
2025-10-17 10:34:56.794 | INFO     | app.services.ai_generator:load_model:145 - ✅ Text encoder moved to CPU
2025-10-17 10:34:56.794 | INFO     | app.services.ai_generator:load_model:146 - ✅ UNet & VAE remain on DirectML (AMD GPU)
2025-10-17 10:34:56.794 | INFO     | app.services.ai_generator:_patch_pipeline_for_directml:101 - ✅ Pipeline patched for DirectML compatibility
2025-10-17 10:34:56.794 | INFO     | app.services.ai_generator:load_model:155 - 🔧 Applying DirectML (AMD) optimizations...
2025-10-17 10:34:56.800 | INFO     | app.services.ai_generator:load_model:158 - ✅ DirectML optimizations applied
2025-10-17 10:34:56.800 | INFO     | app.services.ai_generator:load_model:185 - ✅ Stable Diffusion model loaded successfully!
2025-10-17 10:34:56.800 | INFO     | app.services.ai_generator:load_model:186 - 📊 Model info: {'model_id': 'runwayml/stable-diffusion-v1-5', 'device': 'DirectML (AMD)', 'device_raw': 'privateuseone:0', 'loaded': True, 'is_directml': True, 'xformers_enabled': False, 'cpu_offload_enabled': False}
2025-10-17 10:34:56.800 | INFO     | tasks.generation_task:generate_personalized_image:147 - 📋 Template Config:
2025-10-17 10:34:56.807 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has base_prompt: True
2025-10-17 10:34:56.807 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Has negative_prompt: True
2025-10-17 10:34:56.808 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Min size: 768x1024
2025-10-17 10:34:56.808 | INFO     | tasks.generation_task:generate_personalized_image:151 -    - Guidance: 7.0, Steps: 35
2025-10-17 10:34:56.809 | INFO     | tasks.generation_task:generate_personalized_image:180 - Original size: 570x600
2025-10-17 10:34:56.809 | INFO     | tasks.generation_task:generate_personalized_image:181 - Generation size (scaled up): 968x1024
2025-10-17 10:34:56.810 | INFO     | app.utils.helpers:create_pose_prompt:163 - 🎯 Using TEMPLATE prompt with isolation: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 10:34:56.810 | INFO     | app.utils.helpers:create_negative_prompt:259 - 🎯 Using TEMPLATE negative prompt
2025-10-17 10:34:56.811 | INFO     | app.services.ai_generator:generate_person:236 - 🎨 Generating male person: sitting, size: 968x1024
2025-10-17 10:34:56.811 | INFO     | app.services.ai_generator:generate_person:237 - ⚙️ Steps: 35, Guidance: 7.0
2025-10-17 10:34:56.812 | INFO     | app.services.ai_generator:generate_person:238 - 📝 Prompt: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 10:34:56.812 | INFO     | app.services.ai_generator:generate_person:239 - 🚫 Negative: extra limbs, duplicate arms, duplicate legs, multiple hands, multiple feet, third arm, third leg, fo...
2025-10-17 10:34:56.812 | INFO     | app.services.ai_generator:generate_person:250 - 🚀 Starting generation...
2025-10-17 10:35:46.269 | ERROR    | app.services.ai_generator:generate_person:274 - ❌ Failed to generate person: tensor.device().type() == at::DeviceType::PrivateUse1 INTERNAL ASSERT FAILED at "C:\\__w\\1\\s\\pytorch-directml-plugin\\torch_directml\\csrc\\dml\\DMLTensor.cpp":31, please report a bug to PyTorch. unbox expects Dml at::Tensor as inputs
2025-10-17 10:35:46.270 | ERROR    | app.services.ai_generator:generate_person:275 - tensor.device().type() == at::DeviceType::PrivateUse1 INTERNAL ASSERT FAILED at "C:\\__w\\1\\s\\pytorch-directml-plugin\\torch_directml\\csrc\\dml\\DMLTensor.cpp":31, please report a bug to PyTorch. unbox expects Dml at::Tensor as inputs
Traceback (most recent call last):

  File "C:\laragon\www\interactive-signage\digital-signage-ai\celery_worker.py", line 49, in <module>
    celery_app.worker_main([
    │          └ <function Celery.worker_main at 0x0000015C7FE0B0A0>
    └ <Celery digital_signage_tasks at 0x15c7f405cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\base.py", line 470, in worker_main
    self.start(argv=argv)
    │    │          └ ['worker', '--loglevel=info', '--concurrency=1', '--pool=solo', '--task-events', '--without-gossip', '--without-mingle']
    │    └ <function Celery.start at 0x0000015C7FE0B010>
    └ <Celery digital_signage_tasks at 0x15c7f405cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\base.py", line 450, in start
    celery.main(args=argv, standalone_mode=False)
    │      │         └ ['worker', '--loglevel=info', '--concurrency=1', '--pool=solo', '--task-events', '--without-gossip', '--without-mingle']
    │      └ <function Command.main at 0x0000015C7FD089D0>
    └ <DYMGroup celery>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1383, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x0000015C329588B0>
         │    └ <function Group.invoke at 0x0000015C7FD09360>
         └ <DYMGroup celery>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1850, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x0000015C32DB2680>
           │               │       │       └ <function Command.invoke at 0x0000015C7FD088B0>
           │               │       └ <CeleryDaemonCommand worker>
           │               └ <click.core.Context object at 0x0000015C32DB2680>
           └ <function Group.invoke.<locals>._process_result at 0x0000015C32DA5BD0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1246, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │   │      │    │           └ <click.core.Context object at 0x0000015C32DB2680>
           │   │      │    └ <function worker at 0x0000015C32DA6950>
           │   │      └ <CeleryDaemonCommand worker>
           │   └ <function Context.invoke at 0x0000015C7FCF3BE0>
           └ <click.core.Context object at 0x0000015C32DB2680>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 814, in invoke
    return callback(*args, **kwargs)
           │         │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │         └ ()
           └ <function worker at 0x0000015C32DA6950>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\decorators.py", line 34, in new_func
    return f(get_current_context(), *args, **kwargs)
           │ │                       │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │ │                       └ ()
           │ └ <function get_current_context at 0x0000015C7FCAB910>
           └ <function worker at 0x0000015C32DA68C0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bin\base.py", line 135, in caller
    return f(ctx, *args, **kwargs)
           │ │     │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │ │     └ ()
           │ └ <click.core.Context object at 0x0000015C32DB2680>
           └ <function worker at 0x0000015C32DA6830>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bin\worker.py", line 356, in worker
    worker.start()
    │      └ <function WorkController.start at 0x0000015C32D06320>
    └ <Worker: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\worker.py", line 203, in start
    self.blueprint.start(self)
    │    │         │     └ <Worker: celery@soulmate-plus (running)>
    │    │         └ <function Blueprint.start at 0x0000015C32CD68C0>
    │    └ <celery.worker.worker.WorkController.Blueprint object at 0x0000015C330744C0>
    └ <Worker: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
    │    │     └ <Worker: celery@soulmate-plus (running)>
    │    └ <function StartStopStep.start at 0x0000015C32CD79A0>
    └ <step: Consumer>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 365, in start
    return self.obj.start()
           │    │   └ <function Consumer.start at 0x0000015C3308EB90>
           │    └ <Consumer: celery@soulmate-plus (running)>
           └ <step: Consumer>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 341, in start
    blueprint.start(self)
    │         │     └ <Consumer: celery@soulmate-plus (running)>
    │         └ <function Blueprint.start at 0x0000015C32CD68C0>
    └ <celery.worker.consumer.consumer.Consumer.Blueprint object at 0x0000015C33058520>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
    │    │     └ <Consumer: celery@soulmate-plus (running)>
    │    └ <function Evloop.start at 0x0000015C3304E440>
    └ <step: event loop>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 772, in start
    c.loop(*c.loop_args())
    │ │     │ └ <function Consumer.loop_args at 0x0000015C3308F010>
    │ │     └ <Consumer: celery@soulmate-plus (running)>
    │ └ <function synloop at 0x0000015C3308E320>
    └ <Consumer: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\loops.py", line 143, in synloop
    _loop_cycle()
    └ <function synloop.<locals>._loop_cycle at 0x0000015C331569E0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\loops.py", line 132, in _loop_cycle
    connection.drain_events(timeout=2.0)
    │          └ <function Connection.drain_events at 0x0000015C7FB42440>
    └ <Connection: redis://localhost:6379/0 at 0x15c331248b0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\connection.py", line 341, in drain_events
    return self.transport.drain_events(self.connection, **kwargs)
           │    │                      │    │             └ {'timeout': 2.0}
           │    │                      │    └ <property object at 0x0000015C7FB52390>
           │    │                      └ <Connection: redis://localhost:6379/0 at 0x15c331248b0>
           │    └ <property object at 0x0000015C7FB52480>
           └ <Connection: redis://localhost:6379/0 at 0x15c331248b0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 997, in drain_events
    get(self._deliver, timeout=timeout)
    │   │    │                 └ 2.0
    │   │    └ <function Transport._deliver at 0x0000015C32E68F70>
    │   └ <kombu.transport.redis.Transport object at 0x0000015C331249D0>
    └ <bound method MultiChannelPoller.get of <kombu.transport.redis.MultiChannelPoller object at 0x0000015C33124AC0>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 598, in get
    ret = self.handle_event(fileno, event)
          │    │            │       └ 1
          │    │            └ 2568
          │    └ <function MultiChannelPoller.handle_event at 0x0000015C330713F0>
          └ <kombu.transport.redis.MultiChannelPoller object at 0x0000015C33124AC0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 580, in handle_event
    return self.on_readable(fileno), self
           │    │           │        └ <kombu.transport.redis.MultiChannelPoller object at 0x0000015C33124AC0>
           │    │           └ 2568
           │    └ <function MultiChannelPoller.on_readable at 0x0000015C33071360>
           └ <kombu.transport.redis.MultiChannelPoller object at 0x0000015C33124AC0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 576, in on_readable
    chan.handlers[type]()
    │    │        └ 'BRPOP'
    │    └ {'BRPOP': <bound method Channel._brpop_read of <kombu.transport.redis.Channel object at 0x0000015C33124A60>>, 'LISTEN': <boun...
    └ <kombu.transport.redis.Channel object at 0x0000015C33124A60>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 986, in _brpop_read
    self.connection._deliver(loads(bytes_to_str(item)), dest)
    │    │          │        │     │            │       └ 'celery'
    │    │          │        │     │            └ b'{"body": "W1tdLCB7ImdlbmVyYXRpb25faWQiOiAiMDE5OWYwM2ItYjFjZS03MWY4LWJhNzMtZDc0OWM0NzVhMmYxIiwgImZhY2VfaW1hZ2VfcGF0aCI6ICIuL...
    │    │          │        │     └ <function bytes_to_str at 0x0000015C7FAE1B40>
    │    │          │        └ <function loads at 0x0000015C7FB627A0>
    │    │          └ <function Transport._deliver at 0x0000015C32E68F70>
    │    └ <kombu.transport.redis.Transport object at 0x0000015C331249D0>
    └ <kombu.transport.redis.Channel object at 0x0000015C33124A60>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 1017, in _deliver
    callback(message)
    │        └ {'body': 'W1tdLCB7ImdlbmVyYXRpb25faWQiOiAiMDE5OWYwM2ItYjFjZS03MWY4LWJhNzMtZDc0OWM0NzVhMmYxIiwgImZhY2VfaW1hZ2VfcGF0aCI6ICIuL3R...
    └ <function Channel.basic_consume.<locals>._callback at 0x0000015C33156950>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 639, in _callback
    return callback(message)
           │        └ <Message object at 0x15c33156a70 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': 'ee54...
           └ <bound method Consumer._receive_callback of <Consumer: [<Queue celery -> <Exchange celery(direct) bound to chan:1> -> celery ...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\messaging.py", line 668, in _receive_callback
    return on_m(message) if on_m else self.receive(decoded, message)
           │    │           │         │    │       │        └ <Message object at 0x15c33156a70 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': 'ee54...
           │    │           │         │    │       └ None
           │    │           │         │    └ <function Consumer.receive at 0x0000015C7FD85C60>
           │    │           │         └ <Consumer: [<Queue celery -> <Exchange celery(direct) bound to chan:1> -> celery bound to chan:1>]>
           │    │           └ <function Consumer.create_task_handler.<locals>.on_task_received at 0x0000015C331568C0>
           │    └ <Message object at 0x15c33156a70 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': 'ee54...
           └ <function Consumer.create_task_handler.<locals>.on_task_received at 0x0000015C331568C0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 688, in on_task_received
    strategy(
    └ <function default.<locals>.task_message_handler at 0x0000015C33155AB0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\strategy.py", line 207, in task_message_handler
    handle(req)
    │      └ <Request: tasks.generate_personalized_image[cd7d8460-56e3-438e-8af0-030ed96ca3ec] () {'generation_id': '0199f03b-b1ce-71f8-ba...
    └ <bound method WorkController._process_task of <Worker: celery@soulmate-plus (running)>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\worker.py", line 226, in _process_task
    req.execute_using_pool(self.pool)
    │   │                  │    └ <celery.concurrency.solo.TaskPool object at 0x0000015C33075990>
    │   │                  └ <Worker: celery@soulmate-plus (running)>
    │   └ <function create_request_cls.<locals>.Request.execute_using_pool at 0x0000015C33155B40>
    └ <Request: tasks.generate_personalized_image[cd7d8460-56e3-438e-8af0-030ed96ca3ec] () {'generation_id': '0199f03b-b1ce-71f8-ba...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\request.py", line 754, in execute_using_pool
    result = apply_async(
             └ <bound method BasePool.apply_async of <celery.concurrency.solo.TaskPool object at 0x0000015C33075990>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\concurrency\base.py", line 153, in apply_async
    return self.on_apply(target, args, kwargs,
           │    │        │       │     └ {}
           │    │        │       └ ('tasks.generate_personalized_image', 'cd7d8460-56e3-438e-8af0-030ed96ca3ec', {'lang': 'py', 'task': 'tasks.generate_personal...
           │    │        └ <function fast_trace_task at 0x0000015C32D3A320>
           │    └ <function apply_target at 0x0000015C32D3A5F0>
           └ <celery.concurrency.solo.TaskPool object at 0x0000015C33075990>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\concurrency\base.py", line 30, in apply_target
    ret = target(*args, **kwargs)
          │       │       └ {}
          │       └ ('tasks.generate_personalized_image', 'cd7d8460-56e3-438e-8af0-030ed96ca3ec', {'lang': 'py', 'task': 'tasks.generate_personal...
          └ <function fast_trace_task at 0x0000015C32D3A320>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 651, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
                    │     └ 'tasks.generate_personalized_image'
                    └ {'celery.chunks': <@task: celery.chunks of digital_signage_tasks at 0x15c7f405cc0>, 'celery.chord_unlock': <@task: celery.cho...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 453, in trace_task
    R = retval = fun(*args, **kwargs)
                 │    │       └ {'generation_id': '0199f03b-b1ce-71f8-ba73-d749c475a2f1', 'face_image_path': './temp\\0199f03b-b1ce-71f8-ba73-d749c475a2f1_fa...
                 │    └ []
                 └ <@task: tasks.generate_personalized_image of digital_signage_tasks at 0x15c7f405cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 736, in __protected_call__
    return self.run(*args, **kwargs)
           │    │    │       └ {'generation_id': '0199f03b-b1ce-71f8-ba73-d749c475a2f1', 'face_image_path': './temp\\0199f03b-b1ce-71f8-ba73-d749c475a2f1_fa...
           │    │    └ ()
           │    └ <function generate_personalized_image at 0x0000015C32949120>
           └ <@task: tasks.generate_personalized_image of digital_signage_tasks at 0x15c7f405cc0>

  File "C:\laragon\www\interactive-signage\digital-signage-ai\tasks\generation_task.py", line 184, in generate_personalized_image
    person_image = generator.generate_person(
                   │         └ <function AIGenerator.generate_person at 0x0000015C2D4A55A0>
                   └ <app.services.ai_generator.AIGenerator object at 0x0000015C3316A410>

> File "C:\laragon\www\interactive-signage\digital-signage-ai\app\services\ai_generator.py", line 255, in generate_person
    result = self.pipe(
             │    └ StableDiffusionPipeline {
             │        "_class_name": "StableDiffusionPipeline",
             │        "_diffusers_version": "0.21.4",
             │        "_name_or_path": "r...
             └ <app.services.ai_generator.AIGenerator object at 0x0000015C3316A410>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           │     │       └ {'prompt': 'professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothi...
           │     └ (StableDiffusionPipeline {
           │         "_class_name": "StableDiffusionPipeline",
           │         "_diffusers_version": "0.21.4",
           │         "_name_or_path": "...
           └ <function StableDiffusionPipeline.__call__ at 0x0000015C2D4A4790>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\pipelines\stable_diffusion\pipeline_stable_diffusion.py", line 680, in __call__
    noise_pred = self.unet(
                 │    └ UNet2DConditionModel(
                 │        (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
                 │        (time_proj): Timesteps...
                 └ StableDiffusionPipeline {
                     "_class_name": "StableDiffusionPipeline",
                     "_diffusers_version": "0.21.4",
                     "_name_or_path": "r...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'encoder_hidden_states': tensor([[[-0.3884,  0.0229, -0.0523,  ..., -0.4902, -0.3066,  0.0674],
           │    │           │                  [ 0.8726, -0.1622, ...
           │    │           └ (tensor([[[[ 0.4243,  2.7832, -1.3701,  ...,  0.7935,  1.3096, -0.0934],
           │    │                       [ 0.0784, -0.1097, -0.3721,  ...,  0.5508,...
           │    └ <function Module._call_impl at 0x0000015C261231C0>
           └ UNet2DConditionModel(
               (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
               (time_proj): Timesteps...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'encoder_hidden_states': tensor([[[-0.3884,  0.0229, -0.0523,  ..., -0.4902, -0.3066,  0.0674],
           │             │                  [ 0.8726, -0.1622, ...
           │             └ (tensor([[[[ 0.4243,  2.7832, -1.3701,  ...,  0.7935,  1.3096, -0.0934],
           │                         [ 0.0784, -0.1097, -0.3721,  ...,  0.5508,...
           └ <bound method UNet2DConditionModel.forward of UNet2DConditionModel(
               (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\unet_2d_condition.py", line 958, in forward
    sample, res_samples = downsample_block(
    │                     └ CrossAttnDownBlock2D(
    │                         (attentions): ModuleList(
    │                           (0-1): 2 x Transformer2DModel(
    │                             (norm): GroupNorm(32, 320, eps=1e-...
    └ tensor([[[[ 1.4417e-01, -9.4482e-01,  6.2943e-03,  ..., -4.9316e-01,
                 -4.0356e-01,  2.7856e-01],
                [ 3.7109...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'hidden_states': tensor([[[[ 1.4417e-01, -9.4482e-01,  6.2943e-03,  ..., -4.9316e-01,
           │    │           │                    -4.0356e-01,  2.7856e-01],
           │    │           │         ...
           │    │           └ ()
           │    └ <function Module._call_impl at 0x0000015C261231C0>
           └ CrossAttnDownBlock2D(
               (attentions): ModuleList(
                 (0-1): 2 x Transformer2DModel(
                   (norm): GroupNorm(32, 320, eps=1e-...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'hidden_states': tensor([[[[ 1.4417e-01, -9.4482e-01,  6.2943e-03,  ..., -4.9316e-01,
           │             │                    -4.0356e-01,  2.7856e-01],
           │             │         ...
           │             └ ()
           └ <bound method CrossAttnDownBlock2D.forward of CrossAttnDownBlock2D(
               (attentions): ModuleList(
                 (0-1): 2 x Transformer2DM...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\unet_2d_blocks.py", line 1086, in forward
    hidden_states = attn(
                    └ Transformer2DModel(
                        (norm): GroupNorm(32, 320, eps=1e-06, affine=True)
                        (proj_in): LoRACompatibleConv(320, 320, kernel_siz...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'encoder_hidden_states': tensor([[[-0.3884,  0.0229, -0.0523,  ..., -0.4902, -0.3066,  0.0674],
           │    │           │                  [ 0.8726, -0.1622, ...
           │    │           └ (tensor([[[[ 0.7334, -0.2559,  0.7744,  ...,  0.2051,  0.4314,  1.0068],
           │    │                       [ 0.9971,  0.6807,  0.5576,  ...,  1.0391,...
           │    └ <function Module._call_impl at 0x0000015C261231C0>
           └ Transformer2DModel(
               (norm): GroupNorm(32, 320, eps=1e-06, affine=True)
               (proj_in): LoRACompatibleConv(320, 320, kernel_siz...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'encoder_hidden_states': tensor([[[-0.3884,  0.0229, -0.0523,  ..., -0.4902, -0.3066,  0.0674],
           │             │                  [ 0.8726, -0.1622, ...
           │             └ (tensor([[[[ 0.7334, -0.2559,  0.7744,  ...,  0.2051,  0.4314,  1.0068],
           │                         [ 0.9971,  0.6807,  0.5576,  ...,  1.0391,...
           └ <bound method Transformer2DModel.forward of Transformer2DModel(
               (norm): GroupNorm(32, 320, eps=1e-06, affine=True)
               (proj_...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\transformer_2d.py", line 315, in forward
    hidden_states = block(
                    └ BasicTransformerBlock(
                        (norm1): LayerNorm((320,), eps=1e-05, elementwise_affine=True)
                        (attn1): Attention(
                          (to_q): LoR...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'attention_mask': None, 'encoder_hidden_states': tensor([[[-0.3884,  0.0229, -0.0523,  ..., -0.4902, -0.3066,  0.0674],
           │    │           │             ...
           │    │           └ (tensor([[[-0.0634,  0.1156, -0.0953,  ..., -0.0936,  0.1422,  0.1176],
           │    │                      [ 0.1152,  0.1263,  0.0167,  ...,  0.0826,  ...
           │    └ <function Module._call_impl at 0x0000015C261231C0>
           └ BasicTransformerBlock(
               (norm1): LayerNorm((320,), eps=1e-05, elementwise_affine=True)
               (attn1): Attention(
                 (to_q): LoR...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'attention_mask': None, 'encoder_hidden_states': tensor([[[-0.3884,  0.0229, -0.0523,  ..., -0.4902, -0.3066,  0.0674],
           │             │             ...
           │             └ (tensor([[[-0.0634,  0.1156, -0.0953,  ..., -0.0936,  0.1422,  0.1176],
           │                        [ 0.1152,  0.1263,  0.0167,  ...,  0.0826,  ...
           └ <bound method BasicTransformerBlock.forward of BasicTransformerBlock(
               (norm1): LayerNorm((320,), eps=1e-05, elementwise_aff...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\attention.py", line 218, in forward
    attn_output = self.attn2(
                  └ BasicTransformerBlock(
                      (norm1): LayerNorm((320,), eps=1e-05, elementwise_affine=True)
                      (attn1): Attention(
                        (to_q): LoR...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'encoder_hidden_states': tensor([[[-0.3884,  0.0229, -0.0523,  ..., -0.4902, -0.3066,  0.0674],
           │    │           │                  [ 0.8726, -0.1622, ...
           │    │           └ (tensor([[[-0.0482,  0.0438, -0.3066,  ..., -0.5010,  0.3035,  0.4402],
           │    │                      [ 0.1987, -0.0367, -0.1205,  ..., -0.3335,  ...
           │    └ <function Module._call_impl at 0x0000015C261231C0>
           └ Attention(
               (to_q): LoRACompatibleLinear(in_features=320, out_features=320, bias=False)
               (to_k): LoRACompatibleLinear(in_fe...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'encoder_hidden_states': tensor([[[-0.3884,  0.0229, -0.0523,  ..., -0.4902, -0.3066,  0.0674],
           │             │                  [ 0.8726, -0.1622, ...
           │             └ (tensor([[[-0.0482,  0.0438, -0.3066,  ..., -0.5010,  0.3035,  0.4402],
           │                        [ 0.1987, -0.0367, -0.1205,  ..., -0.3335,  ...
           └ <bound method Attention.forward of Attention(
               (to_q): LoRACompatibleLinear(in_features=320, out_features=320, bias=False)
              ...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\attention_processor.py", line 417, in forward
    return self.processor(
           │    └ <diffusers.models.attention_processor.SlicedAttnProcessor object at 0x0000015C3DEAFF40>
           └ Attention(
               (to_q): LoRACompatibleLinear(in_features=320, out_features=320, bias=False)
               (to_k): LoRACompatibleLinear(in_fe...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\attention_processor.py", line 1207, in __call__
    key = attn.to_k(encoder_hidden_states)
          │         └ tensor([[[-0.3884,  0.0229, -0.0523,  ..., -0.4902, -0.3066,  0.0674],
          │                    [ 0.8726, -0.1622, -1.5059,  ..., -0.3411,  0...
          └ Attention(
              (to_q): LoRACompatibleLinear(in_features=320, out_features=320, bias=False)
              (to_k): LoRACompatibleLinear(in_fe...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {}
           │    │           └ (tensor([[[-0.3884,  0.0229, -0.0523,  ..., -0.4902, -0.3066,  0.0674],
           │    │                      [ 0.8726, -0.1622, -1.5059,  ..., -0.3411,  ...
           │    └ <function Module._call_impl at 0x0000015C261231C0>
           └ LoRACompatibleLinear(in_features=768, out_features=320, bias=False)

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {}
           │             └ (tensor([[[-0.3884,  0.0229, -0.0523,  ..., -0.4902, -0.3066,  0.0674],
           │                        [ 0.8726, -0.1622, -1.5059,  ..., -0.3411,  ...
           └ <bound method LoRACompatibleLinear.forward of LoRACompatibleLinear(in_features=768, out_features=320, bias=False)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\lora.py", line 224, in forward
    out = super().forward(hidden_states)
                          └ tensor([[[-0.3884,  0.0229, -0.0523,  ..., -0.4902, -0.3066,  0.0674],
                                     [ 0.8726, -0.1622, -1.5059,  ..., -0.3411,  0...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\linear.py", line 117, in forward
    return F.linear(input, self.weight, self.bias)
           │ │      │      │            └ LoRACompatibleLinear(in_features=768, out_features=320, bias=False)
           │ │      │      └ LoRACompatibleLinear(in_features=768, out_features=320, bias=False)
           │ │      └ tensor([[[-0.3884,  0.0229, -0.0523,  ..., -0.4902, -0.3066,  0.0674],
           │ │                 [ 0.8726, -0.1622, -1.5059,  ..., -0.3411,  0...
           │ └ <built-in function linear>
           └ <module 'torch.nn.functional' from 'C:\\laragon\\bin\\python\\python-3.10\\lib\\site-packages\\torch\\nn\\functional.py'>

RuntimeError: tensor.device().type() == at::DeviceType::PrivateUse1 INTERNAL ASSERT FAILED at "C:\\__w\\1\\s\\pytorch-directml-plugin\\torch_directml\\csrc\\dml\\DMLTensor.cpp":31, please report a bug to PyTorch. unbox expects Dml at::Tensor as inputs
2025-10-17 10:35:56.080 | ERROR    | tasks.generation_task:generate_personalized_image:316 - ❌ Generation failed for 0199f03b-b1ce-71f8-ba73-d749c475a2f1: Failed to generate person image
2025-10-17 10:35:57.664 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f03b-b1ce-71f8-ba73-d749c475a2f1/failed
2025-10-17 10:35:57.678 | ERROR    | tasks.generation_task:on_failure:47 - Task cd7d8460-56e3-438e-8af0-030ed96ca3ec failed: Failed to generate person image
2025-10-17 10:35:58.396 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f03b-b1ce-71f8-ba73-d749c475a2f1/failed
2025-10-17 10:37:58.349 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-17 10:38:27.791 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199f03f-37c2-70cf-bef3-2b58e8cd57a1
2025-10-17 10:38:27.792 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-17 10:38:27.864 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-17 10:38:30.069 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-17 10:38:33.373 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-17 10:38:34.187 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-17 10:38:34.188 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-17 10:38:34.189 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-17 10:38:34.190 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-17 10:38:34.190 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-17 10:38:34.192 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-17 10:38:34.218 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-17 10:38:34.220 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-17 10:38:34.363 | INFO     | app.services.ai_generator:get_device:21 - ✅ Using DirectML device (AMD GPU): privateuseone:0
2025-10-17 10:38:34.364 | INFO     | app.services.ai_generator:__init__:54 - 🎮 DirectML (AMD GPU) mode enabled
2025-10-17 10:38:34.365 | INFO     | app.services.ai_generator:load_model:122 - ⏳ Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-17 10:38:34.365 | INFO     | app.services.ai_generator:load_model:123 - 🖥️ Target device: privateuseone:0
2025-10-17 10:38:34.366 | INFO     | app.services.ai_generator:load_model:128 - Using FP16 precision for GPU
2025-10-17 10:38:45.146 | INFO     | app.services.ai_generator:load_model:148 - 📦 Moving model to privateuseone:0...
2025-10-17 10:38:49.363 | INFO     | app.services.ai_generator:load_model:153 - 🔧 Applying DirectML compatibility fixes...
2025-10-17 10:38:49.546 | INFO     | app.services.ai_generator:load_model:157 - ✅ Text encoder moved to CPU
2025-10-17 10:38:49.546 | INFO     | app.services.ai_generator:load_model:158 - ✅ UNet & VAE remain on DirectML (AMD GPU)
2025-10-17 10:38:49.547 | INFO     | app.services.ai_generator:_patch_pipeline_for_directml:113 - ✅ Pipeline patched for DirectML compatibility
2025-10-17 10:38:49.547 | INFO     | app.services.ai_generator:load_model:167 - 🔧 Applying DirectML (AMD) optimizations...
2025-10-17 10:38:49.554 | INFO     | app.services.ai_generator:load_model:170 - ✅ DirectML optimizations applied
2025-10-17 10:38:49.554 | INFO     | app.services.ai_generator:load_model:197 - ✅ Stable Diffusion model loaded successfully!
2025-10-17 10:38:49.555 | INFO     | app.services.ai_generator:load_model:198 - 📊 Model info: {'model_id': 'runwayml/stable-diffusion-v1-5', 'device': 'DirectML (AMD)', 'device_raw': 'privateuseone:0', 'loaded': True, 'is_directml': True, 'xformers_enabled': False, 'cpu_offload_enabled': False}
2025-10-17 10:38:49.556 | INFO     | tasks.generation_task:generate_personalized_image:147 - 📋 Template Config:
2025-10-17 10:38:49.556 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has base_prompt: True
2025-10-17 10:38:49.557 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Has negative_prompt: True
2025-10-17 10:38:49.557 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Min size: 768x1024
2025-10-17 10:38:49.557 | INFO     | tasks.generation_task:generate_personalized_image:151 -    - Guidance: 7.0, Steps: 35
2025-10-17 10:38:49.558 | INFO     | tasks.generation_task:generate_personalized_image:180 - Original size: 570x600
2025-10-17 10:38:49.558 | INFO     | tasks.generation_task:generate_personalized_image:181 - Generation size (scaled up): 968x1024
2025-10-17 10:38:49.558 | INFO     | app.utils.helpers:create_pose_prompt:163 - 🎯 Using TEMPLATE prompt with isolation: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 10:38:49.559 | INFO     | app.utils.helpers:create_negative_prompt:259 - 🎯 Using TEMPLATE negative prompt
2025-10-17 10:38:49.559 | INFO     | app.services.ai_generator:generate_person:248 - 🎨 Generating male person: sitting, size: 968x1024
2025-10-17 10:38:49.559 | INFO     | app.services.ai_generator:generate_person:249 - ⚙️ Steps: 35, Guidance: 7.0
2025-10-17 10:38:49.560 | INFO     | app.services.ai_generator:generate_person:250 - 📝 Prompt: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 10:38:49.560 | INFO     | app.services.ai_generator:generate_person:251 - 🚫 Negative: extra limbs, duplicate arms, duplicate legs, multiple hands, multiple feet, third arm, third leg, fo...
2025-10-17 10:38:49.560 | INFO     | app.services.ai_generator:generate_person:262 - 🚀 Starting generation...
2025-10-17 10:40:04.164 | ERROR    | app.services.ai_generator:generate_person:286 - ❌ Failed to generate person: unknown error
2025-10-17 10:40:04.169 | ERROR    | app.services.ai_generator:generate_person:287 - unknown error
Traceback (most recent call last):

  File "C:\laragon\www\interactive-signage\digital-signage-ai\celery_worker.py", line 49, in <module>
    celery_app.worker_main([
    │          └ <function Celery.worker_main at 0x000001C8B438B0A0>
    └ <Celery digital_signage_tasks at 0x1c8b39b5cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\base.py", line 470, in worker_main
    self.start(argv=argv)
    │    │          └ ['worker', '--loglevel=info', '--concurrency=1', '--pool=solo', '--task-events', '--without-gossip', '--without-mingle']
    │    └ <function Celery.start at 0x000001C8B438B010>
    └ <Celery digital_signage_tasks at 0x1c8b39b5cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\base.py", line 450, in start
    celery.main(args=argv, standalone_mode=False)
    │      │         └ ['worker', '--loglevel=info', '--concurrency=1', '--pool=solo', '--task-events', '--without-gossip', '--without-mingle']
    │      └ <function Command.main at 0x000001C8B42889D0>
    └ <DYMGroup celery>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1383, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x000001C8E6E38880>
         │    └ <function Group.invoke at 0x000001C8B4289360>
         └ <DYMGroup celery>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1850, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x000001C8E7292650>
           │               │       │       └ <function Command.invoke at 0x000001C8B42888B0>
           │               │       └ <CeleryDaemonCommand worker>
           │               └ <click.core.Context object at 0x000001C8E7292650>
           └ <function Group.invoke.<locals>._process_result at 0x000001C8E7285BD0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1246, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │   │      │    │           └ <click.core.Context object at 0x000001C8E7292650>
           │   │      │    └ <function worker at 0x000001C8E7286950>
           │   │      └ <CeleryDaemonCommand worker>
           │   └ <function Context.invoke at 0x000001C8B4273BE0>
           └ <click.core.Context object at 0x000001C8E7292650>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 814, in invoke
    return callback(*args, **kwargs)
           │         │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │         └ ()
           └ <function worker at 0x000001C8E7286950>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\decorators.py", line 34, in new_func
    return f(get_current_context(), *args, **kwargs)
           │ │                       │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │ │                       └ ()
           │ └ <function get_current_context at 0x000001C8B422B910>
           └ <function worker at 0x000001C8E72868C0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bin\base.py", line 135, in caller
    return f(ctx, *args, **kwargs)
           │ │     │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │ │     └ ()
           │ └ <click.core.Context object at 0x000001C8E7292650>
           └ <function worker at 0x000001C8E7286830>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bin\worker.py", line 356, in worker
    worker.start()
    │      └ <function WorkController.start at 0x000001C8E71E6320>
    └ <Worker: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\worker.py", line 203, in start
    self.blueprint.start(self)
    │    │         │     └ <Worker: celery@soulmate-plus (running)>
    │    │         └ <function Blueprint.start at 0x000001C8E71B68C0>
    │    └ <celery.worker.worker.WorkController.Blueprint object at 0x000001C8E7558490>
    └ <Worker: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
    │    │     └ <Worker: celery@soulmate-plus (running)>
    │    └ <function StartStopStep.start at 0x000001C8E71B79A0>
    └ <step: Consumer>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 365, in start
    return self.obj.start()
           │    │   └ <function Consumer.start at 0x000001C8E756EB90>
           │    └ <Consumer: celery@soulmate-plus (running)>
           └ <step: Consumer>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 341, in start
    blueprint.start(self)
    │         │     └ <Consumer: celery@soulmate-plus (running)>
    │         └ <function Blueprint.start at 0x000001C8E71B68C0>
    └ <celery.worker.consumer.consumer.Consumer.Blueprint object at 0x000001C8E75384F0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
    │    │     └ <Consumer: celery@soulmate-plus (running)>
    │    └ <function Evloop.start at 0x000001C8E7532440>
    └ <step: event loop>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 772, in start
    c.loop(*c.loop_args())
    │ │     │ └ <function Consumer.loop_args at 0x000001C8E756F010>
    │ │     └ <Consumer: celery@soulmate-plus (running)>
    │ └ <function synloop at 0x000001C8E756E320>
    └ <Consumer: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\loops.py", line 143, in synloop
    _loop_cycle()
    └ <function synloop.<locals>._loop_cycle at 0x000001C8E7636830>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\loops.py", line 132, in _loop_cycle
    connection.drain_events(timeout=2.0)
    │          └ <function Connection.drain_events at 0x000001C8B40D2440>
    └ <Connection: redis://localhost:6379/0 at 0x1c8e76048b0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\connection.py", line 341, in drain_events
    return self.transport.drain_events(self.connection, **kwargs)
           │    │                      │    │             └ {'timeout': 2.0}
           │    │                      │    └ <property object at 0x000001C8B40E2390>
           │    │                      └ <Connection: redis://localhost:6379/0 at 0x1c8e76048b0>
           │    └ <property object at 0x000001C8B40E2480>
           └ <Connection: redis://localhost:6379/0 at 0x1c8e76048b0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 997, in drain_events
    get(self._deliver, timeout=timeout)
    │   │    │                 └ 2.0
    │   │    └ <function Transport._deliver at 0x000001C8E7348F70>
    │   └ <kombu.transport.redis.Transport object at 0x000001C8E76049D0>
    └ <bound method MultiChannelPoller.get of <kombu.transport.redis.MultiChannelPoller object at 0x000001C8E7604AC0>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 598, in get
    ret = self.handle_event(fileno, event)
          │    │            │       └ 1
          │    │            └ 3624
          │    └ <function MultiChannelPoller.handle_event at 0x000001C8E75553F0>
          └ <kombu.transport.redis.MultiChannelPoller object at 0x000001C8E7604AC0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 580, in handle_event
    return self.on_readable(fileno), self
           │    │           │        └ <kombu.transport.redis.MultiChannelPoller object at 0x000001C8E7604AC0>
           │    │           └ 3624
           │    └ <function MultiChannelPoller.on_readable at 0x000001C8E7555360>
           └ <kombu.transport.redis.MultiChannelPoller object at 0x000001C8E7604AC0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 576, in on_readable
    chan.handlers[type]()
    │    │        └ 'BRPOP'
    │    └ {'BRPOP': <bound method Channel._brpop_read of <kombu.transport.redis.Channel object at 0x000001C8E7604A60>>, 'LISTEN': <boun...
    └ <kombu.transport.redis.Channel object at 0x000001C8E7604A60>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 986, in _brpop_read
    self.connection._deliver(loads(bytes_to_str(item)), dest)
    │    │          │        │     │            │       └ 'celery'
    │    │          │        │     │            └ b'{"body": "W1tdLCB7ImdlbmVyYXRpb25faWQiOiAiMDE5OWYwM2YtMzdjMi03MGNmLWJlZjMtMmI1OGU4Y2Q1N2ExIiwgImZhY2VfaW1hZ2VfcGF0aCI6ICIuL...
    │    │          │        │     └ <function bytes_to_str at 0x000001C8B4081B40>
    │    │          │        └ <function loads at 0x000001C8B40F27A0>
    │    │          └ <function Transport._deliver at 0x000001C8E7348F70>
    │    └ <kombu.transport.redis.Transport object at 0x000001C8E76049D0>
    └ <kombu.transport.redis.Channel object at 0x000001C8E7604A60>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 1017, in _deliver
    callback(message)
    │        └ {'body': 'W1tdLCB7ImdlbmVyYXRpb25faWQiOiAiMDE5OWYwM2YtMzdjMi03MGNmLWJlZjMtMmI1OGU4Y2Q1N2ExIiwgImZhY2VfaW1hZ2VfcGF0aCI6ICIuL3R...
    └ <function Channel.basic_consume.<locals>._callback at 0x000001C8E76367A0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 639, in _callback
    return callback(message)
           │        └ <Message object at 0x1c8e76368c0 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '4867...
           └ <bound method Consumer._receive_callback of <Consumer: [<Queue celery -> <Exchange celery(direct) bound to chan:1> -> celery ...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\messaging.py", line 668, in _receive_callback
    return on_m(message) if on_m else self.receive(decoded, message)
           │    │           │         │    │       │        └ <Message object at 0x1c8e76368c0 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '4867...
           │    │           │         │    │       └ None
           │    │           │         │    └ <function Consumer.receive at 0x000001C8B4305C60>
           │    │           │         └ <Consumer: [<Queue celery -> <Exchange celery(direct) bound to chan:1> -> celery bound to chan:1>]>
           │    │           └ <function Consumer.create_task_handler.<locals>.on_task_received at 0x000001C8E76363B0>
           │    └ <Message object at 0x1c8e76368c0 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '4867...
           └ <function Consumer.create_task_handler.<locals>.on_task_received at 0x000001C8E76363B0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 688, in on_task_received
    strategy(
    └ <function default.<locals>.task_message_handler at 0x000001C8E7635AB0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\strategy.py", line 207, in task_message_handler
    handle(req)
    │      └ <Request: tasks.generate_personalized_image[2c3f4337-a4ab-4a0f-8b06-ac3c23cd59dc] () {'generation_id': '0199f03f-37c2-70cf-be...
    └ <bound method WorkController._process_task of <Worker: celery@soulmate-plus (running)>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\worker.py", line 226, in _process_task
    req.execute_using_pool(self.pool)
    │   │                  │    └ <celery.concurrency.solo.TaskPool object at 0x000001C8E7559960>
    │   │                  └ <Worker: celery@soulmate-plus (running)>
    │   └ <function create_request_cls.<locals>.Request.execute_using_pool at 0x000001C8E7635B40>
    └ <Request: tasks.generate_personalized_image[2c3f4337-a4ab-4a0f-8b06-ac3c23cd59dc] () {'generation_id': '0199f03f-37c2-70cf-be...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\request.py", line 754, in execute_using_pool
    result = apply_async(
             └ <bound method BasePool.apply_async of <celery.concurrency.solo.TaskPool object at 0x000001C8E7559960>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\concurrency\base.py", line 153, in apply_async
    return self.on_apply(target, args, kwargs,
           │    │        │       │     └ {}
           │    │        │       └ ('tasks.generate_personalized_image', '2c3f4337-a4ab-4a0f-8b06-ac3c23cd59dc', {'lang': 'py', 'task': 'tasks.generate_personal...
           │    │        └ <function fast_trace_task at 0x000001C8E721A320>
           │    └ <function apply_target at 0x000001C8E721A5F0>
           └ <celery.concurrency.solo.TaskPool object at 0x000001C8E7559960>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\concurrency\base.py", line 30, in apply_target
    ret = target(*args, **kwargs)
          │       │       └ {}
          │       └ ('tasks.generate_personalized_image', '2c3f4337-a4ab-4a0f-8b06-ac3c23cd59dc', {'lang': 'py', 'task': 'tasks.generate_personal...
          └ <function fast_trace_task at 0x000001C8E721A320>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 651, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
                    │     └ 'tasks.generate_personalized_image'
                    └ {'celery.chunks': <@task: celery.chunks of digital_signage_tasks at 0x1c8b39b5cc0>, 'celery.chord_unlock': <@task: celery.cho...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 453, in trace_task
    R = retval = fun(*args, **kwargs)
                 │    │       └ {'generation_id': '0199f03f-37c2-70cf-bef3-2b58e8cd57a1', 'face_image_path': './temp\\0199f03f-37c2-70cf-bef3-2b58e8cd57a1_fa...
                 │    └ []
                 └ <@task: tasks.generate_personalized_image of digital_signage_tasks at 0x1c8b39b5cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 736, in __protected_call__
    return self.run(*args, **kwargs)
           │    │    │       └ {'generation_id': '0199f03f-37c2-70cf-bef3-2b58e8cd57a1', 'face_image_path': './temp\\0199f03f-37c2-70cf-bef3-2b58e8cd57a1_fa...
           │    │    └ ()
           │    └ <function generate_personalized_image at 0x000001C8E6E25120>
           └ <@task: tasks.generate_personalized_image of digital_signage_tasks at 0x1c8b39b5cc0>

  File "C:\laragon\www\interactive-signage\digital-signage-ai\tasks\generation_task.py", line 184, in generate_personalized_image
    person_image = generator.generate_person(
                   │         └ <function AIGenerator.generate_person at 0x000001C8E19655A0>
                   └ <app.services.ai_generator.AIGenerator object at 0x000001C8E769B9D0>

> File "C:\laragon\www\interactive-signage\digital-signage-ai\app\services\ai_generator.py", line 267, in generate_person
    result = self.pipe(
             │    └ StableDiffusionPipeline {
             │        "_class_name": "StableDiffusionPipeline",
             │        "_diffusers_version": "0.21.4",
             │        "_name_or_path": "r...
             └ <app.services.ai_generator.AIGenerator object at 0x000001C8E769B9D0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           │     │       └ {'prompt': 'professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothi...
           │     └ (StableDiffusionPipeline {
           │         "_class_name": "StableDiffusionPipeline",
           │         "_diffusers_version": "0.21.4",
           │         "_name_or_path": "...
           └ <function StableDiffusionPipeline.__call__ at 0x000001C8E1964790>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\pipelines\stable_diffusion\pipeline_stable_diffusion.py", line 680, in __call__
    noise_pred = self.unet(
                 │    └ UNet2DConditionModel(
                 │        (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
                 │        (time_proj): Timesteps...
                 └ StableDiffusionPipeline {
                     "_class_name": "StableDiffusionPipeline",
                     "_diffusers_version": "0.21.4",
                     "_name_or_path": "r...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ <unprintable dict object>
           │    │           └ <unprintable tuple object>
           │    └ <function Module._call_impl at 0x000001C8DA5DB1C0>
           └ UNet2DConditionModel(
               (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
               (time_proj): Timesteps...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ <unprintable dict object>
           │             └ <unprintable tuple object>
           └ <bound method UNet2DConditionModel.forward of UNet2DConditionModel(
               (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\unet_2d_condition.py", line 1020, in forward
    sample = upsample_block(
             └ CrossAttnUpBlock2D(
                 (attentions): ModuleList(
                   (0-2): 3 x Transformer2DModel(
                     (norm): GroupNorm(32, 640, eps=1e-06...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ <unprintable dict object>
           │    │           └ ()
           │    └ <function Module._call_impl at 0x000001C8DA5DB1C0>
           └ CrossAttnUpBlock2D(
               (attentions): ModuleList(
                 (0-2): 3 x Transformer2DModel(
                   (norm): GroupNorm(32, 640, eps=1e-06...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ <unprintable dict object>
           │             └ ()
           └ <bound method CrossAttnUpBlock2D.forward of CrossAttnUpBlock2D(
               (attentions): ModuleList(
                 (0-2): 3 x Transformer2DModel...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\unet_2d_blocks.py", line 2228, in forward
    hidden_states = attn(
                    └ Transformer2DModel(
                        (norm): GroupNorm(32, 640, eps=1e-06, affine=True)
                        (proj_in): LoRACompatibleConv(640, 640, kernel_siz...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ <unprintable dict object>
           │    │           └ <unprintable tuple object>
           │    └ <function Module._call_impl at 0x000001C8DA5DB1C0>
           └ Transformer2DModel(
               (norm): GroupNorm(32, 640, eps=1e-06, affine=True)
               (proj_in): LoRACompatibleConv(640, 640, kernel_siz...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ <unprintable dict object>
           │             └ <unprintable tuple object>
           └ <bound method Transformer2DModel.forward of Transformer2DModel(
               (norm): GroupNorm(32, 640, eps=1e-06, affine=True)
               (proj_...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\transformer_2d.py", line 315, in forward
    hidden_states = block(
                    └ BasicTransformerBlock(
                        (norm1): LayerNorm((640,), eps=1e-05, elementwise_affine=True)
                        (attn1): Attention(
                          (to_q): LoR...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ <unprintable dict object>
           │    │           └ <unprintable tuple object>
           │    └ <function Module._call_impl at 0x000001C8DA5DB1C0>
           └ BasicTransformerBlock(
               (norm1): LayerNorm((640,), eps=1e-05, elementwise_affine=True)
               (attn1): Attention(
                 (to_q): LoR...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ <unprintable dict object>
           │             └ <unprintable tuple object>
           └ <bound method BasicTransformerBlock.forward of BasicTransformerBlock(
               (norm1): LayerNorm((640,), eps=1e-05, elementwise_aff...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\attention.py", line 197, in forward
    attn_output = self.attn1(
                  └ BasicTransformerBlock(
                      (norm1): LayerNorm((640,), eps=1e-05, elementwise_affine=True)
                      (attn1): Attention(
                        (to_q): LoR...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'encoder_hidden_states': None, 'attention_mask': None}
           │    │           └ <unprintable tuple object>
           │    └ <function Module._call_impl at 0x000001C8DA5DB1C0>
           └ Attention(
               (to_q): LoRACompatibleLinear(in_features=640, out_features=640, bias=False)
               (to_k): LoRACompatibleLinear(in_fe...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'encoder_hidden_states': None, 'attention_mask': None}
           │             └ <unprintable tuple object>
           └ <bound method Attention.forward of Attention(
               (to_q): LoRACompatibleLinear(in_features=640, out_features=640, bias=False)
              ...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\attention_processor.py", line 417, in forward
    return self.processor(
           │    └ <diffusers.models.attention_processor.SlicedAttnProcessor object at 0x000001C88FE36230>
           └ Attention(
               (to_q): LoRACompatibleLinear(in_features=640, out_features=640, bias=False)
               (to_k): LoRACompatibleLinear(in_fe...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\attention_processor.py", line 1227, in __call__
    attn_slice = torch.bmm(attn_slice, value[start_idx:end_idx])
                 │     │   │           │     │         └ 5
                 │     │   │           │     └ 4
                 │     │   │           └ <unprintable Tensor object>
                 │     │   └ <unprintable Tensor object>
                 │     └ <built-in method bmm of type object at 0x00007FFA8530DE80>
                 └ <module 'torch' from 'C:\\laragon\\bin\\python\\python-3.10\\lib\\site-packages\\torch\\__init__.py'>

RuntimeError: unknown error
2025-10-17 10:40:04.405 | ERROR    | tasks.generation_task:generate_personalized_image:316 - ❌ Generation failed for 0199f03f-37c2-70cf-bef3-2b58e8cd57a1: Failed to generate person image
2025-10-17 10:40:05.682 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f03f-37c2-70cf-bef3-2b58e8cd57a1/failed
2025-10-17 10:40:05.697 | ERROR    | tasks.generation_task:on_failure:47 - Task 2c3f4337-a4ab-4a0f-8b06-ac3c23cd59dc failed: Failed to generate person image
2025-10-17 10:40:06.437 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f03f-37c2-70cf-bef3-2b58e8cd57a1/failed
2025-10-17 10:43:35.265 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-17 10:44:02.238 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199f044-526d-71c7-8558-84ba9b6f184e
2025-10-17 10:44:02.238 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-17 10:44:02.303 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-17 10:44:04.377 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-17 10:44:06.986 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-17 10:44:07.846 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-17 10:44:07.846 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-17 10:44:07.846 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-17 10:44:07.846 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-17 10:44:07.846 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-17 10:44:07.846 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-17 10:44:07.898 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-17 10:44:07.900 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-17 10:44:08.079 | INFO     | app.services.ai_generator:get_device:21 - ✅ Using DirectML device (AMD GPU): privateuseone:0
2025-10-17 10:44:08.079 | INFO     | app.services.ai_generator:__init__:54 - 🎮 DirectML (AMD GPU) mode enabled
2025-10-17 10:44:08.079 | INFO     | app.services.ai_generator:load_model:122 - ⏳ Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-17 10:44:08.080 | INFO     | app.services.ai_generator:load_model:123 - 🖥️ Target device: privateuseone:0
2025-10-17 10:44:08.080 | INFO     | app.services.ai_generator:load_model:128 - Using FP16 precision for GPU
2025-10-17 10:44:10.830 | INFO     | app.services.ai_generator:load_model:148 - 📦 Moving model to privateuseone:0...
2025-10-17 10:44:28.693 | INFO     | app.services.ai_generator:load_model:153 - 🔧 Applying DirectML compatibility fixes...
2025-10-17 10:44:29.128 | INFO     | app.services.ai_generator:load_model:157 - ✅ Text encoder moved to CPU
2025-10-17 10:44:29.128 | INFO     | app.services.ai_generator:load_model:158 - ✅ UNet & VAE remain on DirectML (AMD GPU)
2025-10-17 10:44:29.129 | INFO     | app.services.ai_generator:_patch_pipeline_for_directml:113 - ✅ Pipeline patched for DirectML compatibility
2025-10-17 10:44:29.129 | INFO     | app.services.ai_generator:load_model:167 - 🔧 Applying DirectML (AMD) optimizations...
2025-10-17 10:44:29.129 | INFO     | app.services.ai_generator:load_model:170 - ✅ DirectML optimizations applied
2025-10-17 10:44:29.129 | INFO     | app.services.ai_generator:load_model:197 - ✅ Stable Diffusion model loaded successfully!
2025-10-17 10:44:29.131 | INFO     | app.services.ai_generator:load_model:198 - 📊 Model info: {'model_id': 'runwayml/stable-diffusion-v1-5', 'device': 'DirectML (AMD)', 'device_raw': 'privateuseone:0', 'loaded': True, 'is_directml': True, 'xformers_enabled': False, 'cpu_offload_enabled': False}
2025-10-17 10:44:29.132 | INFO     | tasks.generation_task:generate_personalized_image:147 - 📋 Template Config:
2025-10-17 10:44:29.132 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has base_prompt: True
2025-10-17 10:44:29.132 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Has negative_prompt: True
2025-10-17 10:44:29.132 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Min size: 768x1024
2025-10-17 10:44:29.133 | INFO     | tasks.generation_task:generate_personalized_image:151 -    - Guidance: 7.0, Steps: 35
2025-10-17 10:44:29.133 | INFO     | tasks.generation_task:generate_personalized_image:180 - Original size: 570x600
2025-10-17 10:44:29.133 | INFO     | tasks.generation_task:generate_personalized_image:181 - Generation size (scaled up): 968x1024
2025-10-17 10:44:29.133 | INFO     | app.utils.helpers:create_pose_prompt:163 - 🎯 Using TEMPLATE prompt with isolation: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 10:44:29.134 | INFO     | app.utils.helpers:create_negative_prompt:259 - 🎯 Using TEMPLATE negative prompt
2025-10-17 10:44:29.134 | INFO     | app.services.ai_generator:generate_person:248 - 🎨 Generating male person: sitting, size: 968x1024
2025-10-17 10:44:29.134 | INFO     | app.services.ai_generator:generate_person:249 - ⚙️ Steps: 35, Guidance: 7.0
2025-10-17 10:44:29.135 | INFO     | app.services.ai_generator:generate_person:250 - 📝 Prompt: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 10:44:29.135 | INFO     | app.services.ai_generator:generate_person:251 - 🚫 Negative: extra limbs, duplicate arms, duplicate legs, multiple hands, multiple feet, third arm, third leg, fo...
2025-10-17 10:44:29.136 | INFO     | app.services.ai_generator:generate_person:262 - 🚀 Starting generation...
2025-10-17 10:44:35.877 | ERROR    | app.services.ai_generator:generate_person:286 - ❌ Failed to generate person: unknown error
2025-10-17 10:44:35.878 | ERROR    | app.services.ai_generator:generate_person:287 - unknown error
Traceback (most recent call last):

  File "C:\laragon\www\interactive-signage\digital-signage-ai\celery_worker.py", line 49, in <module>
    celery_app.worker_main([
    │          └ <function Celery.worker_main at 0x0000024D9F81B0A0>
    └ <Celery digital_signage_tasks at 0x24d9edf5cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\base.py", line 470, in worker_main
    self.start(argv=argv)
    │    │          └ ['worker', '--loglevel=info', '--concurrency=1', '--pool=solo', '--task-events', '--without-gossip', '--without-mingle']
    │    └ <function Celery.start at 0x0000024D9F81B010>
    └ <Celery digital_signage_tasks at 0x24d9edf5cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\base.py", line 450, in start
    celery.main(args=argv, standalone_mode=False)
    │      │         └ ['worker', '--loglevel=info', '--concurrency=1', '--pool=solo', '--task-events', '--without-gossip', '--without-mingle']
    │      └ <function Command.main at 0x0000024D9F7189D0>
    └ <DYMGroup celery>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1383, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x0000024DD2298940>
         │    └ <function Group.invoke at 0x0000024D9F719360>
         └ <DYMGroup celery>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1850, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x0000024DD26EE710>
           │               │       │       └ <function Command.invoke at 0x0000024D9F7188B0>
           │               │       └ <CeleryDaemonCommand worker>
           │               └ <click.core.Context object at 0x0000024DD26EE710>
           └ <function Group.invoke.<locals>._process_result at 0x0000024DD26E5BD0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1246, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │   │      │    │           └ <click.core.Context object at 0x0000024DD26EE710>
           │   │      │    └ <function worker at 0x0000024DD26E6950>
           │   │      └ <CeleryDaemonCommand worker>
           │   └ <function Context.invoke at 0x0000024D9F703BE0>
           └ <click.core.Context object at 0x0000024DD26EE710>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 814, in invoke
    return callback(*args, **kwargs)
           │         │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │         └ ()
           └ <function worker at 0x0000024DD26E6950>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\decorators.py", line 34, in new_func
    return f(get_current_context(), *args, **kwargs)
           │ │                       │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │ │                       └ ()
           │ └ <function get_current_context at 0x0000024D9F6BB910>
           └ <function worker at 0x0000024DD26E68C0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bin\base.py", line 135, in caller
    return f(ctx, *args, **kwargs)
           │ │     │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │ │     └ ()
           │ └ <click.core.Context object at 0x0000024DD26EE710>
           └ <function worker at 0x0000024DD26E6830>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bin\worker.py", line 356, in worker
    worker.start()
    │      └ <function WorkController.start at 0x0000024DD2646320>
    └ <Worker: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\worker.py", line 203, in start
    self.blueprint.start(self)
    │    │         │     └ <Worker: celery@soulmate-plus (running)>
    │    │         └ <function Blueprint.start at 0x0000024DD261A8C0>
    │    └ <celery.worker.worker.WorkController.Blueprint object at 0x0000024DD29B8550>
    └ <Worker: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
    │    │     └ <Worker: celery@soulmate-plus (running)>
    │    └ <function StartStopStep.start at 0x0000024DD261B9A0>
    └ <step: Consumer>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 365, in start
    return self.obj.start()
           │    │   └ <function Consumer.start at 0x0000024DD29D2B90>
           │    └ <Consumer: celery@soulmate-plus (running)>
           └ <step: Consumer>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 341, in start
    blueprint.start(self)
    │         │     └ <Consumer: celery@soulmate-plus (running)>
    │         └ <function Blueprint.start at 0x0000024DD261A8C0>
    └ <celery.worker.consumer.consumer.Consumer.Blueprint object at 0x0000024DD29945B0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
    │    │     └ <Consumer: celery@soulmate-plus (running)>
    │    └ <function Evloop.start at 0x0000024DD298E440>
    └ <step: event loop>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 772, in start
    c.loop(*c.loop_args())
    │ │     │ └ <function Consumer.loop_args at 0x0000024DD29D3010>
    │ │     └ <Consumer: celery@soulmate-plus (running)>
    │ └ <function synloop at 0x0000024DD29D2320>
    └ <Consumer: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\loops.py", line 143, in synloop
    _loop_cycle()
    └ <function synloop.<locals>._loop_cycle at 0x0000024DD2A92950>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\loops.py", line 132, in _loop_cycle
    connection.drain_events(timeout=2.0)
    │          └ <function Connection.drain_events at 0x0000024D9F552440>
    └ <Connection: redis://localhost:6379/0 at 0x24dd2a64940>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\connection.py", line 341, in drain_events
    return self.transport.drain_events(self.connection, **kwargs)
           │    │                      │    │             └ {'timeout': 2.0}
           │    │                      │    └ <property object at 0x0000024D9F562390>
           │    │                      └ <Connection: redis://localhost:6379/0 at 0x24dd2a64940>
           │    └ <property object at 0x0000024D9F562480>
           └ <Connection: redis://localhost:6379/0 at 0x24dd2a64940>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 997, in drain_events
    get(self._deliver, timeout=timeout)
    │   │    │                 └ 2.0
    │   │    └ <function Transport._deliver at 0x0000024DD27A8F70>
    │   └ <kombu.transport.redis.Transport object at 0x0000024DD2A64A60>
    └ <bound method MultiChannelPoller.get of <kombu.transport.redis.MultiChannelPoller object at 0x0000024DD2A64B50>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 598, in get
    ret = self.handle_event(fileno, event)
          │    │            │       └ 1
          │    │            └ 3656
          │    └ <function MultiChannelPoller.handle_event at 0x0000024DD29B53F0>
          └ <kombu.transport.redis.MultiChannelPoller object at 0x0000024DD2A64B50>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 580, in handle_event
    return self.on_readable(fileno), self
           │    │           │        └ <kombu.transport.redis.MultiChannelPoller object at 0x0000024DD2A64B50>
           │    │           └ 3656
           │    └ <function MultiChannelPoller.on_readable at 0x0000024DD29B5360>
           └ <kombu.transport.redis.MultiChannelPoller object at 0x0000024DD2A64B50>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 576, in on_readable
    chan.handlers[type]()
    │    │        └ 'BRPOP'
    │    └ {'BRPOP': <bound method Channel._brpop_read of <kombu.transport.redis.Channel object at 0x0000024DD2A64AF0>>, 'LISTEN': <boun...
    └ <kombu.transport.redis.Channel object at 0x0000024DD2A64AF0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 986, in _brpop_read
    self.connection._deliver(loads(bytes_to_str(item)), dest)
    │    │          │        │     │            │       └ 'celery'
    │    │          │        │     │            └ b'{"body": "W1tdLCB7ImdlbmVyYXRpb25faWQiOiAiMDE5OWYwNDQtNTI2ZC03MWM3LTg1NTgtODRiYTliNmYxODRlIiwgImZhY2VfaW1hZ2VfcGF0aCI6ICIuL...
    │    │          │        │     └ <function bytes_to_str at 0x0000024D9F4F1B40>
    │    │          │        └ <function loads at 0x0000024D9F5727A0>
    │    │          └ <function Transport._deliver at 0x0000024DD27A8F70>
    │    └ <kombu.transport.redis.Transport object at 0x0000024DD2A64A60>
    └ <kombu.transport.redis.Channel object at 0x0000024DD2A64AF0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 1017, in _deliver
    callback(message)
    │        └ {'body': 'W1tdLCB7ImdlbmVyYXRpb25faWQiOiAiMDE5OWYwNDQtNTI2ZC03MWM3LTg1NTgtODRiYTliNmYxODRlIiwgImZhY2VfaW1hZ2VfcGF0aCI6ICIuL3R...
    └ <function Channel.basic_consume.<locals>._callback at 0x0000024DD2A928C0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 639, in _callback
    return callback(message)
           │        └ <Message object at 0x24dd2a929e0 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': 'a3c4...
           └ <bound method Consumer._receive_callback of <Consumer: [<Queue celery -> <Exchange celery(direct) bound to chan:1> -> celery ...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\messaging.py", line 668, in _receive_callback
    return on_m(message) if on_m else self.receive(decoded, message)
           │    │           │         │    │       │        └ <Message object at 0x24dd2a929e0 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': 'a3c4...
           │    │           │         │    │       └ None
           │    │           │         │    └ <function Consumer.receive at 0x0000024D9F795C60>
           │    │           │         └ <Consumer: [<Queue celery -> <Exchange celery(direct) bound to chan:1> -> celery bound to chan:1>]>
           │    │           └ <function Consumer.create_task_handler.<locals>.on_task_received at 0x0000024DD2A92830>
           │    └ <Message object at 0x24dd2a929e0 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': 'a3c4...
           └ <function Consumer.create_task_handler.<locals>.on_task_received at 0x0000024DD2A92830>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 688, in on_task_received
    strategy(
    └ <function default.<locals>.task_message_handler at 0x0000024DD2A91AB0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\strategy.py", line 207, in task_message_handler
    handle(req)
    │      └ <Request: tasks.generate_personalized_image[aed2ab9f-441e-4dda-93ea-c6683f5b7775] () {'generation_id': '0199f044-526d-71c7-85...
    └ <bound method WorkController._process_task of <Worker: celery@soulmate-plus (running)>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\worker.py", line 226, in _process_task
    req.execute_using_pool(self.pool)
    │   │                  │    └ <celery.concurrency.solo.TaskPool object at 0x0000024DD29B9A20>
    │   │                  └ <Worker: celery@soulmate-plus (running)>
    │   └ <function create_request_cls.<locals>.Request.execute_using_pool at 0x0000024DD2A91B40>
    └ <Request: tasks.generate_personalized_image[aed2ab9f-441e-4dda-93ea-c6683f5b7775] () {'generation_id': '0199f044-526d-71c7-85...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\request.py", line 754, in execute_using_pool
    result = apply_async(
             └ <bound method BasePool.apply_async of <celery.concurrency.solo.TaskPool object at 0x0000024DD29B9A20>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\concurrency\base.py", line 153, in apply_async
    return self.on_apply(target, args, kwargs,
           │    │        │       │     └ {}
           │    │        │       └ ('tasks.generate_personalized_image', 'aed2ab9f-441e-4dda-93ea-c6683f5b7775', {'lang': 'py', 'task': 'tasks.generate_personal...
           │    │        └ <function fast_trace_task at 0x0000024DD267A320>
           │    └ <function apply_target at 0x0000024DD267A5F0>
           └ <celery.concurrency.solo.TaskPool object at 0x0000024DD29B9A20>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\concurrency\base.py", line 30, in apply_target
    ret = target(*args, **kwargs)
          │       │       └ {}
          │       └ ('tasks.generate_personalized_image', 'aed2ab9f-441e-4dda-93ea-c6683f5b7775', {'lang': 'py', 'task': 'tasks.generate_personal...
          └ <function fast_trace_task at 0x0000024DD267A320>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 651, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
                    │     └ 'tasks.generate_personalized_image'
                    └ {'celery.chunks': <@task: celery.chunks of digital_signage_tasks at 0x24d9edf5cc0>, 'celery.chord_unlock': <@task: celery.cho...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 453, in trace_task
    R = retval = fun(*args, **kwargs)
                 │    │       └ {'generation_id': '0199f044-526d-71c7-8558-84ba9b6f184e', 'face_image_path': './temp\\0199f044-526d-71c7-8558-84ba9b6f184e_fa...
                 │    └ []
                 └ <@task: tasks.generate_personalized_image of digital_signage_tasks at 0x24d9edf5cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 736, in __protected_call__
    return self.run(*args, **kwargs)
           │    │    │       └ {'generation_id': '0199f044-526d-71c7-8558-84ba9b6f184e', 'face_image_path': './temp\\0199f044-526d-71c7-8558-84ba9b6f184e_fa...
           │    │    └ ()
           │    └ <function generate_personalized_image at 0x0000024DD2281120>
           └ <@task: tasks.generate_personalized_image of digital_signage_tasks at 0x24d9edf5cc0>

  File "C:\laragon\www\interactive-signage\digital-signage-ai\tasks\generation_task.py", line 184, in generate_personalized_image
    person_image = generator.generate_person(
                   │         └ <function AIGenerator.generate_person at 0x0000024DCCE055A0>
                   └ <app.services.ai_generator.AIGenerator object at 0x0000024DD2AADE10>

> File "C:\laragon\www\interactive-signage\digital-signage-ai\app\services\ai_generator.py", line 267, in generate_person
    result = self.pipe(
             │    └ StableDiffusionPipeline {
             │        "_class_name": "StableDiffusionPipeline",
             │        "_diffusers_version": "0.21.4",
             │        "_name_or_path": "r...
             └ <app.services.ai_generator.AIGenerator object at 0x0000024DD2AADE10>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           │     │       └ {'prompt': 'professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothi...
           │     └ (StableDiffusionPipeline {
           │         "_class_name": "StableDiffusionPipeline",
           │         "_diffusers_version": "0.21.4",
           │         "_name_or_path": "...
           └ <function StableDiffusionPipeline.__call__ at 0x0000024DCCE04790>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\pipelines\stable_diffusion\pipeline_stable_diffusion.py", line 680, in __call__
    noise_pred = self.unet(
                 │    └ UNet2DConditionModel(
                 │        (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
                 │        (time_proj): Timesteps...
                 └ StableDiffusionPipeline {
                     "_class_name": "StableDiffusionPipeline",
                     "_diffusers_version": "0.21.4",
                     "_name_or_path": "r...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'encoder_hidden_states': tensor([[[-0.3884,  0.0229, -0.0522,  ..., -0.4899, -0.3066,  0.0675],
           │    │           │                  [ 0.8719, -0.1621, ...
           │    │           └ (tensor([[[[-1.8719,  0.4645,  0.9086,  ..., -0.5310,  0.1344,  0.6488],
           │    │                       [-0.0540,  0.0810,  0.7388,  ...,  0.2842,...
           │    └ <function Module._call_impl at 0x0000024DC5A7B1C0>
           └ UNet2DConditionModel(
               (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
               (time_proj): Timesteps...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'encoder_hidden_states': tensor([[[-0.3884,  0.0229, -0.0522,  ..., -0.4899, -0.3066,  0.0675],
           │             │                  [ 0.8719, -0.1621, ...
           │             └ (tensor([[[[-1.8719,  0.4645,  0.9086,  ..., -0.5310,  0.1344,  0.6488],
           │                         [-0.0540,  0.0810,  0.7388,  ...,  0.2842,...
           └ <bound method UNet2DConditionModel.forward of UNet2DConditionModel(
               (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\unet_2d_condition.py", line 958, in forward
    sample, res_samples = downsample_block(
    │                     └ CrossAttnDownBlock2D(
    │                         (attentions): ModuleList(
    │                           (0-1): 2 x Transformer2DModel(
    │                             (norm): GroupNorm(32, 320, eps=1e-...
    └ tensor([[[[ 0.5654, -0.5522, -0.2004,  ...,  0.1341, -0.3616,  0.3031],
                [-0.2260,  0.5414, -0.7911,  ...,  0.1350, ...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'hidden_states': tensor([[[[ 0.5654, -0.5522, -0.2004,  ...,  0.1341, -0.3616,  0.3031],
           │    │           │                   [-0.2260,  0.5414, -0.791...
           │    │           └ ()
           │    └ <function Module._call_impl at 0x0000024DC5A7B1C0>
           └ CrossAttnDownBlock2D(
               (attentions): ModuleList(
                 (0-1): 2 x Transformer2DModel(
                   (norm): GroupNorm(32, 320, eps=1e-...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'hidden_states': tensor([[[[ 0.5654, -0.5522, -0.2004,  ...,  0.1341, -0.3616,  0.3031],
           │             │                   [-0.2260,  0.5414, -0.791...
           │             └ ()
           └ <bound method CrossAttnDownBlock2D.forward of CrossAttnDownBlock2D(
               (attentions): ModuleList(
                 (0-1): 2 x Transformer2DM...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\unet_2d_blocks.py", line 1086, in forward
    hidden_states = attn(
                    └ Transformer2DModel(
                        (norm): GroupNorm(32, 320, eps=1e-06, affine=True)
                        (proj_in): LoRACompatibleConv(320, 320, kernel_siz...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'encoder_hidden_states': tensor([[[-0.3884,  0.0229, -0.0522,  ..., -0.4899, -0.3066,  0.0675],
           │    │           │                  [ 0.8719, -0.1621, ...
           │    │           └ (tensor([[[[ 1.2387e+00,  1.5972e-02,  5.2279e-01,  ...,  1.2235e+00,
           │    │                         5.4019e-01,  9.7645e-01],
           │    │                       [ 3.641...
           │    └ <function Module._call_impl at 0x0000024DC5A7B1C0>
           └ Transformer2DModel(
               (norm): GroupNorm(32, 320, eps=1e-06, affine=True)
               (proj_in): LoRACompatibleConv(320, 320, kernel_siz...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'encoder_hidden_states': tensor([[[-0.3884,  0.0229, -0.0522,  ..., -0.4899, -0.3066,  0.0675],
           │             │                  [ 0.8719, -0.1621, ...
           │             └ (tensor([[[[ 1.2387e+00,  1.5972e-02,  5.2279e-01,  ...,  1.2235e+00,
           │                           5.4019e-01,  9.7645e-01],
           │                         [ 3.641...
           └ <bound method Transformer2DModel.forward of Transformer2DModel(
               (norm): GroupNorm(32, 320, eps=1e-06, affine=True)
               (proj_...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\transformer_2d.py", line 315, in forward
    hidden_states = block(
                    └ BasicTransformerBlock(
                        (norm1): LayerNorm((320,), eps=1e-05, elementwise_affine=True)
                        (attn1): Attention(
                          (to_q): LoR...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'attention_mask': None, 'encoder_hidden_states': tensor([[[-0.3884,  0.0229, -0.0522,  ..., -0.4899, -0.3066,  0.0675],
           │    │           │             ...
           │    │           └ (tensor([[[ 0.0007,  0.1364, -0.2096,  ...,  0.0507, -0.0663, -0.0621],
           │    │                      [-0.0804, -0.0298, -0.1879,  ...,  0.2194, -...
           │    └ <function Module._call_impl at 0x0000024DC5A7B1C0>
           └ BasicTransformerBlock(
               (norm1): LayerNorm((320,), eps=1e-05, elementwise_affine=True)
               (attn1): Attention(
                 (to_q): LoR...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'attention_mask': None, 'encoder_hidden_states': tensor([[[-0.3884,  0.0229, -0.0522,  ..., -0.4899, -0.3066,  0.0675],
           │             │             ...
           │             └ (tensor([[[ 0.0007,  0.1364, -0.2096,  ...,  0.0507, -0.0663, -0.0621],
           │                        [-0.0804, -0.0298, -0.1879,  ...,  0.2194, -...
           └ <bound method BasicTransformerBlock.forward of BasicTransformerBlock(
               (norm1): LayerNorm((320,), eps=1e-05, elementwise_aff...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\attention.py", line 197, in forward
    attn_output = self.attn1(
                  └ BasicTransformerBlock(
                      (norm1): LayerNorm((320,), eps=1e-05, elementwise_affine=True)
                      (attn1): Attention(
                        (to_q): LoR...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'encoder_hidden_states': None, 'attention_mask': None}
           │    │           └ (tensor([[[ 0.0746,  0.3392, -0.7188,  ..., -0.0373, -0.0488, -0.0359],
           │    │                      [-0.2624, -0.2015, -0.6652,  ...,  0.3698, -...
           │    └ <function Module._call_impl at 0x0000024DC5A7B1C0>
           └ Attention(
               (to_q): LoRACompatibleLinear(in_features=320, out_features=320, bias=False)
               (to_k): LoRACompatibleLinear(in_fe...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'encoder_hidden_states': None, 'attention_mask': None}
           │             └ (tensor([[[ 0.0746,  0.3392, -0.7188,  ..., -0.0373, -0.0488, -0.0359],
           │                        [-0.2624, -0.2015, -0.6652,  ...,  0.3698, -...
           └ <bound method Attention.forward of Attention(
               (to_q): LoRACompatibleLinear(in_features=320, out_features=320, bias=False)
              ...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\attention_processor.py", line 417, in forward
    return self.processor(
           │    └ <diffusers.models.attention_processor.AttnProcessor2_0 object at 0x0000024D95A00F10>
           └ Attention(
               (to_q): LoRACompatibleLinear(in_features=320, out_features=320, bias=False)
               (to_k): LoRACompatibleLinear(in_fe...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\attention_processor.py", line 1036, in __call__
    hidden_states = F.scaled_dot_product_attention(
                    │ └ <built-in function scaled_dot_product_attention>
                    └ <module 'torch.nn.functional' from 'C:\\laragon\\bin\\python\\python-3.10\\lib\\site-packages\\torch\\nn\\functional.py'>

RuntimeError: unknown error
2025-10-17 10:44:43.255 | ERROR    | tasks.generation_task:generate_personalized_image:316 - ❌ Generation failed for 0199f044-526d-71c7-8558-84ba9b6f184e: Failed to generate person image
2025-10-17 10:44:44.183 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f044-526d-71c7-8558-84ba9b6f184e/failed
2025-10-17 10:44:44.199 | ERROR    | tasks.generation_task:on_failure:47 - Task aed2ab9f-441e-4dda-93ea-c6683f5b7775 failed: Failed to generate person image
2025-10-17 10:44:44.942 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f044-526d-71c7-8558-84ba9b6f184e/failed
2025-10-17 10:47:10.661 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-17 10:47:41.676 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199f047-abaa-7343-9fd4-c9dedcdc6d0f
2025-10-17 10:47:41.678 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-17 10:47:41.743 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-17 10:47:44.109 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-17 10:47:47.125 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-17 10:47:47.939 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-17 10:47:47.941 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-17 10:47:47.941 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-17 10:47:47.941 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-17 10:47:47.943 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-17 10:47:47.945 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-17 10:47:47.968 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-17 10:47:47.971 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-17 10:47:48.117 | INFO     | app.services.ai_generator:get_device:21 - ✅ Using DirectML device (AMD GPU): privateuseone:0
2025-10-17 10:47:48.117 | INFO     | app.services.ai_generator:__init__:54 - 🎮 DirectML (AMD GPU) mode enabled
2025-10-17 10:47:48.117 | INFO     | app.services.ai_generator:load_model:122 - ⏳ Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-17 10:47:48.117 | INFO     | app.services.ai_generator:load_model:123 - 🖥️ Target device: privateuseone:0
2025-10-17 10:47:48.117 | INFO     | app.services.ai_generator:load_model:128 - Using FP16 precision for GPU
2025-10-17 10:47:50.647 | INFO     | app.services.ai_generator:load_model:148 - 📦 Moving model to privateuseone:0...
2025-10-17 10:48:08.213 | INFO     | app.services.ai_generator:load_model:153 - 🔧 Applying DirectML compatibility fixes...
2025-10-17 10:48:08.224 | INFO     | app.services.ai_generator:load_model:158 - ✅ Using legacy attention processor (DirectML compatible)
2025-10-17 10:48:08.684 | INFO     | app.services.ai_generator:load_model:162 - ✅ Text encoder moved to CPU
2025-10-17 10:48:08.685 | INFO     | app.services.ai_generator:load_model:163 - ✅ UNet & VAE remain on DirectML (AMD GPU)
2025-10-17 10:48:08.686 | INFO     | app.services.ai_generator:_patch_pipeline_for_directml:113 - ✅ Pipeline patched for DirectML compatibility
2025-10-17 10:48:08.686 | INFO     | app.services.ai_generator:load_model:172 - 🔧 Applying DirectML (AMD) optimizations...
2025-10-17 10:48:08.687 | INFO     | app.services.ai_generator:load_model:175 - ✅ DirectML optimizations applied
2025-10-17 10:48:08.688 | INFO     | app.services.ai_generator:load_model:202 - ✅ Stable Diffusion model loaded successfully!
2025-10-17 10:48:08.688 | INFO     | app.services.ai_generator:load_model:203 - 📊 Model info: {'model_id': 'runwayml/stable-diffusion-v1-5', 'device': 'DirectML (AMD)', 'device_raw': 'privateuseone:0', 'loaded': True, 'is_directml': True, 'xformers_enabled': False, 'cpu_offload_enabled': False}
2025-10-17 10:48:08.689 | INFO     | tasks.generation_task:generate_personalized_image:147 - 📋 Template Config:
2025-10-17 10:48:08.690 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has base_prompt: True
2025-10-17 10:48:08.691 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Has negative_prompt: True
2025-10-17 10:48:08.691 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Min size: 768x1024
2025-10-17 10:48:08.692 | INFO     | tasks.generation_task:generate_personalized_image:151 -    - Guidance: 7.0, Steps: 35
2025-10-17 10:48:08.692 | INFO     | tasks.generation_task:generate_personalized_image:180 - Original size: 570x600
2025-10-17 10:48:08.692 | INFO     | tasks.generation_task:generate_personalized_image:181 - Generation size (scaled up): 968x1024
2025-10-17 10:48:08.694 | INFO     | app.utils.helpers:create_pose_prompt:163 - 🎯 Using TEMPLATE prompt with isolation: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 10:48:08.695 | INFO     | app.utils.helpers:create_negative_prompt:259 - 🎯 Using TEMPLATE negative prompt
2025-10-17 10:48:08.696 | INFO     | app.services.ai_generator:generate_person:253 - 🎨 Generating male person: sitting, size: 968x1024
2025-10-17 10:48:08.696 | INFO     | app.services.ai_generator:generate_person:254 - ⚙️ Steps: 35, Guidance: 7.0
2025-10-17 10:48:08.697 | INFO     | app.services.ai_generator:generate_person:255 - 📝 Prompt: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 10:48:08.698 | INFO     | app.services.ai_generator:generate_person:256 - 🚫 Negative: extra limbs, duplicate arms, duplicate legs, multiple hands, multiple feet, third arm, third leg, fo...
2025-10-17 10:48:08.698 | INFO     | app.services.ai_generator:generate_person:267 - 🚀 Starting generation...
2025-10-17 10:48:18.018 | ERROR    | app.services.ai_generator:generate_person:291 - ❌ Failed to generate person: Could not allocate tensor with 2467299328 bytes. There is not enough GPU video memory available!
2025-10-17 10:48:18.020 | ERROR    | app.services.ai_generator:generate_person:292 - Could not allocate tensor with 2467299328 bytes. There is not enough GPU video memory available!
Traceback (most recent call last):

  File "C:\laragon\www\interactive-signage\digital-signage-ai\celery_worker.py", line 49, in <module>
    celery_app.worker_main([
    │          └ <function Celery.worker_main at 0x000002F5A74DB0A0>
    └ <Celery digital_signage_tasks at 0x2f5a6ad5cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\base.py", line 470, in worker_main
    self.start(argv=argv)
    │    │          └ ['worker', '--loglevel=info', '--concurrency=1', '--pool=solo', '--task-events', '--without-gossip', '--without-mingle']
    │    └ <function Celery.start at 0x000002F5A74DB010>
    └ <Celery digital_signage_tasks at 0x2f5a6ad5cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\base.py", line 450, in start
    celery.main(args=argv, standalone_mode=False)
    │      │         └ ['worker', '--loglevel=info', '--concurrency=1', '--pool=solo', '--task-events', '--without-gossip', '--without-mingle']
    │      └ <function Command.main at 0x000002F5A73D89D0>
    └ <DYMGroup celery>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1383, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x000002F5D9F788B0>
         │    └ <function Group.invoke at 0x000002F5A73D9360>
         └ <DYMGroup celery>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1850, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x000002F5DA3CE680>
           │               │       │       └ <function Command.invoke at 0x000002F5A73D88B0>
           │               │       └ <CeleryDaemonCommand worker>
           │               └ <click.core.Context object at 0x000002F5DA3CE680>
           └ <function Group.invoke.<locals>._process_result at 0x000002F5DA3C5BD0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1246, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │   │      │    │           └ <click.core.Context object at 0x000002F5DA3CE680>
           │   │      │    └ <function worker at 0x000002F5DA3C6950>
           │   │      └ <CeleryDaemonCommand worker>
           │   └ <function Context.invoke at 0x000002F5A73C3BE0>
           └ <click.core.Context object at 0x000002F5DA3CE680>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 814, in invoke
    return callback(*args, **kwargs)
           │         │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │         └ ()
           └ <function worker at 0x000002F5DA3C6950>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\decorators.py", line 34, in new_func
    return f(get_current_context(), *args, **kwargs)
           │ │                       │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │ │                       └ ()
           │ └ <function get_current_context at 0x000002F5A737B910>
           └ <function worker at 0x000002F5DA3C68C0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bin\base.py", line 135, in caller
    return f(ctx, *args, **kwargs)
           │ │     │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │ │     └ ()
           │ └ <click.core.Context object at 0x000002F5DA3CE680>
           └ <function worker at 0x000002F5DA3C6830>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bin\worker.py", line 356, in worker
    worker.start()
    │      └ <function WorkController.start at 0x000002F5DA326320>
    └ <Worker: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\worker.py", line 203, in start
    self.blueprint.start(self)
    │    │         │     └ <Worker: celery@soulmate-plus (running)>
    │    │         └ <function Blueprint.start at 0x000002F5DA2FE8C0>
    │    └ <celery.worker.worker.WorkController.Blueprint object at 0x000002F5DA6944C0>
    └ <Worker: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
    │    │     └ <Worker: celery@soulmate-plus (running)>
    │    └ <function StartStopStep.start at 0x000002F5DA2FF9A0>
    └ <step: Consumer>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 365, in start
    return self.obj.start()
           │    │   └ <function Consumer.start at 0x000002F5DA6AEB90>
           │    └ <Consumer: celery@soulmate-plus (running)>
           └ <step: Consumer>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 341, in start
    blueprint.start(self)
    │         │     └ <Consumer: celery@soulmate-plus (running)>
    │         └ <function Blueprint.start at 0x000002F5DA2FE8C0>
    └ <celery.worker.consumer.consumer.Consumer.Blueprint object at 0x000002F5DA678520>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
    │    │     └ <Consumer: celery@soulmate-plus (running)>
    │    └ <function Evloop.start at 0x000002F5DA66E440>
    └ <step: event loop>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 772, in start
    c.loop(*c.loop_args())
    │ │     │ └ <function Consumer.loop_args at 0x000002F5DA6AF010>
    │ │     └ <Consumer: celery@soulmate-plus (running)>
    │ └ <function synloop at 0x000002F5DA6AE320>
    └ <Consumer: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\loops.py", line 143, in synloop
    _loop_cycle()
    └ <function synloop.<locals>._loop_cycle at 0x000002F5DA7763B0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\loops.py", line 132, in _loop_cycle
    connection.drain_events(timeout=2.0)
    │          └ <function Connection.drain_events at 0x000002F5A7212440>
    └ <Connection: redis://localhost:6379/0 at 0x2f5da7448e0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\connection.py", line 341, in drain_events
    return self.transport.drain_events(self.connection, **kwargs)
           │    │                      │    │             └ {'timeout': 2.0}
           │    │                      │    └ <property object at 0x000002F5A7222390>
           │    │                      └ <Connection: redis://localhost:6379/0 at 0x2f5da7448e0>
           │    └ <property object at 0x000002F5A7222480>
           └ <Connection: redis://localhost:6379/0 at 0x2f5da7448e0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 997, in drain_events
    get(self._deliver, timeout=timeout)
    │   │    │                 └ 2.0
    │   │    └ <function Transport._deliver at 0x000002F5DA488F70>
    │   └ <kombu.transport.redis.Transport object at 0x000002F5DA744A00>
    └ <bound method MultiChannelPoller.get of <kombu.transport.redis.MultiChannelPoller object at 0x000002F5DA744AF0>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 598, in get
    ret = self.handle_event(fileno, event)
          │    │            │       └ 1
          │    │            └ 3612
          │    └ <function MultiChannelPoller.handle_event at 0x000002F5DA6913F0>
          └ <kombu.transport.redis.MultiChannelPoller object at 0x000002F5DA744AF0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 580, in handle_event
    return self.on_readable(fileno), self
           │    │           │        └ <kombu.transport.redis.MultiChannelPoller object at 0x000002F5DA744AF0>
           │    │           └ 3612
           │    └ <function MultiChannelPoller.on_readable at 0x000002F5DA691360>
           └ <kombu.transport.redis.MultiChannelPoller object at 0x000002F5DA744AF0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 576, in on_readable
    chan.handlers[type]()
    │    │        └ 'BRPOP'
    │    └ {'BRPOP': <bound method Channel._brpop_read of <kombu.transport.redis.Channel object at 0x000002F5DA744A90>>, 'LISTEN': <boun...
    └ <kombu.transport.redis.Channel object at 0x000002F5DA744A90>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 986, in _brpop_read
    self.connection._deliver(loads(bytes_to_str(item)), dest)
    │    │          │        │     │            │       └ 'celery'
    │    │          │        │     │            └ b'{"body": "W1tdLCB7ImdlbmVyYXRpb25faWQiOiAiMDE5OWYwNDctYWJhYS03MzQzLTlmZDQtYzlkZWRjZGM2ZDBmIiwgImZhY2VfaW1hZ2VfcGF0aCI6ICIuL...
    │    │          │        │     └ <function bytes_to_str at 0x000002F5A71B1B40>
    │    │          │        └ <function loads at 0x000002F5A72327A0>
    │    │          └ <function Transport._deliver at 0x000002F5DA488F70>
    │    └ <kombu.transport.redis.Transport object at 0x000002F5DA744A00>
    └ <kombu.transport.redis.Channel object at 0x000002F5DA744A90>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 1017, in _deliver
    callback(message)
    │        └ {'body': 'W1tdLCB7ImdlbmVyYXRpb25faWQiOiAiMDE5OWYwNDctYWJhYS03MzQzLTlmZDQtYzlkZWRjZGM2ZDBmIiwgImZhY2VfaW1hZ2VfcGF0aCI6ICIuL3R...
    └ <function Channel.basic_consume.<locals>._callback at 0x000002F5DA776440>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 639, in _callback
    return callback(message)
           │        └ <Message object at 0x2f5da774160 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '63d6...
           └ <bound method Consumer._receive_callback of <Consumer: [<Queue celery -> <Exchange celery(direct) bound to chan:1> -> celery ...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\messaging.py", line 668, in _receive_callback
    return on_m(message) if on_m else self.receive(decoded, message)
           │    │           │         │    │       │        └ <Message object at 0x2f5da774160 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '63d6...
           │    │           │         │    │       └ None
           │    │           │         │    └ <function Consumer.receive at 0x000002F5A7455C60>
           │    │           │         └ <Consumer: [<Queue celery -> <Exchange celery(direct) bound to chan:1> -> celery bound to chan:1>]>
           │    │           └ <function Consumer.create_task_handler.<locals>.on_task_received at 0x000002F5DA776560>
           │    └ <Message object at 0x2f5da774160 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '63d6...
           └ <function Consumer.create_task_handler.<locals>.on_task_received at 0x000002F5DA776560>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 688, in on_task_received
    strategy(
    └ <function default.<locals>.task_message_handler at 0x000002F5DA775AB0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\strategy.py", line 207, in task_message_handler
    handle(req)
    │      └ <Request: tasks.generate_personalized_image[724bce66-d927-4386-8f36-07dc0d995554] () {'generation_id': '0199f047-abaa-7343-9f...
    └ <bound method WorkController._process_task of <Worker: celery@soulmate-plus (running)>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\worker.py", line 226, in _process_task
    req.execute_using_pool(self.pool)
    │   │                  │    └ <celery.concurrency.solo.TaskPool object at 0x000002F5DA695990>
    │   │                  └ <Worker: celery@soulmate-plus (running)>
    │   └ <function create_request_cls.<locals>.Request.execute_using_pool at 0x000002F5DA775B40>
    └ <Request: tasks.generate_personalized_image[724bce66-d927-4386-8f36-07dc0d995554] () {'generation_id': '0199f047-abaa-7343-9f...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\request.py", line 754, in execute_using_pool
    result = apply_async(
             └ <bound method BasePool.apply_async of <celery.concurrency.solo.TaskPool object at 0x000002F5DA695990>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\concurrency\base.py", line 153, in apply_async
    return self.on_apply(target, args, kwargs,
           │    │        │       │     └ {}
           │    │        │       └ ('tasks.generate_personalized_image', '724bce66-d927-4386-8f36-07dc0d995554', {'lang': 'py', 'task': 'tasks.generate_personal...
           │    │        └ <function fast_trace_task at 0x000002F5DA35E320>
           │    └ <function apply_target at 0x000002F5DA35E5F0>
           └ <celery.concurrency.solo.TaskPool object at 0x000002F5DA695990>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\concurrency\base.py", line 30, in apply_target
    ret = target(*args, **kwargs)
          │       │       └ {}
          │       └ ('tasks.generate_personalized_image', '724bce66-d927-4386-8f36-07dc0d995554', {'lang': 'py', 'task': 'tasks.generate_personal...
          └ <function fast_trace_task at 0x000002F5DA35E320>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 651, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
                    │     └ 'tasks.generate_personalized_image'
                    └ {'celery.chunks': <@task: celery.chunks of digital_signage_tasks at 0x2f5a6ad5cc0>, 'celery.chord_unlock': <@task: celery.cho...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 453, in trace_task
    R = retval = fun(*args, **kwargs)
                 │    │       └ {'generation_id': '0199f047-abaa-7343-9fd4-c9dedcdc6d0f', 'face_image_path': './temp\\0199f047-abaa-7343-9fd4-c9dedcdc6d0f_fa...
                 │    └ []
                 └ <@task: tasks.generate_personalized_image of digital_signage_tasks at 0x2f5a6ad5cc0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 736, in __protected_call__
    return self.run(*args, **kwargs)
           │    │    │       └ {'generation_id': '0199f047-abaa-7343-9fd4-c9dedcdc6d0f', 'face_image_path': './temp\\0199f047-abaa-7343-9fd4-c9dedcdc6d0f_fa...
           │    │    └ ()
           │    └ <function generate_personalized_image at 0x000002F5D9F61120>
           └ <@task: tasks.generate_personalized_image of digital_signage_tasks at 0x2f5a6ad5cc0>

  File "C:\laragon\www\interactive-signage\digital-signage-ai\tasks\generation_task.py", line 184, in generate_personalized_image
    person_image = generator.generate_person(
                   │         └ <function AIGenerator.generate_person at 0x000002F5D4AC55A0>
                   └ <app.services.ai_generator.AIGenerator object at 0x000002F5DA7D7A00>

> File "C:\laragon\www\interactive-signage\digital-signage-ai\app\services\ai_generator.py", line 272, in generate_person
    result = self.pipe(
             │    └ StableDiffusionPipeline {
             │        "_class_name": "StableDiffusionPipeline",
             │        "_diffusers_version": "0.21.4",
             │        "_name_or_path": "r...
             └ <app.services.ai_generator.AIGenerator object at 0x000002F5DA7D7A00>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           │     │       └ {'prompt': 'professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothi...
           │     └ (StableDiffusionPipeline {
           │         "_class_name": "StableDiffusionPipeline",
           │         "_diffusers_version": "0.21.4",
           │         "_name_or_path": "...
           └ <function StableDiffusionPipeline.__call__ at 0x000002F5D4AC4790>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\pipelines\stable_diffusion\pipeline_stable_diffusion.py", line 680, in __call__
    noise_pred = self.unet(
                 │    └ UNet2DConditionModel(
                 │        (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
                 │        (time_proj): Timesteps...
                 └ StableDiffusionPipeline {
                     "_class_name": "StableDiffusionPipeline",
                     "_diffusers_version": "0.21.4",
                     "_name_or_path": "r...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ <unprintable dict object>
           │    │           └ <unprintable tuple object>
           │    └ <function Module._call_impl at 0x000002F5CD7431C0>
           └ UNet2DConditionModel(
               (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
               (time_proj): Timesteps...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ <unprintable dict object>
           │             └ <unprintable tuple object>
           └ <bound method UNet2DConditionModel.forward of UNet2DConditionModel(
               (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\unet_2d_condition.py", line 958, in forward
    sample, res_samples = downsample_block(
    │                     └ CrossAttnDownBlock2D(
    │                         (attentions): ModuleList(
    │                           (0-1): 2 x Transformer2DModel(
    │                             (norm): GroupNorm(32, 320, eps=1e-...
    └ <unprintable Tensor object>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ <unprintable dict object>
           │    │           └ ()
           │    └ <function Module._call_impl at 0x000002F5CD7431C0>
           └ CrossAttnDownBlock2D(
               (attentions): ModuleList(
                 (0-1): 2 x Transformer2DModel(
                   (norm): GroupNorm(32, 320, eps=1e-...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ <unprintable dict object>
           │             └ ()
           └ <bound method CrossAttnDownBlock2D.forward of CrossAttnDownBlock2D(
               (attentions): ModuleList(
                 (0-1): 2 x Transformer2DM...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\unet_2d_blocks.py", line 1086, in forward
    hidden_states = attn(
                    └ Transformer2DModel(
                        (norm): GroupNorm(32, 320, eps=1e-06, affine=True)
                        (proj_in): LoRACompatibleConv(320, 320, kernel_siz...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ <unprintable dict object>
           │    │           └ <unprintable tuple object>
           │    └ <function Module._call_impl at 0x000002F5CD7431C0>
           └ Transformer2DModel(
               (norm): GroupNorm(32, 320, eps=1e-06, affine=True)
               (proj_in): LoRACompatibleConv(320, 320, kernel_siz...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ <unprintable dict object>
           │             └ <unprintable tuple object>
           └ <bound method Transformer2DModel.forward of Transformer2DModel(
               (norm): GroupNorm(32, 320, eps=1e-06, affine=True)
               (proj_...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\transformer_2d.py", line 315, in forward
    hidden_states = block(
                    └ BasicTransformerBlock(
                        (norm1): LayerNorm((320,), eps=1e-05, elementwise_affine=True)
                        (attn1): Attention(
                          (to_q): LoR...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ <unprintable dict object>
           │    │           └ <unprintable tuple object>
           │    └ <function Module._call_impl at 0x000002F5CD7431C0>
           └ BasicTransformerBlock(
               (norm1): LayerNorm((320,), eps=1e-05, elementwise_affine=True)
               (attn1): Attention(
                 (to_q): LoR...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ <unprintable dict object>
           │             └ <unprintable tuple object>
           └ <bound method BasicTransformerBlock.forward of BasicTransformerBlock(
               (norm1): LayerNorm((320,), eps=1e-05, elementwise_aff...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\attention.py", line 197, in forward
    attn_output = self.attn1(
                  └ BasicTransformerBlock(
                      (norm1): LayerNorm((320,), eps=1e-05, elementwise_affine=True)
                      (attn1): Attention(
                        (to_q): LoR...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'encoder_hidden_states': None, 'attention_mask': None}
           │    │           └ <unprintable tuple object>
           │    └ <function Module._call_impl at 0x000002F5CD7431C0>
           └ Attention(
               (to_q): LoRACompatibleLinear(in_features=320, out_features=320, bias=False)
               (to_k): LoRACompatibleLinear(in_fe...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'encoder_hidden_states': None, 'attention_mask': None}
           │             └ <unprintable tuple object>
           └ <bound method Attention.forward of Attention(
               (to_q): LoRACompatibleLinear(in_features=320, out_features=320, bias=False)
              ...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\attention_processor.py", line 417, in forward
    return self.processor(
           │    └ <diffusers.models.attention_processor.AttnProcessor object at 0x000002F5DA7D77C0>
           └ Attention(
               (to_q): LoRACompatibleLinear(in_features=320, out_features=320, bias=False)
               (to_k): LoRACompatibleLinear(in_fe...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\attention_processor.py", line 585, in __call__
    attention_probs = attn.get_attention_scores(query, key, attention_mask)
                      │    │                    │      │    └ None
                      │    │                    │      └ <unprintable Tensor object>
                      │    │                    └ <unprintable Tensor object>
                      │    └ <function Attention.get_attention_scores at 0x000002F5D4A39630>
                      └ Attention(
                          (to_q): LoRACompatibleLinear(in_features=320, out_features=320, bias=False)
                          (to_k): LoRACompatibleLinear(in_fe...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\attention_processor.py", line 458, in get_attention_scores
    attention_scores = torch.baddbmm(
                       │     └ <built-in method baddbmm of type object at 0x00007FFA8530DE80>
                       └ <module 'torch' from 'C:\\laragon\\bin\\python\\python-3.10\\lib\\site-packages\\torch\\__init__.py'>

RuntimeError: Could not allocate tensor with 2467299328 bytes. There is not enough GPU video memory available!
2025-10-17 10:48:18.748 | ERROR    | tasks.generation_task:generate_personalized_image:316 - ❌ Generation failed for 0199f047-abaa-7343-9fd4-c9dedcdc6d0f: Failed to generate person image
2025-10-17 10:48:19.892 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f047-abaa-7343-9fd4-c9dedcdc6d0f/failed
2025-10-17 10:48:19.903 | ERROR    | tasks.generation_task:on_failure:47 - Task 724bce66-d927-4386-8f36-07dc0d995554 failed: Failed to generate person image
2025-10-17 10:48:20.615 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f047-abaa-7343-9fd4-c9dedcdc6d0f/failed
2025-10-17 10:53:53.624 | INFO     | __main__:<module>:46 - Starting Celery worker
2025-10-17 10:54:47.791 | INFO     | tasks.generation_task:generate_personalized_image:79 - 🚀 Starting generation for 0199f04e-2be2-7300-b68a-693172281125
2025-10-17 10:54:47.792 | INFO     | tasks.generation_task:generate_personalized_image:89 - Step 0: Analyzing source face
2025-10-17 10:54:47.861 | INFO     | app.services.face_swapper:load_model:28 - Loading InsightFace models...
2025-10-17 10:54:49.927 | INFO     | app.services.face_swapper:load_model:44 - Loading face swap model from ./models\inswapper_128.onnx
2025-10-17 10:54:52.255 | INFO     | app.services.face_swapper:load_model:49 - Face swap models loaded successfully
2025-10-17 10:54:53.152 | INFO     | app.services.face_swapper:get_face_attributes:191 - ✅ Face attributes: gender=male, age=38
2025-10-17 10:54:53.152 | INFO     | tasks.generation_task:generate_personalized_image:102 - ✅ Face Analysis Results:
2025-10-17 10:54:53.155 | INFO     | tasks.generation_task:generate_personalized_image:103 -    - Gender: male
2025-10-17 10:54:53.155 | INFO     | tasks.generation_task:generate_personalized_image:104 -    - Age: 38
2025-10-17 10:54:53.156 | INFO     | tasks.generation_task:generate_personalized_image:105 -    - Detection Score: 0.8678815364837646
2025-10-17 10:54:53.157 | INFO     | tasks.generation_task:generate_personalized_image:119 - Step 1: Loading design image
2025-10-17 10:54:53.182 | INFO     | tasks.generation_task:generate_personalized_image:124 - ✅ Images loaded successfully
2025-10-17 10:54:53.184 | INFO     | tasks.generation_task:generate_personalized_image:131 - Step 2: Generating male person with pose: sitting
2025-10-17 10:54:53.261 | INFO     | app.services.ai_generator:get_device:21 - ✅ Using DirectML device (AMD GPU): privateuseone:0
2025-10-17 10:54:53.261 | INFO     | app.services.ai_generator:__init__:54 - 🎮 DirectML (AMD GPU) mode enabled
2025-10-17 10:54:53.261 | INFO     | app.services.ai_generator:load_model:122 - ⏳ Loading Stable Diffusion model: runwayml/stable-diffusion-v1-5
2025-10-17 10:54:53.261 | INFO     | app.services.ai_generator:load_model:123 - 🖥️ Target device: privateuseone:0
2025-10-17 10:54:53.261 | INFO     | app.services.ai_generator:load_model:128 - Using FP16 precision for GPU
2025-10-17 10:54:55.876 | INFO     | app.services.ai_generator:load_model:148 - 📦 Moving model to privateuseone:0...
2025-10-17 10:55:18.114 | INFO     | app.services.ai_generator:load_model:153 - 🔧 Applying DirectML compatibility fixes...
2025-10-17 10:55:18.136 | INFO     | app.services.ai_generator:load_model:158 - ✅ Using legacy attention processor (DirectML compatible)
2025-10-17 10:55:18.629 | INFO     | app.services.ai_generator:load_model:162 - ✅ Text encoder moved to CPU
2025-10-17 10:55:18.629 | INFO     | app.services.ai_generator:load_model:163 - ✅ UNet & VAE remain on DirectML (AMD GPU)
2025-10-17 10:55:18.630 | INFO     | app.services.ai_generator:_patch_pipeline_for_directml:113 - ✅ Pipeline patched for DirectML compatibility
2025-10-17 10:55:18.631 | INFO     | app.services.ai_generator:load_model:172 - 🔧 Applying DirectML (AMD) optimizations...
2025-10-17 10:55:18.632 | INFO     | app.services.ai_generator:load_model:175 - ✅ DirectML optimizations applied
2025-10-17 10:55:18.632 | INFO     | app.services.ai_generator:load_model:202 - ✅ Stable Diffusion model loaded successfully!
2025-10-17 10:55:18.634 | INFO     | app.services.ai_generator:load_model:203 - 📊 Model info: {'model_id': 'runwayml/stable-diffusion-v1-5', 'device': 'DirectML (AMD)', 'device_raw': 'privateuseone:0', 'loaded': True, 'is_directml': True, 'xformers_enabled': False, 'cpu_offload_enabled': False}
2025-10-17 10:55:18.639 | INFO     | tasks.generation_task:generate_personalized_image:147 - 📋 Template Config:
2025-10-17 10:55:18.644 | INFO     | tasks.generation_task:generate_personalized_image:148 -    - Has base_prompt: True
2025-10-17 10:55:18.644 | INFO     | tasks.generation_task:generate_personalized_image:149 -    - Has negative_prompt: True
2025-10-17 10:55:18.645 | INFO     | tasks.generation_task:generate_personalized_image:150 -    - Min size: 768x1024
2025-10-17 10:55:18.646 | INFO     | tasks.generation_task:generate_personalized_image:151 -    - Guidance: 7.0, Steps: 35
2025-10-17 10:55:18.646 | INFO     | tasks.generation_task:generate_personalized_image:182 - 🔧 DirectML detected - checking VRAM limits
2025-10-17 10:55:18.647 | WARNING  | tasks.generation_task:generate_personalized_image:192 - ⚠️ Capped to 720x768 for DirectML VRAM
2025-10-17 10:55:18.647 | INFO     | tasks.generation_task:generate_personalized_image:194 - Original size: 570x600
2025-10-17 10:55:18.648 | INFO     | tasks.generation_task:generate_personalized_image:195 - Generation size (scaled up): 720x768
2025-10-17 10:55:18.650 | INFO     | app.utils.helpers:create_pose_prompt:163 - 🎯 Using TEMPLATE prompt with isolation: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 10:55:18.651 | INFO     | app.utils.helpers:create_negative_prompt:259 - 🎯 Using TEMPLATE negative prompt
2025-10-17 10:55:18.653 | INFO     | app.services.ai_generator:generate_person:253 - 🎨 Generating male person: sitting, size: 720x768
2025-10-17 10:55:18.654 | INFO     | app.services.ai_generator:generate_person:254 - ⚙️ Steps: 35, Guidance: 7.0
2025-10-17 10:55:18.654 | INFO     | app.services.ai_generator:generate_person:255 - 📝 Prompt: professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothing, hands resting naturally on lap, feet flat on ground, plain light gray studio backgr...
2025-10-17 10:55:18.656 | INFO     | app.services.ai_generator:generate_person:256 - 🚫 Negative: extra limbs, duplicate arms, duplicate legs, multiple hands, multiple feet, third arm, third leg, fo...
2025-10-17 10:55:18.656 | INFO     | app.services.ai_generator:generate_person:267 - 🚀 Starting generation...
2025-10-17 10:55:19.479 | ERROR    | app.services.ai_generator:generate_person:291 - ❌ Failed to generate person: tensor.device().type() == at::DeviceType::PrivateUse1 INTERNAL ASSERT FAILED at "C:\\__w\\1\\s\\pytorch-directml-plugin\\torch_directml\\csrc\\dml\\DMLTensor.cpp":31, please report a bug to PyTorch. unbox expects Dml at::Tensor as inputs
2025-10-17 10:55:19.481 | ERROR    | app.services.ai_generator:generate_person:292 - tensor.device().type() == at::DeviceType::PrivateUse1 INTERNAL ASSERT FAILED at "C:\\__w\\1\\s\\pytorch-directml-plugin\\torch_directml\\csrc\\dml\\DMLTensor.cpp":31, please report a bug to PyTorch. unbox expects Dml at::Tensor as inputs
Traceback (most recent call last):

  File "C:\laragon\www\interactive-signage\digital-signage-ai\celery_worker.py", line 49, in <module>
    celery_app.worker_main([
    │          └ <function Celery.worker_main at 0x000002673C50B010>
    └ <Celery digital_signage_tasks at 0x2673bb40040>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\base.py", line 470, in worker_main
    self.start(argv=argv)
    │    │          └ ['worker', '--loglevel=info', '--concurrency=1', '--pool=solo', '--task-events', '--without-gossip', '--without-mingle']
    │    └ <function Celery.start at 0x000002673C50AF80>
    └ <Celery digital_signage_tasks at 0x2673bb40040>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\base.py", line 450, in start
    celery.main(args=argv, standalone_mode=False)
    │      │         └ ['worker', '--loglevel=info', '--concurrency=1', '--pool=solo', '--task-events', '--without-gossip', '--without-mingle']
    │      └ <function Command.main at 0x000002673C408940>
    └ <DYMGroup celery>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1383, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x000002676EF88970>
         │    └ <function Group.invoke at 0x000002673C4092D0>
         └ <DYMGroup celery>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1850, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
           │               │       │       │      └ <click.core.Context object at 0x000002676F3DE740>
           │               │       │       └ <function Command.invoke at 0x000002673C408820>
           │               │       └ <CeleryDaemonCommand worker>
           │               └ <click.core.Context object at 0x000002676F3DE740>
           └ <function Group.invoke.<locals>._process_result at 0x000002676F3D5C60>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 1246, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │   │      │    │           └ <click.core.Context object at 0x000002676F3DE740>
           │   │      │    └ <function worker at 0x000002676F3D69E0>
           │   │      └ <CeleryDaemonCommand worker>
           │   └ <function Context.invoke at 0x000002673C3F7B50>
           └ <click.core.Context object at 0x000002676F3DE740>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\core.py", line 814, in invoke
    return callback(*args, **kwargs)
           │         │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │         └ ()
           └ <function worker at 0x000002676F3D69E0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\click\decorators.py", line 34, in new_func
    return f(get_current_context(), *args, **kwargs)
           │ │                       │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │ │                       └ ()
           │ └ <function get_current_context at 0x000002673C3B3880>
           └ <function worker at 0x000002676F3D6950>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bin\base.py", line 135, in caller
    return f(ctx, *args, **kwargs)
           │ │     │       └ {'loglevel': 20, 'concurrency': 1, 'pool': <class 'celery.concurrency.solo.TaskPool'>, 'task_events': True, 'without_gossip':...
           │ │     └ ()
           │ └ <click.core.Context object at 0x000002676F3DE740>
           └ <function worker at 0x000002676F3D68C0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bin\worker.py", line 356, in worker
    worker.start()
    │      └ <function WorkController.start at 0x000002676F3363B0>
    └ <Worker: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\worker.py", line 203, in start
    self.blueprint.start(self)
    │    │         │     └ <Worker: celery@soulmate-plus (running)>
    │    │         └ <function Blueprint.start at 0x000002676F312950>
    │    └ <celery.worker.worker.WorkController.Blueprint object at 0x000002676F6A8580>
    └ <Worker: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
    │    │     └ <Worker: celery@soulmate-plus (running)>
    │    └ <function StartStopStep.start at 0x000002676F313A30>
    └ <step: Consumer>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 365, in start
    return self.obj.start()
           │    │   └ <function Consumer.start at 0x000002676F6C6710>
           │    └ <Consumer: celery@soulmate-plus (running)>
           └ <step: Consumer>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 341, in start
    blueprint.start(self)
    │         │     └ <Consumer: celery@soulmate-plus (running)>
    │         └ <function Blueprint.start at 0x000002676F312950>
    └ <celery.worker.consumer.consumer.Consumer.Blueprint object at 0x000002676F6885E0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\bootsteps.py", line 116, in start
    step.start(parent)
    │    │     └ <Consumer: celery@soulmate-plus (running)>
    │    └ <function Evloop.start at 0x000002676F6C7880>
    └ <step: event loop>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 772, in start
    c.loop(*c.loop_args())
    │ │     │ └ <function Consumer.loop_args at 0x000002676F6C6B90>
    │ │     └ <Consumer: celery@soulmate-plus (running)>
    │ └ <function synloop at 0x000002676F6C63B0>
    └ <Consumer: celery@soulmate-plus (running)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\loops.py", line 143, in synloop
    _loop_cycle()
    └ <function synloop.<locals>._loop_cycle at 0x000002676F782A70>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\loops.py", line 132, in _loop_cycle
    connection.drain_events(timeout=2.0)
    │          └ <function Connection.drain_events at 0x000002673C2423B0>
    └ <Connection: redis://localhost:6379/0 at 0x2676f754970>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\connection.py", line 341, in drain_events
    return self.transport.drain_events(self.connection, **kwargs)
           │    │                      │    │             └ {'timeout': 2.0}
           │    │                      │    └ <property object at 0x000002673C252390>
           │    │                      └ <Connection: redis://localhost:6379/0 at 0x2676f754970>
           │    └ <property object at 0x000002673C252480>
           └ <Connection: redis://localhost:6379/0 at 0x2676f754970>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 997, in drain_events
    get(self._deliver, timeout=timeout)
    │   │    │                 └ 2.0
    │   │    └ <function Transport._deliver at 0x000002676F499000>
    │   └ <kombu.transport.redis.Transport object at 0x000002676F754A90>
    └ <bound method MultiChannelPoller.get of <kombu.transport.redis.MultiChannelPoller object at 0x000002676F754B80>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 598, in get
    ret = self.handle_event(fileno, event)
          │    │            │       └ 1
          │    │            └ 3616
          │    └ <function MultiChannelPoller.handle_event at 0x000002676F6A5480>
          └ <kombu.transport.redis.MultiChannelPoller object at 0x000002676F754B80>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 580, in handle_event
    return self.on_readable(fileno), self
           │    │           │        └ <kombu.transport.redis.MultiChannelPoller object at 0x000002676F754B80>
           │    │           └ 3616
           │    └ <function MultiChannelPoller.on_readable at 0x000002676F6A53F0>
           └ <kombu.transport.redis.MultiChannelPoller object at 0x000002676F754B80>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 576, in on_readable
    chan.handlers[type]()
    │    │        └ 'BRPOP'
    │    └ {'BRPOP': <bound method Channel._brpop_read of <kombu.transport.redis.Channel object at 0x000002676F754B20>>, 'LISTEN': <boun...
    └ <kombu.transport.redis.Channel object at 0x000002676F754B20>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\redis.py", line 986, in _brpop_read
    self.connection._deliver(loads(bytes_to_str(item)), dest)
    │    │          │        │     │            │       └ 'celery'
    │    │          │        │     │            └ b'{"body": "W1tdLCB7ImdlbmVyYXRpb25faWQiOiAiMDE5OWYwNGUtMmJlMi03MzAwLWI2OGEtNjkzMTcyMjgxMTI1IiwgImZhY2VfaW1hZ2VfcGF0aCI6ICIuL...
    │    │          │        │     └ <function bytes_to_str at 0x000002673C1E1AB0>
    │    │          │        └ <function loads at 0x000002673C266710>
    │    │          └ <function Transport._deliver at 0x000002676F499000>
    │    └ <kombu.transport.redis.Transport object at 0x000002676F754A90>
    └ <kombu.transport.redis.Channel object at 0x000002676F754B20>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 1017, in _deliver
    callback(message)
    │        └ {'body': 'W1tdLCB7ImdlbmVyYXRpb25faWQiOiAiMDE5OWYwNGUtMmJlMi03MzAwLWI2OGEtNjkzMTcyMjgxMTI1IiwgImZhY2VfaW1hZ2VfcGF0aCI6ICIuL3R...
    └ <function Channel.basic_consume.<locals>._callback at 0x000002676F7829E0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\transport\virtual\base.py", line 639, in _callback
    return callback(message)
           │        └ <Message object at 0x2676f782b00 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '2bb2...
           └ <bound method Consumer._receive_callback of <Consumer: [<Queue celery -> <Exchange celery(direct) bound to chan:1> -> celery ...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\kombu\messaging.py", line 668, in _receive_callback
    return on_m(message) if on_m else self.receive(decoded, message)
           │    │           │         │    │       │        └ <Message object at 0x2676f782b00 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '2bb2...
           │    │           │         │    │       └ None
           │    │           │         │    └ <function Consumer.receive at 0x000002673C489BD0>
           │    │           │         └ <Consumer: [<Queue celery -> <Exchange celery(direct) bound to chan:1> -> celery bound to chan:1>]>
           │    │           └ <function Consumer.create_task_handler.<locals>.on_task_received at 0x000002676F782950>
           │    └ <Message object at 0x2676f782b00 with details {'state': 'RECEIVED', 'content_type': 'application/json', 'delivery_tag': '2bb2...
           └ <function Consumer.create_task_handler.<locals>.on_task_received at 0x000002676F782950>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\consumer\consumer.py", line 688, in on_task_received
    strategy(
    └ <function default.<locals>.task_message_handler at 0x000002676F780700>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\strategy.py", line 207, in task_message_handler
    handle(req)
    │      └ <Request: tasks.generate_personalized_image[58d39799-9e58-4612-b782-b113743091d2] () {'generation_id': '0199f04e-2be2-7300-b6...
    └ <bound method WorkController._process_task of <Worker: celery@soulmate-plus (running)>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\worker.py", line 226, in _process_task
    req.execute_using_pool(self.pool)
    │   │                  │    └ <celery.concurrency.solo.TaskPool object at 0x000002676F6A9A50>
    │   │                  └ <Worker: celery@soulmate-plus (running)>
    │   └ <function create_request_cls.<locals>.Request.execute_using_pool at 0x000002676F780790>
    └ <Request: tasks.generate_personalized_image[58d39799-9e58-4612-b782-b113743091d2] () {'generation_id': '0199f04e-2be2-7300-b6...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\worker\request.py", line 754, in execute_using_pool
    result = apply_async(
             └ <bound method BasePool.apply_async of <celery.concurrency.solo.TaskPool object at 0x000002676F6A9A50>>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\concurrency\base.py", line 153, in apply_async
    return self.on_apply(target, args, kwargs,
           │    │        │       │     └ {}
           │    │        │       └ ('tasks.generate_personalized_image', '58d39799-9e58-4612-b782-b113743091d2', {'lang': 'py', 'task': 'tasks.generate_personal...
           │    │        └ <function fast_trace_task at 0x000002676F36E3B0>
           │    └ <function apply_target at 0x000002676F36E680>
           └ <celery.concurrency.solo.TaskPool object at 0x000002676F6A9A50>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\concurrency\base.py", line 30, in apply_target
    ret = target(*args, **kwargs)
          │       │       └ {}
          │       └ ('tasks.generate_personalized_image', '58d39799-9e58-4612-b782-b113743091d2', {'lang': 'py', 'task': 'tasks.generate_personal...
          └ <function fast_trace_task at 0x000002676F36E3B0>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 651, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
                    │     └ 'tasks.generate_personalized_image'
                    └ {'celery.group': <@task: celery.group of digital_signage_tasks at 0x2673bb40040>, 'tasks.generate_personalized_image': <@task...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 453, in trace_task
    R = retval = fun(*args, **kwargs)
                 │    │       └ {'generation_id': '0199f04e-2be2-7300-b68a-693172281125', 'face_image_path': './temp\\0199f04e-2be2-7300-b68a-693172281125_fa...
                 │    └ []
                 └ <@task: tasks.generate_personalized_image of digital_signage_tasks at 0x2673bb40040>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\celery\app\trace.py", line 736, in __protected_call__
    return self.run(*args, **kwargs)
           │    │    │       └ {'generation_id': '0199f04e-2be2-7300-b68a-693172281125', 'face_image_path': './temp\\0199f04e-2be2-7300-b68a-693172281125_fa...
           │    │    └ ()
           │    └ <function generate_personalized_image at 0x000002676EF791B0>
           └ <@task: tasks.generate_personalized_image of digital_signage_tasks at 0x2673bb40040>

  File "C:\laragon\www\interactive-signage\digital-signage-ai\tasks\generation_task.py", line 198, in generate_personalized_image
    person_image = generator.generate_person(
                   │         └ <function AIGenerator.generate_person at 0x0000026769AF5630>
                   └ <app.services.ai_generator.AIGenerator object at 0x000002676F799B40>

> File "C:\laragon\www\interactive-signage\digital-signage-ai\app\services\ai_generator.py", line 272, in generate_person
    result = self.pipe(
             │    └ StableDiffusionPipeline {
             │        "_class_name": "StableDiffusionPipeline",
             │        "_diffusers_version": "0.21.4",
             │        "_name_or_path": "r...
             └ <app.services.ai_generator.AIGenerator object at 0x000002676F799B40>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           │     │       └ {'prompt': 'professional full body photo of man person sitting on simple black chair, sitting position, wearing casual clothi...
           │     └ (StableDiffusionPipeline {
           │         "_class_name": "StableDiffusionPipeline",
           │         "_diffusers_version": "0.21.4",
           │         "_name_or_path": "...
           └ <function StableDiffusionPipeline.__call__ at 0x0000026769AF4820>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\pipelines\stable_diffusion\pipeline_stable_diffusion.py", line 680, in __call__
    noise_pred = self.unet(
                 │    └ UNet2DConditionModel(
                 │        (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
                 │        (time_proj): Timesteps...
                 └ StableDiffusionPipeline {
                     "_class_name": "StableDiffusionPipeline",
                     "_diffusers_version": "0.21.4",
                     "_name_or_path": "r...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {'encoder_hidden_states': tensor([[[-0.3884,  0.0229, -0.0522,  ..., -0.4899, -0.3066,  0.0675],
           │    │           │                  [ 0.8719, -0.1621, ...
           │    │           └ (tensor([[[[-0.2602, -2.3339, -1.0503,  ...,  0.4187,  0.0506, -1.7346],
           │    │                       [-0.7921,  0.8014,  0.1874,  ...,  1.3707,...
           │    └ <function Module._call_impl at 0x000002676277B250>
           └ UNet2DConditionModel(
               (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
               (time_proj): Timesteps...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {'encoder_hidden_states': tensor([[[-0.3884,  0.0229, -0.0522,  ..., -0.4899, -0.3066,  0.0675],
           │             │                  [ 0.8719, -0.1621, ...
           │             └ (tensor([[[[-0.2602, -2.3339, -1.0503,  ...,  0.4187,  0.0506, -1.7346],
           │                         [-0.7921,  0.8014,  0.1874,  ...,  1.3707,...
           └ <bound method UNet2DConditionModel.forward of UNet2DConditionModel(
               (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\unet_2d_condition.py", line 841, in forward
    emb = self.time_embedding(t_emb, timestep_cond)
          │                   │      └ None
          │                   └ tensor([[ 0.9996,  0.8027, -0.2781,  0.1768, -0.2780,  0.1252, -0.9289, -0.0870,
          │                              -0.4233, -0.2622, -0.8440, -0.8389,...
          └ UNet2DConditionModel(
              (conv_in): Conv2d(4, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
              (time_proj): Timesteps...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {}
           │    │           └ (tensor([[ 0.9996,  0.8027, -0.2781,  0.1768, -0.2780,  0.1252, -0.9289, -0.0870,
           │    │                      -0.4233, -0.2622, -0.8440, -0.8389...
           │    └ <function Module._call_impl at 0x000002676277B250>
           └ TimestepEmbedding(
               (linear_1): Linear(in_features=320, out_features=1280, bias=True)
               (act): SiLU()
               (linear_2): Linear(i...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {}
           │             └ (tensor([[ 0.9996,  0.8027, -0.2781,  0.1768, -0.2780,  0.1252, -0.9289, -0.0870,
           │                        -0.4233, -0.2622, -0.8440, -0.8389...
           └ <bound method TimestepEmbedding.forward of TimestepEmbedding(
               (linear_1): Linear(in_features=320, out_features=1280, bias=T...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\diffusers\models\embeddings.py", line 192, in forward
    sample = self.linear_1(sample)
             │             └ tensor([[ 0.9996,  0.8027, -0.2781,  0.1768, -0.2780,  0.1252, -0.9289, -0.0870,
             │                        -0.4233, -0.2622, -0.8440, -0.8389,...
             └ TimestepEmbedding(
                 (linear_1): Linear(in_features=320, out_features=1280, bias=True)
                 (act): SiLU()
                 (linear_2): Linear(i...

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           │    │           │       └ {}
           │    │           └ (tensor([[ 0.9996,  0.8027, -0.2781,  0.1768, -0.2780,  0.1252, -0.9289, -0.0870,
           │    │                      -0.4233, -0.2622, -0.8440, -0.8389...
           │    └ <function Module._call_impl at 0x000002676277B250>
           └ Linear(in_features=320, out_features=1280, bias=True)

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           │             │       └ {}
           │             └ (tensor([[ 0.9996,  0.8027, -0.2781,  0.1768, -0.2780,  0.1252, -0.9289, -0.0870,
           │                        -0.4233, -0.2622, -0.8440, -0.8389...
           └ <bound method Linear.forward of Linear(in_features=320, out_features=1280, bias=True)>

  File "C:\laragon\bin\python\python-3.10\lib\site-packages\torch\nn\modules\linear.py", line 117, in forward
    return F.linear(input, self.weight, self.bias)
           │ │      │      │            └ Linear(in_features=320, out_features=1280, bias=True)
           │ │      │      └ Linear(in_features=320, out_features=1280, bias=True)
           │ │      └ tensor([[ 0.9996,  0.8027, -0.2781,  0.1768, -0.2780,  0.1252, -0.9289, -0.0870,
           │ │                 -0.4233, -0.2622, -0.8440, -0.8389,...
           │ └ <built-in function linear>
           └ <module 'torch.nn.functional' from 'C:\\laragon\\bin\\python\\python-3.10\\lib\\site-packages\\torch\\nn\\functional.py'>

RuntimeError: tensor.device().type() == at::DeviceType::PrivateUse1 INTERNAL ASSERT FAILED at "C:\\__w\\1\\s\\pytorch-directml-plugin\\torch_directml\\csrc\\dml\\DMLTensor.cpp":31, please report a bug to PyTorch. unbox expects Dml at::Tensor as inputs
2025-10-17 10:55:20.093 | ERROR    | tasks.generation_task:generate_personalized_image:330 - ❌ Generation failed for 0199f04e-2be2-7300-b68a-693172281125: Failed to generate person image
2025-10-17 10:55:21.101 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f04e-2be2-7300-b68a-693172281125/failed
2025-10-17 10:55:21.114 | ERROR    | tasks.generation_task:on_failure:47 - Task 58d39799-9e58-4612-b782-b113743091d2 failed: Failed to generate person image
2025-10-17 10:55:21.764 | INFO     | app.utils.helpers:send_callback_to_laravel:70 - Callback sent successfully to http://localhost:8000/api/internal/generations/0199f04e-2be2-7300-b68a-693172281125/failed
